(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[60],{1103:function(e,t,a){"use strict";a.r(t);var n=a(25),c=a(29),s=a(35),r=a(27),o=a(1),i=a.n(o),d=a(131),l=a(1265),u=a(1263),b=a(933),f=a(47),p=a(38),m=a(67),j=a(777),g=a(1260),h=a(119),O=a.n(h),x=a(51),D=a.n(x),M=a(52),y=a.n(M),w=a(48),C=a(91),v=a(81),T=a(107),_=a(72),S=a(61),I=a(65),R=a(328),N=a(0),P=i.a.createContext(void 0);t.default=function(){var e,t=Object(j.a)(),a=Object(o.useContext)(p.a),i=Object(o.useContext)(_.a),h=Object(o.useContext)(I.a),x=Object(o.useState)(!1),M=Object(r.a)(x,2),k=M[0],E=M[1],A=Object(o.useState)(!1),F=Object(r.a)(A,2),V=F[0],Y=F[1],L=Object(o.useState)(!0),H=Object(r.a)(L,2),J=H[0],K=H[1],W=Object(o.useState)({}),B=Object(r.a)(W,2),U=B[0],G=B[1],q=Object(o.useState)({creditCard:"",startDate:D()().startOf("month").toDate(),endDate:D()().endOf("month").toDate()}),z=Object(r.a)(q,2),Q=z[0],X=z[1],Z=Object(o.useState)({}),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae={start:0,limit:10,searchString:""},ne=Object(o.useState)(ae),ce=Object(r.a)(ne,2),se=ce[0],re=ce[1],oe=Object(o.useState)(ae),ie=Object(r.a)(oe,2),de=ie[0],le=ie[1],ue={config:{header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:t.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"cCTable",Table:"creditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[t.formatMessage({id:"name",defaultMessage:"name"}),t.formatMessage({id:"date",defaultMessage:"date"}),t.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),t.formatMessage({id:"credits",defaultMessage:"credits"}),t.formatMessage({id:"purchases",defaultMessage:"purchases"}),t.formatMessage({id:"interest",defaultMessage:"interest"}),t.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},be=function(){var e=Object(s.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),(t=new FormData).append("appId",a.userConfig.appId),e.abrupt("return",f.a.post("/account_planner/credit_card_list",t).then((function(e){G(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return K(!1)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){Y(!0),te({}),setTimeout((function(){var t=function(){var e=new FormData;return e.append("limit",de.limit),e.append("start",de.start),e.append("searchString",de.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","creditCardTrx"),e.append("WhereClause","a.cc_appId = '".concat(a.userConfig.appId,"' && a.cc_for_card = '").concat(Q.creditCard,"' && d.credit_card_appId = '").concat(a.userConfig.appId,"' && a.cc_date >= '").concat(D()(Q.startDate).format("YYYY-MM-DD").toString(),"' && a.cc_date <= '").concat(D()(Q.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([t]).then((function(t){te(t[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){Y(!1),E(!0)}))}),100)};Object(o.useEffect)((function(){be()}),[]);Object(o.useEffect)((function(){_e()}),[se]);var pe=Object(v.a)(),me={fetch:pe.get("fetch"),creditCardId:pe.get("creditCardId"),startDate:pe.get("startDate"),endDate:pe.get("endDate")},je=Object(o.useState)(!1),ge=Object(r.a)(je,2),he=ge[0],Oe=ge[1];Object(o.useEffect)((function(){"creditCard"===me.fetch&&me.creditCardId&&(Oe(!0),X((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:me.creditCardId,startDate:D()(me.startDate).toDate(),endDate:D()(me.endDate).toDate()})})),le(ae))}),[JSON.stringify(me)]),Object(o.useEffect)((function(){"creditCard"===me.fetch&&Q.creditCard&&Q.startDate&&Q.endDate&&he&&fe((function(){Oe(!1),setTimeout((function(){var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(me),Q.creditCard,he]);var xe=function(){return Object(N.jsx)("div",{className:"relativeSpinner",children:Object(N.jsx)(y.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},De=["id","name","last4DigitCardNo","startDate","endDate","payDate","annuaInterestRate","localeLanguage","localeCurrency"],Me=["checkbox","textbox","textbox","number","number","number","number",{fetch:{dropDownList:R.c},searchable:!0},{fetch:{dropDownList:R.b},searchable:!0}],ye=T.b.filter((function(e){return"creditCardAccounts"===e.id})).map((function(e){var a={header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:i.localeLanguage,currency:i.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=a,e.TableAliasRows=De.map((function(e){return t.formatMessage({id:e,defaultMessage:e})})),e.rowElements=Me,e}))[0],we=Object(o.useState)([]),Ce=Object(r.a)(we,2),ve=Ce[0],Te=Ce[1],_e=function(){Te([]);var e=function(e,t){var n=new FormData;return n.append("TableRows",t),n.append("Table",e),n.append("limit",se.limit),n.append("start",se.start),n.append("searchString",se.searchString),n.append("appId",a.userConfig.appId),f.a.post("/account_planner/getAccountPlanner",n)}(ye.Table,ye.TableRows);Promise.all([e]).then(function(){var e=Object(s.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Te(t[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(o.useEffect)((function(){k&&fe()}),[de,k]),Object(N.jsx)(P.Provider,{value:{cCList:U,selection:Q},children:Object(N.jsxs)(l.a,{fluid:!0,className:"pb-5",children:[Object(N.jsx)(d.a,{icon:"fa fa-credit-card",intlId:"creditCard"}),J?Object(N.jsx)(xe,{}):Object(N.jsxs)(N.Fragment,{children:[ve&&(null===(e=Object.keys(ve))||void 0===e?void 0:e.length)>0&&Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(C.a,{className:"pt-3",config:ye.config,Table:ye.Table,TableRows:ye.TableRows,TableAliasRows:ye.TableAliasRows,rowElements:ye.rowElements,defaultValues:ye.defaultValues,dbData:ve,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,n){var c=e.status,s=e.data;if(200===c){if(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&a.renderToast({message:t.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&a.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&h.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(N.jsx)(S.b,{}),content:Object(N.jsx)(S.a,{})}),e&&s&&"object"===typeof s.response&&null!==s.response){var r;r=1451===s.response.number?"foreignKeyDeleteMessage":"",a.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:r,defaultMessage:r})})}}else a.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,ye.id)},apiParams:se,onChangeParams:function(e){return function(e){re((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)},onReFetchData:function(){return _e()},cellWidth:ye.cellWidth,ajaxButtonName:t.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"credit_card_appId",value:a.userConfig.appId},theme:a.userData.theme})}),Object(N.jsxs)(u.a,{className:"align-items-center ".concat(!Object.keys(ee).length>0?"pb-5":""),children:[Object(N.jsx)(b.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(N.jsx)(m.a,{placeholder:"".concat(t.formatMessage({id:"select",defaultMessage:"select"})," ").concat(t.formatMessage({id:"creditCard",defaultMessage:"creditCard"})),onChange:function(e,t,a){X((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:t})}))},element:{fetch:{dropDownList:U.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Q.creditCard,type:"single",searchable:!0,theme:a.userData.theme})}),Object(N.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(N.jsx)("span",{children:Object(N.jsx)(g.a,{id:"startDate",defaultMessage:"startDate"})}),Object(N.jsx)(O.a,{className:"bg-white text-dark",value:Q.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(t){return Object(n.a)(Object(n.a)({},t),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(N.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(N.jsx)("span",{children:Object(N.jsx)(g.a,{id:"endDate",defaultMessage:"endDate"})}),Object(N.jsx)(O.a,{className:"bg-white text-dark",value:Q.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(t){return Object(n.a)(Object(n.a)({},t),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(N.jsx)(b.a,{sm:3,className:"pb-2",children:Object(N.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return fe()},disabled:!Q.creditCard,children:Object(N.jsx)(g.a,{id:"generate",defaultMessage:"generate"})})})]})]}),V&&Object(N.jsx)(xe,{}),ee&&Object.keys(ee).length>0&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"py-2",children:Object(N.jsx)("span",{className:"badge ".concat("dark"===a.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:t.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),Object(N.jsx)(C.a,{id:ue.id,config:ue.config,Table:ue.Table,TableRows:ue.TableRows,TableAliasRows:ue.TableAliasRows,rowElements:ue.rowElements,defaultValues:ue.defaultValues,dbData:ee,cellWidth:[20,10,10,10,10,10,10],theme:a.userData.theme,apiParams:de,onChangeParams:function(e){return function(e){le((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)}})]}),0===Object.keys(ee).length&&k&&!V&&Object(N.jsx)("div",{className:"text-center py-2",children:Object(N.jsx)(g.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},81:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1),c=a(76),s=function(){var e=Object(c.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);