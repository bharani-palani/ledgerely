"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[2272],{9595:(e,a,t)=>{t.d(a,{I:()=>l});var s=t(9950),n=t(8429);const l=()=>{const{search:e}=(0,n.zy)();return(0,s.useMemo)((()=>new URLSearchParams(e)),[e])}},2272:(e,a,t)=>{t.r(a),t.d(a,{AccountContext:()=>ne,default:()=>le});var s=t(9950),n=t(8311),l=t(2083),r=t(4078),o=t(9051),c=t.n(o),i=t(5472),d=t.n(i),u=t(3027),m=t(4408),p=t(7391),g=t(2436),h=t(6781),f=t(8459),x=t(4414);const b=(0,m.Ay)((e=>{const{intl:a}=e,t=(0,s.useContext)(ne),{chartData:n,bankDetails:o,onMonthYearSelected:i,monthYearSelected:m}=t,b=(0,s.useContext)(p.U),M=(0,s.useContext)(g.R),j=(0,s.useRef)(null),[v,y]=(0,s.useState)([]),[_,D]=(0,s.useState)([]),[N,Y]=(0,s.useState)(0),[A,C]=(0,s.useState)({}),S=getComputedStyle(document.documentElement).getPropertyValue("--bs-indigo"),w=getComputedStyle(document.documentElement).getPropertyValue("--bs-pink"),k="debit-card-income";(0,s.useEffect)((()=>{Y(j.current.clientWidth)}),[]),(0,s.useEffect)((()=>{var e,a;const t=e=>{let{category:a,total:t,dated:s}=e;return{month:s,label:l.A.shorten(a,15),value:Number(t),isEmpty:Number(t)<=0}},s=n.category.map((e=>{var a,s,n,l;return{month:e.month,cData:(null===e||void 0===e||null===(a=e.data)||void 0===a||null===(s=a.expense)||void 0===s?void 0:s.length)>0?e.data.expense.map((a=>t({category:a.category,total:a.total,dated:e.month}))):[t({category:"No Data",total:0,dated:null})],creditData:(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(l=n.income)||void 0===l?void 0:l.length)>0?e.data.income.map((a=>t({category:a.category,total:a.total,dated:e.month}))):[t({category:"No Data",total:0,dated:null})]}}));y(s);const r=[{color:S,points:n.income.map((e=>{let{month:a,measureDate:t,monthStart:s,monthEnd:n,totalIncome:l,metricIncome:r}=e;return{month:a,x:s,z:n,y:l,metricTotal:r,measureDate:new Date(t)}}))},{color:w,points:n.income.map((e=>{let{month:a,monthStart:t,monthEnd:s,metricIncome:n}=e;return{month:a,x:t,z:s,y:n}}))}];D([]);const c=r[1].points.filter((e=>0!==e.y)),i=new Date(null===(e=c[c.length-1])||void 0===e?void 0:e.x),d=new Date(null===(a=c[0])||void 0===a?void 0:a.z),u=T(i,d);setTimeout((()=>{var e,a;D(r);const t=r[0].points.reduce(((e,a)=>e+a.metricTotal),0),s=l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,t/(40*u)||0,2),n=l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,t/(5*u)||0,2),c=l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,t/u||0,2);C({hourly:s,daily:n,weekly:c}),null!==(e=j.current)&&void 0!==e&&null!==(a=e.childNodes[2])&&void 0!==a&&a.childNodes[0]&&(j.current.childNodes[2].childNodes[0].style.height=260)}),1)}),[n,b]),(0,s.useEffect)((()=>{if(_.length>0&&v.length>0){var e,a,t;const l=e=>{const a=e.target.id;i(a)},r=null===(e=j.current)||void 0===e||null===(a=e.querySelector(`#${k} svg`))||void 0===a?void 0:a.getElementsByClassName("axis")[0].children,o=r&&(null===(t=Array.from(r))||void 0===t?void 0:t.filter((e=>e.classList.contains("tick"))).reverse()),c=[..._[1].points];for(let e=0;e<o.length;e++){var s;o[e].children[1].classList.remove("colored"),o[e].children[1].setAttribute("id",null===(s=c[e])||void 0===s?void 0:s.month),o[e].children[1].addEventListener("click",l)}if(m){var n;const e=o&&(null===(n=Array.from(o))||void 0===n?void 0:n.filter((e=>e.children[1].id===m))[0]);e&&e.getElementsByTagName("text")[0].classList.add("colored")}return()=>{for(let e=0;e<o.length;e++)o[e].children[1].removeEventListener("click",l)}}}),[m,_,v]);const T=(e,a)=>{const t=Math.floor((a-e)/864e5);return Math.ceil(t/7)||1},$=l.A.donutChartColors,I=(e,a)=>{let t=isFinite(Math[a](...e))?Math[a](...e):0;return t=l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,t,2),t},P=e=>{let{i18Key:t,value:s}=e;return(0,x.jsxs)("div",{className:"position-relative small py-4",children:[a.formatMessage({id:t,defaultMessage:t}),(0,x.jsx)("span",{title:s,className:"position-absolute top-0 start-50 translate-middle rounded-pill bni-bg bni-text w-100 py-2 text-break",children:s})]})};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{ref:j,children:_.length>0&&v.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"badge bni-bg bni-text",children:(0,x.jsx)(u.A,{id:"incomeMetrics",defaultMessage:"incomeMetrics"})}),(0,x.jsxs)(h.A,{className:"mt-3",children:[(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"total",value:(e=>{let a=e.reduce(((e,a)=>e+a.metricTotal),0);return a=l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,a,2),a})(_[0].points)})}),(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"highest",value:I(_[0].points.filter((e=>0!==e.metricTotal)).map((e=>e.metricTotal)),"max")})}),(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"lowest",value:I(_[0].points.filter((e=>0!==e.metricTotal)).map((e=>e.metricTotal)),"min")})}),(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"weekly",value:A.weekly})}),(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"daily",value:A.daily})}),(0,x.jsx)(f.A,{lg:2,sm:4,xs:6,className:"py-2 text-center",children:(0,x.jsx)(P,{i18Key:"hourly",value:A.hourly})})]}),(0,x.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,x.jsx)("div",{children:(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{style:{color:S},className:"fa fa-circle me-2",title:a.formatMessage({id:"credit",defaultMessage:"credit"})}),a.formatMessage({id:"credit",defaultMessage:"credit"})]})}),(0,x.jsxs)("div",{className:"fst-italic text-wrap",children:[(0,x.jsx)("sup",{className:"text-danger",children:"*"}),a.formatMessage({id:"CreditInclusiveIncome",defaultMessage:"CreditInclusiveIncome"})]}),(0,x.jsx)("div",{children:(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{style:{color:w},className:"fa fa-circle me-2",title:a.formatMessage({id:"income",defaultMessage:"income"})}),a.formatMessage({id:"income",defaultMessage:"income"})]})})]}),(0,x.jsx)(d(),{data:_,id:k,margins:{top:50,right:N>450?80:30,bottom:50,left:135},width:N,isDate:!0,height:250,xLabel:a.formatMessage({id:"month",defaultMessage:"month"}),yLabel:`${a.formatMessage({id:"credit",defaultMessage:"credit"})} & ${a.formatMessage({id:"income",defaultMessage:"income"})}`,onPointHover:e=>l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,e.y,2),tooltipClass:"line-chart-tooltip",ticks:v.length,xDisplay:(e,t)=>(e=>{let t="";if(N>450){t=c()(e).format("MMM");const s=t.toLocaleString("default",{month:"short"}).toLowerCase(),n=e.getFullYear();t=`${a.formatMessage({id:s,defaultMessage:s})} ${n}`}else t=c()(e).format("M");return t})(e),onPointClick:(e,a)=>{i(a.month)}})]})}),(0,x.jsx)("div",{className:"x-scroll",children:v.length>0&&(0,x.jsx)("div",{className:"d-flex align-items-center pt-2 ps-3",children:v.map(((e,t)=>(0,x.jsxs)("div",{className:"chartWrapper",children:[(0,x.jsx)("div",{className:"text-center pt-10 pb-10",children:(0,x.jsx)("button",{className:"btn btn-sm btn-bni "+(String(m)===String(e.month)?"active":""),onClick:()=>{i(e.month)},children:`${a.formatMessage({id:e.month.split("-")[0].toLowerCase(),defaultMessage:e.month.split("-")[0].toLowerCase()})} ${e.month.split("-")[1]}`})}),(0,x.jsxs)("div",{className:"floatingChartWrapper",children:[t<1&&(0,x.jsx)("div",{className:"floatingChartHeader btn btn-sm btn-bni",children:(0,x.jsx)(u.A,{id:"expense",defaultMessage:"expense"})}),(0,x.jsx)(r.A,{strokeColor:""+("dark"===M.userData.theme?"#000":"#eee"),innerRadius:.7,outerRadius:.9,clickToggle:!0,colors:$,height:220,width:220,legend:!1,data:e.cData,formatValues:(e,a)=>`${l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,e,2)}`})]}),(0,x.jsxs)("div",{className:"floatingChartWrapper",children:[t<1&&(0,x.jsx)("div",{className:"floatingChartHeader btn btn-sm btn-bni",children:(0,x.jsx)(u.A,{id:"income",defaultMessage:"income"})}),(0,x.jsx)(r.A,{strokeColor:""+("dark"===M.userData.theme?"#000":"#eee"),innerRadius:.7,outerRadius:.9,clickToggle:!0,colors:$,height:220,width:220,legend:!1,data:e.creditData,formatValues:(e,a)=>`${l.A.countryCurrencyLacSeperator(o[0].bank_locale,o[0].bank_currency,e,2)}`})]})]},(e=>`chart-${e}`)(t))))})})]})}));t(3742);var M=t(1397),j=t.n(M);const v=(0,m.Ay)((e=>{var a;const t=(0,s.useContext)(ne),n=(0,s.useContext)(p.U),{data:r,intl:o}=e,{ccMonthYearSelected:i,ccDetails:m,setCcDetails:g,onCcMonthYearSelected:h}=t,[f,b]=(0,s.useState)(0),[M,v]=(0,s.useState)([]),[y,_]=(0,s.useState)(!0),D=(0,s.useRef)(null),N=getComputedStyle(document.documentElement).getPropertyValue("--bs-danger"),Y=getComputedStyle(document.documentElement).getPropertyValue("--bs-primary"),A=getComputedStyle(document.documentElement).getPropertyValue("--bs-success"),C=getComputedStyle(document.documentElement).getPropertyValue("--bs-warning"),[S,w]=(0,s.useState)({}),k="credit-card-usage";(0,s.useEffect)((()=>{const[e,a]=i.split("-"),t=l.A.strToNumMonth[e],s=Number(m.credit_card_start_date),n=Number(m.credit_card_end_date),r=new Date(`${Number(a)}-${Number(t)}-${n}`.replace(/-/g,"/")),o=`${r.getFullYear()}-${l.A.leadingZeros(r.getMonth()+1)}-${l.A.leadingZeros(r.getDate())}`;let c=r.setTime(r.getTime()-2592e6);c=new Date(c),c=new Date(c.setDate(s));const d=`${c.getFullYear()}-${l.A.leadingZeros(c.getMonth()+1)}-${l.A.leadingZeros(c.getDate())}`;let u=Number(m.credit_card_payment_date);u=u<10?`0${u}`:u,u=new Date(`${u}-${i}`),u=l.A.addMonths(u,1);let[p,h,f]=[u.getFullYear(),u.getMonth()+1,u.getDate()];h=h<10?`0${h}`:h,f=f<10?`0${f}`:f,u=`${p}-${h}-${f}`,w({sDateStr:d,eDateStr:o,payDate:u}),g((e=>({...e,creditCardCycleStartDate:d,creditCardCycleEndDate:o}))),b(D.current.clientWidth)}),[i]),(0,s.useEffect)((()=>{if(y&&M.length>0){var e,a,t;const n=e=>{const a=e.target.id;h(a)},l=null===(e=D.current)||void 0===e||null===(a=e.querySelector(`#${k} svg`))||void 0===a?void 0:a.getElementsByClassName("axis")[0].children,r=l&&(null===(t=Array.from(l))||void 0===t?void 0:t.filter((e=>e.classList.contains("tick"))));for(let e=0;e<r.length;e++)r[e].children[1].classList.remove("colored"),r[e].children[1].setAttribute("id",M[0].points[e].month),r[e].children[1].addEventListener("click",n);if(i){var s;const e=r&&(null===(s=Array.from(r))||void 0===s?void 0:s.filter((e=>e.children[1].id===i))[0]);e&&e.getElementsByTagName("text")[0].classList.add("colored")}return()=>{for(let e=0;e<r.length;e++)r[e].children[1].removeEventListener("click",n)}}}),[i,y,M]);const T=e=>{const a=i.split("-")[1];let t=new Array(12).fill().map(((e,a)=>a>8?String(a+1):`0${a+1}`)).map((t=>{const s=l.A.monthToStr[t],n=r.filter((e=>e.month.split("-")[0].includes(s))),o=n.length?n[0].cData.filter((a=>a.label===e))[0].value:0;return{x:c()(`${a}/${t}/01`).format("YYYY-MM-DD"),y:o,month:`${s}-${a}`}}));return t=j().flatten(t),t},$=e=>{let a=T(e).reduce(((e,a)=>e+Number(a.y.toFixed(2))),0);return a=l.A.countryCurrencyLacSeperator(m.credit_card_locale,m.credit_card_currency,a,2),a};(0,s.useEffect)((()=>{if(r.length>0){var e,a;const t=[{color:N,points:T("Taxes & Interest")},{color:Y,points:T("Purchases")},{color:A,points:T("Paid")},{color:C,points:T("Opening Balance")}];v([]),setTimeout((()=>{v(t)}),100),null!==(e=D.current)&&void 0!==e&&null!==(a=e.childNodes[2])&&void 0!==a&&a.childNodes[0]&&(D.current.childNodes[2].childNodes[0].style.height=260)}}),[r]);const I=e=>{if(null!==o&&void 0!==o&&o.formatMessage){let a="";if(f>450){a=c()(e).format("MMM");const t=a.toLocaleString("default",{month:"short"}).toLowerCase(),s=e.getFullYear();a=`${o.formatMessage({id:t,defaultMessage:t})} ${s}`}else a=c()(e).format("M");return a}};return(0,x.jsxs)("div",{ref:D,className:"position-relative",children:[(0,x.jsx)("i",{className:`fa fa-${y?"minus":"plus"}-circle roundedButton`,onClick:()=>_(!y),style:y?{}:{position:"absolute",top:"15px"}}),y&&M.length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"row rounded pt-2",children:[(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fa fa-circle text-warning me-2",title:o.formatMessage({id:"openingBalance",defaultMessage:"openingBalance"})}),(0,x.jsx)(u.A,{id:"openingBalance",defaultMessage:"openingBalance"})]}),(0,x.jsxs)("span",{children:[(0,x.jsx)("span",{className:"pe-2",children:(0,x.jsx)(u.A,{id:"year",defaultMessage:"year"})}),null===(a=r[0])||void 0===a?void 0:a.month.split("-")[1]]})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fa fa-circle text-primary me-2",title:o.formatMessage({id:"purchases",defaultMessage:"purchases"})}),(0,x.jsx)(u.A,{id:"purchases",defaultMessage:"purchases"})]}),(0,x.jsx)("span",{children:`${$("Purchases")}`})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fa fa-circle text-success me-2",title:o.formatMessage({id:"payments",defaultMessage:"payments"})}),(0,x.jsx)(u.A,{id:"payments",defaultMessage:"payments"})]}),(0,x.jsx)("span",{children:`${$("Paid")}`})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex flex-nowrap justify-content-between align-items-center",children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("i",{className:"fa fa-circle text-danger me-2",title:o.formatMessage({id:"taxesAndInterest",defaultMessage:"taxesAndInterest"})}),(0,x.jsx)(u.A,{id:"taxesAndInterest",defaultMessage:"taxesAndInterest"})]}),(0,x.jsx)("span",{children:`${$("Taxes & Interest")}`})]})]}),(0,x.jsx)(d(),{data:M,id:k,margins:{top:50,right:f>450?80:30,bottom:50,left:135},width:f,isDate:!0,height:250,xLabel:o.formatMessage({id:"month",defaultMessage:"month"}),yLabel:o.formatMessage({id:"amount",defaultMessage:"amount"}),onPointHover:e=>l.A.countryCurrencyLacSeperator(n.localeLanguage,n.localeCurrency,e.y,2),tooltipClass:"line-chart-tooltip",ticks:12,xDisplay:(e,a)=>I(e),onPointClick:(e,a)=>h(a.month)}),i&&S&&m&&S.payDate&&(0,x.jsx)("div",{className:"pt-4",children:(0,x.jsxs)("div",{className:"row mt-10",children:[(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between",children:[(0,x.jsx)("span",{children:(0,x.jsx)(u.A,{id:"month",defaultMessage:"month"})}),(0,x.jsx)("span",{children:I(new Date(`\n                        ${i.split("-")[1]}/${l.A.strToNumMonth[i.split("-")[0]]}/01`))})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between align-items-center",children:[(0,x.jsx)("i",{className:"fa fa-credit-card-alt"}),(0,x.jsx)("span",{children:m.credit_card_number})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between align-items-center",children:[(0,x.jsx)("span",{children:(0,x.jsx)(u.A,{id:"cycle",defaultMessage:"cycle"})}),(0,x.jsxs)("span",{children:[S.sDateStr," ",(0,x.jsx)(u.A,{id:"to",defaultMessage:"to"})," ",S.eDateStr]})]}),(0,x.jsxs)("div",{className:"col-md-3 small d-flex justify-content-between",children:[(0,x.jsx)("span",{children:(0,x.jsx)(u.A,{id:"payDate",defaultMessage:"payDate"})}),(0,x.jsx)("span",{children:S.payDate})]})]})})]})]})})),y=e=>{const a=(0,s.useContext)(ne),{ccChartData:t,ccYearSelected:n,ccDetails:l,onCcMonthYearSelected:r}=a,[o,c]=(0,s.useState)([]);return(0,s.useEffect)((()=>{if(t.length>0){const e=t.map((e=>({month:e.month,cData:[{label:"Opening Balance",value:e.data.ob},{label:"Paid",value:e.data.paid},{label:"Purchases",value:e.data.purchases},{label:"Taxes & Interest",value:e.data.taxesInterest},{label:"Balance",value:e.data.balance}]})));c(e)}}),[t,l,n,r]),(0,x.jsx)(v,{data:o})};var _=t(8630),D=t(4570),N=t(5942),Y=t(1432),A=t(9019),C=(t(764),t(4268)),S=t(9288);const w=e=>{const a=(0,S.A)(),{monthYearSelected:t,bankSelected:r,selectedPlan:o,...c}=e,i=(0,s.useContext)(g.R),d=(0,s.useContext)(p.U),[m,h]=(0,s.useState)([]),[f,b]=(0,s.useState)(!0);(0,s.useEffect)((()=>{b(!0);const e=M();Promise.all([e]).then((e=>{const a=e[0];h(a),b(!1)}))}),[t,r,o]);const M=()=>{const e=new FormData;return e.append("startDate",o.startDate),e.append("endDate",o.endDate),e.append("bankSelected",r),e.append("criteria",o.criteria),e.append("appId",i.userConfig.appId),D.A.post("/account_planner/getPlanDetails",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))},j=(e,a)=>"E0"===o.criteria?Number(e):"0TO100"===o.criteria||"E100"===o.criteria||"G100"===o.criteria?Number(e)-Number(a):0,v=e=>{const a=e.reduce(((e,a)=>e+a),0);return l.A.countryCurrencyLacSeperator(d.localeLanguage,d.localeCurrency,a,2)},y=[],_=[],N=[];return(0,x.jsxs)(C.A,{...c,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsxs)(C.A.Title,{children:[a.formatMessage({id:t.split("-")[0].toLowerCase(),defaultMessage:t.split("-")[0].toLowerCase()})," ",t.split("-")[1]," ",(0,x.jsx)("i",{className:"fa fa-angle-double-right"})," ",o.label]})}),(0,x.jsx)(C.A.Body,{className:"rounded-bottom "+("dark"===i.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsx)("div",{className:"table-responsive p-10",children:f?(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})}):(0,x.jsx)("table",{className:"table "+("dark"===i.userData.theme?"table-dark":"table-white"),children:(0,x.jsxs)("tbody",{children:[(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"#"}),(0,x.jsx)("th",{children:(0,x.jsx)(u.A,{id:"expense",defaultMessage:"expense"})}),(0,x.jsx)("th",{children:(0,x.jsx)(u.A,{id:"committed",defaultMessage:"committed"})}),(0,x.jsx)("th",{children:(0,x.jsx)(u.A,{id:"plan",defaultMessage:"plan"})}),(0,x.jsx)("th",{children:(0,x.jsx)(u.A,{id:"difference",defaultMessage:"difference"})})]}),m&&m.length>0?m.map(((e,a)=>{const t=j(e.inc_exp_plan_amount,e.inc_exp_amount);y.push(Number(e.inc_exp_amount)),_.push(Number(e.inc_exp_plan_amount));const s=j(e.inc_exp_plan_amount,e.inc_exp_amount);return N.push(s),(0,x.jsxs)("tr",{children:[(0,x.jsxs)("td",{children:[a+1,"."]}),(0,x.jsx)("td",{children:e.inc_exp_name}),(0,x.jsx)("td",{children:e.inc_exp_amount}),(0,x.jsx)("td",{children:e.inc_exp_plan_amount}),(0,x.jsx)("td",{className:"text-"+(t>=0?"success":"danger"),children:t>=0?`+${l.A.countryCurrencyLacSeperator(d.localeLanguage,d.localeCurrency,t,2)}`:`(${l.A.countryCurrencyLacSeperator(d.localeLanguage,d.localeCurrency,t,2)})`})]},a)})):(0,x.jsx)("tr",{children:(0,x.jsx)("td",{className:"text-center py-3",colSpan:"5",children:(0,x.jsx)(u.A,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})})}),m&&m.length>0&&(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:(0,x.jsx)(u.A,{id:"total",defaultMessage:"total"})}),(0,x.jsx)("td",{}),(0,x.jsx)("td",{children:v(y)}),(0,x.jsx)("td",{children:v(_)}),(0,x.jsx)("td",{children:v(N)})]})]})})})})]})},k=e=>{const a=(0,S.A)(),t=(0,s.useContext)(g.R),n=(0,s.useContext)(p.U),{totals:r,...o}=e,[c,i]=(0,s.useState)(0),[d,m]=(0,s.useState)(0),[h,f]=(0,s.useState)(0),[b,M]=(0,s.useState)(0),[j,v]=(0,s.useState)(0),[y,_]=(0,s.useState)(0);(0,s.useEffect)((()=>{if(r.length>0){let e=r.length>0&&r.filter((e=>"danger"===e.flagString&&e.amount>0));e=e.length>0?e[0].amount:0,e=e.toFixed(2),e=Number(e),i(e)}}),[r]),(0,s.useEffect)((()=>{let e=c-d-h-b;e=Math.round(100*e)/100,e=-0===e?0:e,v(e);let a=(Number(c)-e)/c;a*=100,a=a>100?100:a,a=isNaN(a)?100:a,_(a)}),[c,d,h,b]);const D=e=>({label:0===e?a.formatMessage({id:"solved",defaultMessage:"solved"}):e>0?a.formatMessage({id:"behind",defaultMessage:"behind"}):a.formatMessage({id:"ahead",defaultMessage:"ahead"}),class:0===e?"text-success":e>0?"text-danger":"text-primary"});return(0,x.jsxs)(C.A,{...o,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"tally",defaultMessage:"tally"})})}),(0,x.jsx)(C.A.Body,{className:"rounded-bottom "+("dark"===t.userData.theme?"bg-dark":"bg-white"),children:(0,x.jsxs)("div",{className:"tallyModal text-dark",children:[(0,x.jsxs)("div",{className:"py-2 form-floating",children:[(0,x.jsx)("input",{id:"appplicationBalance",value:c,onChange:e=>i(Number(e.target.value)),placeholder:a.formatMessage({id:"balance",defaultMessage:"balance"}),type:"number",className:"form-control",readOnly:!0}),(0,x.jsx)("label",{htmlFor:"appplicationBalance",children:(0,x.jsx)(u.A,{id:"balance",defaultMessage:"balance"})})]}),(0,x.jsxs)("div",{className:"py-2 form-floating",children:[(0,x.jsx)("input",{id:"bankBalance",onChange:e=>m(Number(e.target.value)),type:"number",className:"form-control",placeholder:`${a.formatMessage({id:"bank",defaultMessage:"bank"})} ${a.formatMessage({id:"balance",defaultMessage:"balance"})}`}),(0,x.jsxs)("label",{htmlFor:"bankBalance",children:[(0,x.jsx)(u.A,{id:"bank",defaultMessage:"bank"})," ",(0,x.jsx)(u.A,{id:"balance",defaultMessage:"balance"})]})]}),(0,x.jsxs)("div",{className:"py-2 form-floating",children:[(0,x.jsx)("input",{id:"unAccounted",onChange:e=>f(Number(e.target.value)),type:"number",className:"form-control",placeholder:a.formatMessage({id:"unaccounted",defaultMessage:"unaccounted"})}),(0,x.jsx)("label",{htmlFor:"unAccounted",children:(0,x.jsx)(u.A,{id:"unaccounted",defaultMessage:"unaccounted"})})]}),(0,x.jsxs)("div",{className:"py-2 form-floating",children:[(0,x.jsx)("input",{id:"walletBalance",onChange:e=>M(Number(e.target.value)),type:"number",className:"form-control",placeholder:`${a.formatMessage({id:"wallet",defaultMessage:"wallet"})} ${a.formatMessage({id:"balance",defaultMessage:"balance"})}`}),(0,x.jsxs)("label",{htmlFor:"walletBalance",children:[(0,x.jsx)(u.A,{id:"wallet",defaultMessage:"wallet"})," ",(0,x.jsx)(u.A,{id:"balance",defaultMessage:"balance"})]})]}),(0,x.jsxs)("div",{className:"py-2",children:[(0,x.jsx)("div",{className:"text-center p-10",children:(0,x.jsxs)("h5",{className:D(j).class,children:[D(j).label,"\xa0",(0,x.jsx)("i",{className:"fa "+(100===y?"fa-check":"fa-times-circle")})]})}),(0,x.jsx)("div",{className:`text-center ${D(j).class}`,children:l.A.countryCurrencyLacSeperator(n.localeLanguage,n.localeCurrency,j,2)})]}),(0,x.jsx)("div",{className:"custom-progress-bar "+(y<100?"danger":"success"),style:{width:`${y}%`}})]})})]})};var T=t(970);const $=e=>{const a=(0,s.useContext)(ne),{srcArr:t,...n}=e,{incExpList:l}=a,[r,o]=(0,s.useState)([]),[i,d]=(0,s.useState)([]),m=(0,S.A)(),p=(0,s.useContext)(g.R),[h,f]=(0,s.useState)({amount:"",source:"",dest:"",description:m.formatMessage({id:"fundTransfer",defaultMessage:"fundTransfer"}),category:"",availableFunds:0});(0,s.useEffect)((()=>{t&&t.length>0&&o(t)}),[t]);(0,s.useEffect)((()=>{const e=new FormData;e.append("id",h.source),e.append("appId",p.userConfig.appId),D.A.post("/account_planner/getFundDetails",e).then((e=>{f((a=>({...a,availableFunds:e.data.response[0].availableFunds})))})).catch((e=>{console.log(e)}))}),[h.source]);return(0,x.jsxs)(C.A,{...n,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"fundTransfer",defaultMessage:"fundTransfer"})})}),(0,x.jsx)(C.A.Body,{className:"p-0 rounded-bottom "+("dark"===p.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsxs)("div",{className:"row m-0",children:[(0,x.jsxs)("div",{className:"col-5 pt-3",children:[(0,x.jsxs)("div",{className:"py-3 text-center",children:[(0,x.jsx)("div",{children:(0,x.jsx)("i",{className:"fa fa-bank fa-3x"})}),(0,x.jsx)("small",{children:(0,x.jsx)(u.A,{id:"sourceBank",defaultMessage:"sourceBank"})})]}),(0,x.jsxs)("div",{className:"form-floating mt-1",children:[(0,x.jsx)(T.A,{placeholder:`${m.formatMessage({id:"selectSourceAccount",defaultMessage:"selectSourceAccount"})}`,onChange:(e,a,t)=>{(e=>{const a=[...r].filter((a=>a.id!==e));d(a),f((a=>({...a,source:e,dest:"",amount:"",category:""})))})(a)},element:{fetch:{dropDownList:r.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:h.source,type:"single",searchable:!0,theme:p.userData.theme}),Number(h.availableFunds)>0&&(0,x.jsxs)("small",{className:"text-danger",children:[(0,x.jsx)(u.A,{id:"balance",defaultMessage:"balance"}),":",Number(h.availableFunds).toLocaleString()]})]})]}),(0,x.jsx)("div",{className:"col-2 d-flex align-items-center justify-content-center",children:(0,x.jsx)("i",{className:"fa fa-arrow-circle-right fa-3x"})}),(0,x.jsxs)("div",{className:"col-5 pt-3",children:[(0,x.jsxs)("div",{className:"py-3 text-center",children:[(0,x.jsx)("div",{children:(0,x.jsx)("i",{className:"fa fa-bank fa-3x"})}),(0,x.jsx)("small",{children:(0,x.jsx)(u.A,{id:"destinationBank",defaultMessage:"destinationBank"})})]}),(0,x.jsx)("div",{className:"form-floating mt-1",children:(0,x.jsx)(T.A,{placeholder:`${m.formatMessage({id:"selectDestinationAccount",defaultMessage:"selectDestinationAccount"})}`,onChange:(e,a,t)=>{f((e=>({...e,dest:a})))},element:{fetch:{dropDownList:i.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:h.dest,type:"single",searchable:!0,theme:p.userData.theme})})]}),(0,x.jsx)("div",{className:"col-12 pt-3",children:(0,x.jsx)("div",{className:"form-floating",children:(0,x.jsx)(T.A,{placeholder:`${m.formatMessage({id:"category",defaultMessage:"category"})}`,onChange:(e,a,t)=>{f((e=>({...e,category:a})))},element:{fetch:{dropDownList:l.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:h.category,type:"single",searchable:!0,theme:p.userData.theme})})}),(0,x.jsx)("div",{className:"col-12 pt-3",children:(0,x.jsxs)("div",{className:"form-floating",children:[(0,x.jsx)("input",{id:"amount",value:h.amount,onChange:e=>f((a=>({...a,amount:e.target.value}))),placeholder:m.formatMessage({id:"amount",defaultMessage:"amount"}),type:"number",className:"form-control form-control-sm"}),(0,x.jsx)("label",{htmlFor:"amount",className:"text-dark",children:(0,x.jsx)(u.A,{id:"amount",defaultMessage:"amount"})})]})}),(0,x.jsx)("div",{className:"col-12 py-3",children:(0,x.jsx)("button",{disabled:!(h.dest&&h.amount&&h.source&&h.category),className:"btn btn-bni w-100 border-0",onClick:()=>(()=>{const e=new FormData;e.append("amount",h.amount),e.append("source",h.source),e.append("dest",h.dest),e.append("description",`${h.description}: ${r.filter((e=>e.id===h.source))[0].value} -> ${r.filter((e=>e.id===h.dest))[0].value}`),e.append("category",h.category),e.append("date",c()(new Date).format("YYYY-MM-DD")),e.append("dateTime",c()(new Date).format("YYYY-MM-DD HH:mm:ss")),e.append("appId",p.userConfig.appId),D.A.post("/account_planner/postFundTransfer",e).then((e=>{const{data:a}=e;e&&a&&a.response?(p.renderToast({message:m.formatMessage({id:"fundTransferSuccess",defaultMessage:"fundTransferSuccess"})}),f((e=>({...e,source:"",dest:"",amount:"",category:"",description:m.formatMessage({id:"fundTransfer",defaultMessage:"fundTransfer"})})))):p.renderToast({type:"error",icon:"fa fa-times-circle",message:m.formatMessage({id:"fundTransferFail",defaultMessage:"fundTransferFail"})})})).catch((e=>{p.renderToast({type:"error",icon:"fa fa-times-circle",message:m.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}))})(),children:(0,x.jsx)(u.A,{id:"submit",defaultMessage:"submit"})})})]})})]})};var I=t(8516),P=t(9845),F=t(6731),E=t(9595);const L=(0,m.Ay)(((e,a)=>{var t;const r=(0,s.useContext)(ne),o=(0,s.useContext)(g.R),i=(0,s.useContext)(P.O),{intl:d,...m}=e,{incExpList:p,bankList:h,bankSelected:f,bankDetails:b,monthYearSelected:M}=r,j={fetch:{dropDownList:p.map((e=>{let{id:a,value:t}=e;return{id:a,value:t}}))},searchable:!0},v={fetch:{dropDownList:h},searchable:!0},[y,C]=(0,s.useState)([]),[S,T]=(0,s.useState)([{key:"goodPlans",flagString:"success",planString:"goodPlans",planCount:0,planTotal:0},{key:"achievedPlans",flagString:"info",planString:"achievedPlans",planCount:0,planTotal:0},{key:"badPlans",flagString:"danger",planString:"badPlans",planCount:0,planTotal:0},{key:"noPlans",flagString:"warning",planString:"noPlans",planCount:0,planTotal:0}]),[L,B]=(0,s.useState)({}),[R,V]=(0,s.useState)([{amount:0,label:"income",flagString:"success"},{amount:0,label:"expense",flagString:"info"},{amount:0,label:"balance",flagString:"danger"},{amount:0,label:"planning",flagString:"warning"}]),[H,O]=(0,s.useState)(!1),[z,K]=(0,s.useState)(!1),[U,G]=(0,s.useState)(!1),[W,Z]=(0,s.useState)({}),[J,q]=(0,s.useState)(!1),Q=l.A.getNow(),[X,ee]=(0,s.useState)({}),ae={start:0,limit:10,searchString:""},[te,se]=(0,s.useState)(null),[le,re]=(0,s.useState)(null);(0,s.useEffect)((()=>{ee({config:{header:{searchPlaceholder:d.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:d.formatMessage({id:"total",defaultMessage:"total"}),locale:b[0].bank_locale,currency:b[0].bank_currency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}},rowElements:[],Table:"income_expense",TableRows:["inc_exp_id","inc_exp_name","inc_exp_amount","inc_exp_plan_amount","inc_exp_type","inc_exp_date","inc_exp_category","inc_exp_bank","inc_exp_comments","inc_exp_added_at","inc_exp_is_planned"],TableAliasRows:["id","transaction","amount","plan","type","date","category","bank","comments","recorded","isPlanned"].map((e=>d.formatMessage({id:e,defaultMessage:e}))),defaultValues:[{inc_exp_type:"Dr"},{inc_exp_amount:0},{inc_exp_plan_amount:0},{inc_exp_date:c()(new Date).format("YYYY-MM-DD")}],showTooltipFor:["inc_exp_name","inc_exp_comments"]})}),[d]);const oe=e=>{if(le){B({}),q(!0);const[a,t]=le.split("-"),s=l.A.strToNumMonth[a],n=`inc_exp_date between "${t}-${s}-01" and "${t}-${s}-${new Date(t,s,0).getDate()}" and inc_exp_bank = ${f} and inc_exp_appId = "${o.userConfig.appId}"`,r=ce(n);Promise.all([r]).then((async a=>{var t;const s=a[0].data.response;B(s);const n=["checkbox","textbox","number",c()(null===s||void 0===s||null===(t=s.table[0])||void 0===t?void 0:t.inc_exp_date).isAfter()?"number":"label",{radio:{radioList:[{label:d.formatMessage({id:"credit",defaultMessage:"credit"}),value:"Cr",checked:!1},{label:d.formatMessage({id:"debit",defaultMessage:"debit"}),value:"Dr",checked:!0}]}},"date",j,v,"textbox","relativeTime","boolean"];C(n),ee((e=>({...e,rowElements:n}))),"function"===typeof e&&e(s)})).finally((()=>q(!1)))}},ce=e=>{const a=new FormData;return a.append("appId",o.userConfig.appId),a.append("TableRows",X.TableRows),a.append("Table",X.Table),a.append("limit",te.limit),a.append("start",te.start),a.append("searchString",te.searchString),e&&a.append("WhereClause",e),D.A.post("/account_planner/getAccountPlanner",a)},ie=(e,a)=>(0,x.jsx)(N.A,{id:"button-tooltip-1",className:"in show",...m,children:a}),de=()=>{(()=>{const[e,a]=le.split("-"),t=l.A.strToNumMonth[e],s=new Date(a,t,0).getDate(),n=new FormData;return n.append("appId",o.userConfig.appId),n.append("bank",f),n.append("startDate",`${a}-${t}-01`),n.append("endDate",`${a}-${t}-${s}`),D.A.post("/account_planner/getPlanSum",n)})().then((e=>{const a=e.data.response,t={goodPlans:a.goodPlans,goodPlanCount:a.goodPlanCount,badPlans:a.badPlans,badPlanCount:a.badPlanCount,noPlans:a.noPlans,noPlanCount:a.noPlanCount,achievedPlans:a.achievedPlans,achievedPlanCount:a.achievedPlanCount},s=[{planCount:t.goodPlanCount,planTotal:t.goodPlans},{planCount:t.achievedPlanCount,planTotal:t.achievedPlans},{planCount:t.badPlanCount,planTotal:t.badPlans},{planCount:t.noPlanCount,planTotal:t.noPlans}],n=S.map(((e,a)=>({...e,planCount:s[a].planCount,planTotal:s[a].planTotal})));T(n)})).catch((e=>console.log("bbb",e)))},ue=(0,E.I)(),me=s.useMemo((()=>({fetch:ue.get("fetch"),search:ue.get("search"),date:ue.get("date")})),[ue]);(0,s.useEffect)((()=>{re(M),setTimeout((()=>{se(ae)}),100)}),[M]),(0,s.useEffect)((()=>{if(me.fetch&&"bankTransactions"===me.fetch&&me.search&&me.date){const e=c()(me.date).format("MMM-YYYY");re(e),setTimeout((()=>{se({start:0,limit:10,searchString:me.search})}),100)}else re(M),setTimeout((()=>{se(ae)}),100)}),[me]),(0,s.useEffect)((()=>{le&&de()}),[le]),(0,s.useEffect)((()=>{oe()}),[te]),(0,s.useEffect)((()=>{if(Object.keys(L).length>0){var e,a,t,s,n,l,r,o;const c=[null===L||void 0===L||null===(e=L.total)||void 0===e||null===(a=e.inc_exp_amount[0])||void 0===a?void 0:a.value,null===L||void 0===L||null===(t=L.total)||void 0===t||null===(s=t.inc_exp_amount[1])||void 0===s?void 0:s.value,null===L||void 0===L||null===(n=L.total)||void 0===n||null===(l=n.inc_exp_amount[2])||void 0===l?void 0:l.value,null===L||void 0===L||null===(r=L.total)||void 0===r||null===(o=r.inc_exp_plan_amount[0])||void 0===o?void 0:o.value],i=R.map(((e,a)=>({...e,amount:c[a]})));V(i)}}),[L]);return(0,x.jsxs)("div",{className:"settings",children:[H&&(0,x.jsx)(w,{className:"planInfoModal",show:H,onHide:()=>O(!1),size:"lg",animation:!1,monthYearSelected:le,bankSelected:f,selectedPlan:W}),z&&(0,x.jsx)(k,{className:"planInfoModal",show:z,onHide:()=>K(!1),size:"sm",totals:R,animation:!1}),U&&X.rowElements[7].fetch.dropDownList.length>0&&(0,x.jsx)($,{className:"",show:U,onHide:()=>G(!1),size:"md",animation:!1,srcArr:X.rowElements[7].fetch.dropDownList,incExpList:X.rowElements[6].fetch.dropDownList,centered:!0}),(0,x.jsxs)("div",{className:"",children:[!J&&L&&(null===(t=Object.keys(L))||void 0===t?void 0:t.length)>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"buttonGrid",children:le&&L&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h6",{children:`${d.formatMessage({id:le.split("-")[0].toLowerCase(),defaultMessage:le.split("-")[0].toLowerCase()})} ${le.split("-")[1]}`}),(0,x.jsxs)("div",{className:"d-flex flex-row-reverse",children:[(0,x.jsx)("div",{children:(0,x.jsx)(Y.A,{placement:"left",delay:{show:250,hide:400},overlay:ie(0,d.formatMessage({id:"fundTransfer",defaultMessage:"fundTransfer"})),triggerType:"hover",children:(0,x.jsx)("i",{className:`fa fa-arrows-h roundedButton ${o.userData.theme} pull-right`,onClick:()=>G(!0)})})}),(0,x.jsx)("div",{children:(0,x.jsx)(Y.A,{placement:"top",delay:{show:250,hide:400},overlay:ie(0,d.formatMessage({id:"exportToValue",defaultMessage:"exportToValue"},{value:"PDF"})),triggerType:"hover",children:(0,x.jsx)("i",{onClick:()=>(()=>{const e=null===L||void 0===L?void 0:L.table.map(((e,a)=>{let{inc_exp_name:t,inc_exp_amount:s,inc_exp_plan_amount:n,inc_exp_type:l,inc_exp_date:r,inc_exp_comments:o}=e;return[a+1,t,s,n,l,r,o]})),a=new A.default;a.text(`${l.A.stringToCapitalize(X.Table)} (${le})`,15,10),a.autoTable({styles:{overflow:"linebreak"},theme:"grid",head:[["#","Transaction","Amount","Planned","Type","Date","Comments"]],body:[...e]});const t=R.map((e=>l.A.lacSeperator(e.amount)));a.autoTable({styles:{overflow:"linebreak",halign:"center"},theme:"striped",head:[["Income","Expense","Balance","Planning"]],body:[t]});const s=S.map((e=>{var a,t,s;return l.A.lacSeperator(null===e||void 0===e?void 0:e.planTotal,null===X||void 0===X||null===(a=X.config)||void 0===a||null===(t=a.footer)||void 0===t||null===(s=t.total)||void 0===s?void 0:s.currency)}));a.autoTable({styles:{overflow:"linebreak",halign:"center"},theme:"striped",head:[["Good Plans","Achieved Plans","Bad Plans","No Plans"]],body:[s]}),a.save(`${X.Table}-${Q}`)})(),className:`fa fa-file-pdf-o roundedButton ${o.userData.theme} pull-right`})})}),(0,x.jsx)(I.A,{datas:l.A.stripCommasInCSV(null===L||void 0===L?void 0:L.table),filename:`Income-Expense-${Q}.csv`,columns:[{displayName:"Transaction",id:"inc_exp_name"},{displayName:"Date",id:"inc_exp_date"},{displayName:"Type",id:"inc_exp_type"},{displayName:"Amount",id:"inc_exp_amount"}],children:(0,x.jsx)(Y.A,{placement:"top",delay:{show:250,hide:400},overlay:ie(0,d.formatMessage({id:"exportToValue",defaultMessage:"exportToValue"},{value:"CSV"})),triggerType:"hover",children:(0,x.jsx)("i",{className:`fa fa-file-excel-o roundedButton ${o.userData.theme} pull-right`})})}),(0,x.jsx)("div",{children:(0,x.jsx)(Y.A,{placement:"top",delay:{show:250,hide:400},overlay:ie(0,d.formatMessage({id:"replan",defaultMessage:"replan"})),triggerType:"hover",children:(0,x.jsx)("i",{onClick:()=>(()=>{const e=X.rowElements.map(((e,a)=>(3===a&&(e="number"===e?"label":"number"),e)));ee({...X,rowElements:e}),C(e)})(),className:`fa fa-repeat roundedButton ${o.userData.theme} pull-right`})})}),(0,x.jsx)("div",{children:(0,x.jsx)(Y.A,{placement:"top",delay:{show:250,hide:400},overlay:ie(0,d.formatMessage({id:"tally",defaultMessage:"tally"})),triggerType:"hover",children:(0,x.jsx)("i",{onClick:()=>K(!0),className:`fa fa-text-width roundedButton ${o.userData.theme} pull-right`})})})]})]})}),(0,x.jsx)(_.A,{id:"incExpTable",config:X.config,Table:X.Table,TableRows:X.TableRows,TableAliasRows:X.TableAliasRows,rowElements:y,dbData:L,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:e=>(e=>{const{status:a,data:t}=e;if(200===a){if(e&&t&&"boolean"===typeof t.response&&null!==t.response&&t.response&&r.renderToast({message:d.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&t&&"boolean"===typeof t.response&&null!==t.response&&!1===t.response&&r.renderToast({type:"error",icon:"fa fa-times-circle",message:d.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&t&&null===t.response&&i.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,x.jsx)(F.x,{}),content:(0,x.jsx)(F.E,{})}),e&&t&&"object"===typeof t.response&&null!==t.response){let e;e=1451===t.response.number?"foreignKeyDeleteMessage":"",o.renderToast({type:"error",icon:"fa fa-times-circle",message:d.formatMessage({id:e,defaultMessage:e})})}}else r.renderToast({type:"error",icon:"fa fa-times-circle",message:d.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(e),apiParams:te,onChangeParams:e=>(e=>{se((a=>({...a,...e})))})(e),showTooltipFor:X.showTooltipFor,defaultValues:X.defaultValues,onReFetchData:()=>{oe(),de()},cellWidth:[4,13,8,8,13,8,13,13,13,10,5],ajaxButtonName:d.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"inc_exp_appId",value:o.userConfig.appId},theme:o.userData.theme},"incExpTable"),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"row",children:R.map((e=>(0,x.jsx)("div",{className:"col-md-3 col-6 py-4",children:(0,x.jsxs)("div",{className:"",children:[(0,x.jsx)("div",{className:"",children:(0,x.jsx)("div",{className:"p-6 text-center",children:(0,x.jsx)("h5",{children:(0,x.jsx)(u.A,{id:e.label,defaultMessage:e.label})})})}),(0,x.jsx)("div",{className:"",children:(0,x.jsx)("div",{className:`text-center text-${e.flagString}`,children:l.A.countryCurrencyLacSeperator(b[0].bank_locale,b[0].bank_currency,e.amount,2)})})]})},e.label)))}),(0,x.jsx)("div",{className:"row",children:S.map((e=>(0,x.jsx)("div",{className:"col-md-3 col-6 py-4",children:(0,x.jsxs)("div",{className:"",children:[(0,x.jsx)("div",{className:"",children:(0,x.jsx)("div",{className:"p-6 text-center",children:(0,x.jsxs)("h5",{children:[(0,x.jsx)(u.A,{id:e.planString,defaultMessage:e.planString}),(0,x.jsx)("sup",{className:`superScript text-${e.flagString} border-${e.flagString}`,children:e.planCount})]})})}),(0,x.jsx)("div",{className:"",children:(0,x.jsx)("div",{className:`text-center text-${e.flagString}`,children:(0,x.jsx)("button",{onClick:()=>(e=>{const[a,t]=le.split("-"),s=l.A.strToNumMonth[a];let n={startDate:`${t}-${s}-01`,endDate:`${t}-${s}-${new Date(t,s,0).getDate()}`,bankSelected:f};switch(e){case"goodPlans":n={...n,label:d.formatMessage({id:"goodPlans",defaultMessage:"goodPlans"}),criteria:"G100"};break;case"achievedPlans":n={...n,label:d.formatMessage({id:"achievedPlans",defaultMessage:"achievedPlans"}),criteria:"E100"};break;case"badPlans":n={...n,label:d.formatMessage({id:"badPlans",defaultMessage:"badPlans"}),criteria:"0TO100"};break;case"noPlans":n={...n,label:d.formatMessage({id:"noPlans",defaultMessage:"noPlans"}),criteria:"E0"}}O(!0),Z(n)})(e.key),className:`btn btn-sm btn-${e.flagString}`,children:l.A.countryCurrencyLacSeperator(b[0].bank_locale,b[0].bank_currency,e.planTotal,2)})})})]})},e.key)))})]})]}),!J&&!L&&!(null!==L&&void 0!==L&&L.table.length)&&(0,x.jsx)("div",{className:"py-3 text-center",children:(0,x.jsx)(u.A,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})}),J&&(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})]})]})})),B=(0,m.Ay)((e=>{const a=(0,S.A)(),t=(0,s.useContext)(ne),n=(0,s.useContext)(g.R),{bankList:l,bankSelected:r,setBankSelected:o}=t;return(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{o(a)},element:{fetch:{dropDownList:l.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:r,type:"single",searchable:!0,theme:n.userData.theme})})),R=(0,m.Ay)((e=>{const a=(0,S.A)(),t=(0,s.useContext)(ne),n=(0,s.useContext)(g.R),{yearList:l,yearSelected:r,setYearSelected:o}=t;return(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{o(a)},element:{fetch:{dropDownList:l.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:r,type:"single",searchable:!0,theme:n.userData.theme})})),V=(0,m.Ay)((e=>{const a=(0,S.A)(),t=(0,s.useContext)(ne),n=(0,s.useContext)(g.R),{ccYearList:l,ccYearSelected:r,setCcYearSelected:o}=t;return(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{o(a)},element:{fetch:{dropDownList:l.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:r,type:"single",searchable:!0,theme:n.userData.theme})})),H=(0,m.Ay)((e=>{const a=(0,S.A)(),t=(0,s.useContext)(ne),n=(0,s.useContext)(g.R),{ccBankList:l,ccBankSelected:r,setCcBankSelected:o}=t;return(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{o(a)},element:{fetch:{dropDownList:l.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:r,type:"single",searchable:!0,theme:n.userData.theme})}));var O=t(3177);const z=e=>{const a=(0,S.A)(),{onImport:t}=e,n=(0,s.useContext)(g.R),[l,r]=(0,s.useState)([]),[o,i]=(0,s.useState)([]),[d,m]=(0,s.useState)(-1),[p,h]=(0,s.useState)(-1),[f,b]=(0,s.useState)(-1),[M,j]=(0,s.useState)(" "),v=[{label:a.formatMessage({id:"transaction",defaultMessage:"transaction"}),type:"text",key:"cc_transaction"},{label:a.formatMessage({id:"date",defaultMessage:"date"}),type:"dated",key:"cc_date"},{label:a.formatMessage({id:"openingBalance",defaultMessage:"openingBalance"}),type:"number",key:"cc_opening_balance"},{label:a.formatMessage({id:"credits",defaultMessage:"credits"}),type:"number",key:"cc_payment_credits"},{label:a.formatMessage({id:"purchases",defaultMessage:"purchases"}),type:"number",key:"cc_purchases"},{label:a.formatMessage({id:"interest",defaultMessage:"interest"}),type:"number",key:"cc_taxes_interest"}],y=(0,s.useRef)(null),_="{--#newLine#--}";(0,s.useEffect)((()=>{if(d>-1&&p>-1&&f>-1&&d!==p){let e=[...l];e=e.map(((e,a)=>(a===f&&e.length>1&&(e[d]=e[d]&&e[p]&&[...e[d],...e[p]].join(""),e[p]=e[p]&&null),e))).map((e=>e.filter((e=>null!==e)))),r(e),h(-1),b(-1),m(-1)}}),[d,p,f]);const D=e=>{e.preventDefault()},N=(e,a,t)=>{const s=JSON.parse(e.dataTransfer.getData("drag-item"));let{cell:n,i:l}=s,r="";var o;"dated"===a?(o=n,r=[c()(o,"YYYY/MMM/DD",!0).isValid()&&c()(o,"YYYY/MMM/DD").format("YYYY-MM-DD"),c()(o,"YYYY.MMM.DD",!0).isValid()&&c()(o,"YYYY.MMM.DD").format("YYYY-MM-DD"),c()(o,"YYYY-MMM-DD",!0).isValid()&&c()(o,"YYYY-MMM-DD").format("YYYY-MM-DD"),c()(o,"YYYY MMM DD",!0).isValid()&&c()(o,"YYYY MMM DD").format("YYYY-MM-DD"),c()(o,"YYYY/MM/DD",!0).isValid()&&c()(o,"YYYY/MM/DD").format("YYYY-MM-DD"),c()(o,"YYYY.MM.DD",!0).isValid()&&c()(o,"YYYY.MM.DD").format("YYYY-MM-DD"),c()(o,"YYYY-MM-DD",!0).isValid()&&c()(o,"YYYY-MM-DD").format("YYYY-MM-DD"),c()(o,"YYYY MM DD",!0).isValid()&&c()(o,"YYYY MM DD").format("YYYY-MM-DD"),c()(o,"DD/MM/YYYY",!0).isValid()&&c()(o,"DD/MM/YYYY").format("YYYY-MM-DD"),c()(o,"DD-MM-YYYY",!0).isValid()&&c()(o,"DD-MM-YYYY").format("YYYY-MM-DD"),c()(o,"DD.MM.YYYY",!0).isValid()&&c()(o,"DD.MM.YYYY").format("YYYY-MM-DD"),c()(o,"DD MM YYYY",!0).isValid()&&c()(o,"DD MM YYYY").format("YYYY-MM-DD"),c()(o,"DD/MMM/YYYY",!0).isValid()&&c()(o,"DD/MMM/YYYY").format("YYYY-MM-DD"),c()(o,"DD-MMM-YYYY",!0).isValid()&&c()(o,"DD-MMM-YYYY").format("YYYY-MM-DD"),c()(o,"DD.MMM.YYYY",!0).isValid()&&c()(o,"DD.MMM.YYYY").format("YYYY-MM-DD"),c()(o,"DD MMM YYYY",!0).isValid()&&c()(o,"DD MMM YYYY").format("YYYY-MM-DD"),c()(o,"DD/MMMM/YYYY",!0).isValid()&&c()(o,"DD/MMMM/YYYY").format("YYYY-MM-DD"),c()(o,"DD-MMMM-YYYY",!0).isValid()&&c()(o,"DD-MMMM-YYYY").format("YYYY-MM-DD"),c()(o,"DD.MMMM.YYYY",!0).isValid()&&c()(o,"DD.MMMM.YYYY").format("YYYY-MM-DD"),c()(o,"DD MMMM YYYY",!0).isValid()&&c()(o,"DD MMMM YYYY").format("YYYY-MM-DD")].filter((e=>!1!==e))[0]||"Invalid Date"):"text"===a?r=n:"number"===a&&(n=n.replace(",",""),r=Number(n)||0),e.target.value=r,Y(l,t,r)},Y=(e,a,t)=>{let s=[...o];s=s.map(((s,n)=>(e===n&&(s[a]=t),s))),i(s)};return(0,x.jsxs)(C.A,{...e,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"importYourCreditCardStatement",defaultMessage:"importYourCreditCardStatement"})})}),(0,x.jsx)(C.A.Body,{className:"rounded-bottom "+("dark"===n.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsxs)("div",{className:"creditCardModal",children:[l.length?(0,x.jsx)("div",{className:"table-responsive pb-3",children:(0,x.jsxs)("div",{className:"tableGrid",children:[v.map(((e,a)=>(0,x.jsx)("div",{className:"heading",children:e.label},a))),l.map(((e,a)=>(0,x.jsxs)(s.Fragment,{children:[e.length>0&&(0,x.jsxs)("div",{className:"singleLines",children:[e.map(((e,t)=>(0,x.jsxs)("span",{id:t,draggable:"true",onDragStart:s=>((e,a)=>{m(Number(e.target.id)),e.dataTransfer.setData("drag-item",a)})(s,JSON.stringify({cell:e,i:a,j:t})),onDrop:e=>((e,a)=>{const{i:t}=a;b(Number(t)),h(Number(e.target.id))})(e,{i:a,j:t}),onDragOver:e=>D(e),className:"cell",children:[e,(0,x.jsx)("i",{onClick:()=>((e,a)=>{let t=[...l];t=t.map(((t,s)=>s===e?t.filter(((e,t)=>t!==a)):t)),r(t)})(a,t),className:"fa fa-times-circle"})]},t))),e.length>0&&(0,x.jsx)("span",{onClick:()=>(e=>{let a=[...l];a=a.map(((a,t)=>(t===e&&(a=[]),a))),r(a)})(a),className:"cell danger",title:"Delete all?",children:(0,x.jsx)("i",{className:"fa fa-times"})})]}),v.map(((e,t)=>(0,x.jsx)("div",{children:(0,x.jsx)("input",{type:e.type,onChange:t=>Y(a,e.key,t.target.value),onDragOver:e=>D(e),onDrop:a=>N(a,e.type,e.key),className:"input"})},t)))]},a)))]})}):(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{className:"row separatorWrapper py-2",children:[(0,x.jsx)("div",{className:"col-md-9 col-7 pl-0",children:(0,x.jsxs)("label",{htmlFor:"paste",children:[(0,x.jsx)(u.A,{id:"pasteYourCreditCardStatementHere",defaultMessage:"pasteYourCreditCardStatementHere"})," ",(0,x.jsx)("i",{className:"fa fa-level-down"})]})}),(0,x.jsx)("div",{className:"col-md-3 col-5 pr-0",children:(0,x.jsxs)("div",{className:"input-group input-group-sm",children:[(0,x.jsx)("span",{className:"input-group-text bni-bg",children:(0,x.jsx)(u.A,{id:"textSeperated",defaultMessage:"textSeperated"})}),(0,x.jsx)("input",{type:"text",defaultValue:M,onChange:e=>j(e.target.value),className:"form-control"})]})})]}),(0,x.jsx)("textarea",{id:"paste",ref:y,className:"textArea"})]}),(0,x.jsxs)("div",{className:"text-end py-2",children:[l.length>0&&(0,x.jsxs)("button",{onClick:()=>r([]),className:"btn btn-bni me-3",children:[(0,x.jsx)("i",{className:"fa fa-angle-double-left"})," ",(0,x.jsx)(u.A,{id:"back",defaultMessage:"back"})]}),l.length?(0,x.jsx)("button",{onClick:()=>t(o),className:"btn btn-bni",children:(0,x.jsx)(u.A,{id:"generate",defaultMessage:"generate"})}):(0,x.jsx)("button",{onClick:()=>(()=>{let e=y.current.value;e=e.replace(/(\r\n|\n|\r)/gm,_).split(_).filter((e=>e)).map((e=>e.split(M)));const a=e.map((()=>({cc_comments:"",cc_date:"",cc_expected_balance:"",cc_for_card:"",cc_id:"",cc_opening_balance:"",cc_payment_credits:"",cc_purchases:"",cc_taxes_interest:"",cc_transaction:""})));i(a),r(e)})(),className:"btn btn-bni",children:(0,x.jsx)(u.A,{id:"process",defaultMessage:"process"})})]})]})})]})},K=(0,m.Ay)((e=>{var a,t;const r=(0,s.useContext)(ne),o=(0,s.useContext)(g.R),c=(0,s.useContext)(P.O),{intl:i}=e,{ccMonthYearSelected:d,ccBankSelected:m,ccDetails:p,incExpList:h,ccBankList:f}=r,[b,M]=(0,s.useState)(!1),[j,v]=(0,s.useState)({}),[y,A]=(0,s.useState)(!1),[C,S]=(0,s.useState)([]),[w,k]=(0,s.useState)({start:0,limit:10,searchString:""}),T=()=>{const[e,a]=d.split("-"),t=l.A.strToNumMonth[e],s=Number(p.credit_card_start_date),n=Number(p.credit_card_end_date),r=new Date(`${Number(a)}-${Number(t)}-${n}`.replace(/-/g,"/")),o=`${r.getFullYear()}-${l.A.leadingZeros(r.getMonth()+1)}-${l.A.leadingZeros(r.getDate())}`;let c=r.setTime(r.getTime()-2592e6);c=new Date(c),c=new Date(c.setDate(s));const i=`cc_date between "${`${c.getFullYear()}-${l.A.leadingZeros(c.getMonth()+1)}-${l.A.leadingZeros(c.getDate())}`}" and "${o}" and cc_for_card = ${m}`;v({}),A(!0);const u=I(i);Promise.all([u]).then((async e=>{S([]),v(e[0].data.response),A(!1),O.UT[0].rowElements[8]={fetch:{dropDownList:f},searchable:!0},O.UT[0].rowElements[9]={fetch:{dropDownList:h},searchable:!0},O.UT[0].rowElements[8].searchable=!0}))},$=()=>{T()},I=e=>{const a=new FormData;return a.append("appId",o.userConfig.appId),a.append("TableRows",O.UT[0].TableRows),a.append("Table",O.UT[0].Table),a.append("limit",w.limit),a.append("start",w.start),a.append("searchString",w.searchString),e&&a.append("WhereClause",e),D.A.post("/account_planner/getAccountPlanner",a)},L=O.UT.map((e=>{const a={header:{searchPlaceholder:i.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:i.formatMessage({id:"total",defaultMessage:"total"}),locale:p.credit_card_locale,currency:p.credit_card_currency,maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}};return e.config=a,e.TableAliasRows=["id","transaction","date","openingBalance","credits","purchases","taxesAndInterest","balance","creditCard","category","status","comments","recorded"].map((e=>i.formatMessage({id:e,defaultMessage:e}))),e})),B=(0,E.I)(),R=s.useMemo((()=>({fetch:B.get("fetch"),search:B.get("search")})),[B]);return(0,s.useEffect)((()=>{R.fetch&&"ccTransactions"===R.fetch&&R.search&&k({start:0,limit:10,searchString:R.search})}),[R]),(0,s.useEffect)((()=>{T()}),[d,w]),(0,x.jsxs)("div",{className:"settings",children:[b&&(0,x.jsx)(z,{className:"creditCardModal",show:b,onHide:()=>M(!1),size:"xl",animation:!1,onImport:e=>{S(e),M(!1)}}),(0,x.jsxs)("div",{className:"",children:[(0,x.jsx)("div",{className:"row py-2",children:(0,x.jsx)("div",{className:"col-md-12",children:(0,x.jsx)(Y.A,{placement:"left",delay:{show:250,hide:400},overlay:((e,a)=>(0,x.jsx)(N.A,{id:"button-tooltip-1",className:"in show",...e,children:a}))(e,i.formatMessage({id:"importYourCreditCardStatement",defaultMessage:"importYourCreditCardStatement"})),triggerType:"hover",children:(0,x.jsx)("i",{onClick:()=>M(!b),className:"fa fa-upload roundedButton pull-right"})})})}),y&&(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})}),j&&(null===(a=Object.keys(j))||void 0===a?void 0:a.length)>0&&(null===j||void 0===j||null===(t=j.table)||void 0===t?void 0:t.length)>0?L.sort(((e,a)=>e.id>a.id)).map(((e,a)=>(0,x.jsx)(_.A,{id:"ccTable",Table:e.Table,config:e.config,TableRows:e.TableRows,TableAliasRows:e.TableAliasRows,dbData:j,rowElements:e.rowElements,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:e=>(e=>{const{status:a,data:t}=e;if(200===a){if(e&&t&&"boolean"===typeof t.response&&null!==t.response&&t.response&&r.renderToast({message:i.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&t&&"boolean"===typeof t.response&&null!==t.response&&!1===t.response&&r.renderToast({type:"error",icon:"fa fa-times-circle",message:i.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&t&&null===t.response&&c.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,x.jsx)(F.x,{}),content:(0,x.jsx)(F.E,{})}),e&&t&&"object"===typeof t.response&&null!==t.response){let e;e=1451===t.response.number?"foreignKeyDeleteMessage":"",o.renderToast({type:"error",icon:"fa fa-times-circle",message:i.formatMessage({id:e,defaultMessage:e})})}}else r.renderToast({type:"error",icon:"fa fa-times-circle",message:i.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(e),apiParams:w,onChangeParams:e=>(e=>{k((a=>({...a,...e})))})(e),showTooltipFor:e.showTooltipFor,defaultValues:e.defaultValues,onReFetchData:$,insertCloneData:C,cellWidth:[4,13,8,8,8,8,8,8,13,13,13,13,10],ajaxButtonName:i.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"cc_appId",value:o.userConfig.appId},theme:o.userData.theme},a))):(0,x.jsx)("div",{className:"py-3 text-center",children:(0,x.jsx)(u.A,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})})]})]})}));var U=t(3932),G=t(8751);const W=e=>{const a=(0,S.A)(),t=(0,s.useContext)(ne),r=(0,s.useContext)(g.R),o=(0,s.useContext)(P.O),[c,i]=(0,s.useState)(new Date),[d,m]=(0,s.useState)(""),[p,h]=(0,s.useState)(""),[f,b]=(0,s.useState)("0"),[M,j]=(0,s.useState)(!0),[v,y]=(0,s.useState)(!0),[_,N]=(0,s.useState)([]),[Y,A]=(0,s.useState)([]),[w,k]=(0,s.useState)(""),[$,I]=(0,s.useState)([]),[E,L]=(0,s.useState)(""),[B,R]=(0,s.useState)(""),[V,H]=(0,s.useState)(!1),[O,z]=(0,s.useState)(!1),K="&Lang;",W=[{1:a.formatMessage({id:"1",id:"1"})},{2:a.formatMessage({id:"2",id:"2"})},{3:a.formatMessage({id:"3",id:"3"})},{4:a.formatMessage({id:"4",id:"4"})},{5:a.formatMessage({id:"5",id:"5"})},{6:a.formatMessage({id:"6",id:"6"})},{7:a.formatMessage({id:"7",id:"7"})},{8:a.formatMessage({id:"8",id:"8"})},{9:a.formatMessage({id:"9",id:"9"})},{"&Lang;":K},{0:a.formatMessage({id:"0",id:"0"})},{".":"."},{C:"C"}];(0,s.useEffect)((()=>{const e=(()=>{const e=new FormData;return e.append("appId",r.userConfig.appId),D.A.post("/account_planner/bank_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),a=(()=>{const e=new FormData;return e.append("appId",r.userConfig.appId),D.A.post("/account_planner/inc_exp_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),t=(()=>{const e=new FormData;return e.append("appId",r.userConfig.appId),D.A.post("/account_planner/credit_card_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})();Promise.all([e,a,t]).then((e=>{e[0].length>0?N(e[0]):N([{id:null,value:"NULL"}]),e[0].length>0&&e[0][0].id?k(e[0][0].id):k(""),e[1].length>0?I(e[1]):I([{id:null,value:"NULL"}]),e[1].length>0&&e[1][0].id?L(e[1][0].id):L(""),e[2].length>0?A(e[2]):A([{id:null,value:"NULL"}]),e[2].length>0&&e[2][0].id?R(e[2][0].id):R("")}))}),[]);const Z=e=>{const[a,t,s]=[e.getFullYear(),e.getMonth()+1>9?e.getMonth()+1:`0${e.getMonth()+1}`,e.getDate()>9?e.getDate():`0${e.getDate()}`];return`${a}-${t}-${s}`};return(0,x.jsxs)(C.A,{...e,style:{zIndex:1e4},enforceFocus:!1,children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"fastShopping",defaultMessage:"fastShopping"})})}),(0,x.jsx)(C.A.Body,{className:"react-responsive-ajax-data-table rounded-bottom "+("dark"===r.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsxs)("form",{id:"transactForm",onSubmit:e=>e.preventDefault(),children:[(0,x.jsx)("div",{className:"",children:(0,x.jsx)("input",{type:"text",className:"form-control",placeholder:a.formatMessage({id:"transaction",defaultMessage:"transaction"}),onChange:e=>m(e.target.value)})}),(0,x.jsx)("div",{className:"overflow text-end",children:f}),(0,x.jsx)("div",{className:"",children:(0,x.jsx)("div",{className:"numPads pb-2",children:W.map(((e,a)=>{const t=isNaN(Number(Object.keys(e)[0]))?Object.keys(e)[0]:Number(Object.keys(e)[0]),s=Object.values(e)[0];return(0,x.jsx)("div",{className:"text-center buttonContainer",children:(0,x.jsx)("button",{disabled:f.toString().includes(".")&&"."===t,onClick:()=>(e=>{let a=f;"number"===typeof e&&(a=V?`${a}.${e}`:`${f}${e}`,H(!1)),"."===e&&(H(!0),"0"===a.substring(0,1)&&(a="0"+a)),a.length>0&&"0"===a.substring(0,1)&&!a.includes(".")&&(a=a.substring(1,a.length)),a.length>0&&"."===a.substring(0,1)&&(a=`0${a}`),"C"===e&&(a="0",H(!1)),e===K&&(a=a.length>1?a.slice(0,-1):"0",a.length>0&&"."===a.slice(a.length-1)&&(a=a.slice(0,-1),H(!1))),b(a)})(t),dangerouslySetInnerHTML:{__html:s}})},a)}))})}),(0,x.jsxs)("div",{className:"row py-2",children:[(0,x.jsx)("div",{className:"col-6 py-2 react-responsive-ajax-data-table",children:(0,x.jsx)(U.A,{onChange:e=>{i(e)},value:c,format:"y-MM-dd",required:!0,clearIcon:null,className:"fastShoppingDatePicker"})}),(0,x.jsx)("div",{className:"col-6 py-2",children:(0,x.jsxs)("div",{className:"d-flex align-items-center",children:[(0,x.jsx)("div",{onClick:()=>y(!v),className:"",children:v?a.formatMessage({id:"debitCard",defaultMessage:"debitCard"}):a.formatMessage({id:"creditCard",defaultMessage:"creditCard"})}),(0,x.jsx)("i",{onClick:()=>y(!v),className:"fa fa-circle ps-2 "+(v?"debit":"credit")})]})})]}),(0,x.jsx)("div",{className:"py-2",children:(0,x.jsx)("input",{type:"text",className:"form-control",placeholder:"Comments",onChange:e=>h(e.target.value)})}),(0,x.jsx)("div",{children:_.length>0&&$.length>0&&Y.length>0?(0,x.jsxs)(x.Fragment,{children:[v?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"py-2",children:(0,x.jsxs)("div",{className:"d-flex align-items-center justify-content-evenly",children:[(0,x.jsx)("div",{onClick:()=>j(!0),className:"",children:(0,x.jsx)(u.A,{id:"expense",defaultMessage:"expense"})}),(0,x.jsx)(G.A,{onColor:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),offColor:"#333",checkedIcon:!1,uncheckedIcon:!1,height:20,width:45,onChange:()=>j(!M),checked:!0===M}),(0,x.jsx)("div",{onClick:()=>j(!1),className:"",children:(0,x.jsx)(u.A,{id:"income",defaultMessage:"income"})}),(0,x.jsx)(G.A,{onColor:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),offColor:"#333",checkedIcon:!1,uncheckedIcon:!1,height:20,width:45,onChange:()=>j(!M),checked:!1===M})]})}),(0,x.jsx)("div",{className:"py-2",children:(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{k(a)},element:{fetch:{dropDownList:_.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:w,type:"single",searchable:!0,theme:r.userData.theme},1)})]}):(0,x.jsx)("div",{className:"py-2",children:(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{R(a)},element:{fetch:{dropDownList:Y.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:B,type:"single",searchable:!0,theme:r.userData.theme},1)}),(0,x.jsx)("div",{className:"py-2",children:(0,x.jsx)(T.A,{placeholder:a.formatMessage({id:"select",defaultMessage:"select"}),onChange:(e,a,t)=>{L(a)},element:{fetch:{dropDownList:$.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:E,type:"single",searchable:!0,theme:r.userData.theme},1)})]}):(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})}),(0,x.jsx)("div",{className:"py-2",children:(0,x.jsx)("button",{disabled:!(Number(f)>0&&d&&!O),onClick:()=>(()=>{z(!0);const s={Table:v?"income_expense":"credit_card_transactions",insertData:v?[{inc_exp_id:null,inc_exp_appId:r.userConfig.appId,inc_exp_name:d,inc_exp_amount:f,inc_exp_plan_amount:0,inc_exp_type:M?"Dr":"Cr",inc_exp_date:Z(c),inc_exp_category:E,inc_exp_bank:w,inc_exp_comments:p}]:[{cc_id:null,cc_appId:r.userConfig.appId,cc_transaction:d,cc_date:Z(c),cc_opening_balance:0,cc_payment_credits:0,cc_purchases:f,cc_taxes_interest:0,cc_for_card:B,cc_inc_exp_cat:E,cc_comments:p,cc_transaction_status:0}]},n=new FormData;document.getElementById("transactForm").reset(),n.append("postData",JSON.stringify(s)),D.A.post("/account_planner/postAccountPlanner",n).then((s=>{const{data:n}=s;s&&n&&"boolean"===typeof n.response&&null!==n.response&&n.response&&t.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),s&&n&&"boolean"===typeof n.response&&null!==n.response&&!1===n.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),s&&n&&null===n.response&&(o.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,x.jsx)(F.x,{}),content:(0,x.jsx)(F.E,{})}),e.onHide(!1)),b("0"),m(""),h(""),null!=document.getElementById("transactForm")&&document.getElementById("transactForm").reset()})).catch((e=>{t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})}),console.log(e)})).finally((()=>z(!1)))})(),className:"btn btn-bni border-0",children:O?(0,x.jsx)("i",{className:"fa fa-circle-o-notch fa-spin fa-fw"}):(0,x.jsx)(u.A,{id:"submit",defaultMessage:"submit"})})})]})})]})},Z=e=>{const{ccDetails:a}=e,[t,n]=(0,s.useState)(0);let l=24*Number(a.remDays)*3600;(0,s.useEffect)((()=>{Number(a.remDays)>0&&r()}),[a.remDays]);const r=()=>{const e=Math.floor(l/24/60/60),a=Math.floor(l-86400*e),t=Math.floor(a/3600),s=Math.floor(a-3600*t),i=Math.floor(s/60),d=l%60,u=c(e)+":"+c(t)+":"+c(i)+":"+c(d);0===l?o(r):l--,n(u),setTimeout(r,1e3)},o=()=>{clearTimeout(r)},c=e=>e<10?"0"+e:e;return(0,x.jsx)("span",{children:t})},J=e=>{const a=(0,s.useContext)(g.R),[t,r]=(0,s.useState)(!1),[o,c]=(0,s.useState)(!1),[i,d]=(0,s.useState)(!1),[m,p]=(0,s.useState)({}),[h,f]=(0,s.useState)([]),b=new Date;(0,s.useEffect)((()=>{r(!0);const e=j();Promise.all([e]).then((e=>{const a=e[0];f(a),r(!1)}))}),[]);const M=()=>(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})}),j=()=>{const e=new FormData;return e.append("appId",a.userConfig.appId),D.A.post("/account_planner/credit_card_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))};return(0,x.jsxs)(C.A,{...e,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"checkCreditCardCycleDate",defaultMessage:"checkCreditCardCycleDate"})})}),(0,x.jsxs)(C.A.Body,{className:"rounded-bottom "+("dark"===a.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:[t?M():(0,x.jsx)("div",{className:"row",children:h&&h.length>0&&h.map(((e,t)=>(0,x.jsxs)("div",{onClick:()=>(e=>{const t=new FormData;return t.append("bank",e),t.append("appId",a.userConfig.appId),p({}),c(!0),d(e),D.A.post("/account_planner/credit_card_details",t).then((e=>{const a=e.data.response[0];let t=a.credit_card_start_date;t=l.A.addMonths(new Date(`${b.getFullYear()}-${b.getMonth()+1}-${t}`.replace(/-/g,"/")),-1);let[s,n,r]=[t.getFullYear(),t.getMonth()+1,t.getDate()];[n,r]=[n<10?`0${n}`:n,r<10?`0${r}`:r],t=`${s}-${n}-${r}`;let o=a.credit_card_end_date;o=new Date(`${b.getFullYear()}-${b.getMonth()+1}-${o}`.replace(/-/g,"/"));let[i,d,u]=[o.getFullYear(),o.getMonth()+1,o.getDate()];[d,u]=[d<10?`0${d}`:d,u<10?`0${u}`:u],o=`${i}-${d}-${u}`;let m=a.credit_card_payment_date;m=l.A.addMonths(new Date(`${b.getFullYear()}-${b.getMonth()+1}-${m}`.replace(/-/g,"/")),1);let[g,h,f]=[m.getFullYear(),m.getMonth()+1,m.getDate()];[h,f]=[h<10?`0${h}`:h,f<10?`0${f}`:f],m=`${g}-${h}-${f}`;let x=new Date(m)-new Date;x=Math.abs(x),x=Math.ceil(x/864e5);const M={cardNumber:a.credit_card_number,cardName:a.credit_card_name,startDate:t,endDate:o,payDate:m,remDays:x};p(M),c(!1)})).catch((e=>{console.log(e)}))})(e.id),className:"col-6 text-center cardWrapper "+(i===e.id?"active":""),children:[(0,x.jsx)("i",{className:"fa fa-credit-card-alt"}),e.value]},t)))}),o?M():Object.keys(m).length>0&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"py-3 text-center",children:m.cardName}),(0,x.jsxs)("div",{className:"container mt-10 text-center",children:[(0,x.jsx)("div",{className:"contactLabel",children:(0,x.jsx)(u.A,{id:"cardNumber",defaultMessage:"cardNumber"})}),(0,x.jsx)("div",{children:m.cardNumber}),(0,x.jsxs)("div",{className:"row pb-3 pt-3",children:[(0,x.jsxs)("div",{className:"col-6",children:[(0,x.jsx)("label",{children:(0,x.jsx)(u.A,{id:"startDate",defaultMessage:"startDate"})}),(0,x.jsx)("div",{children:m.startDate})]}),(0,x.jsxs)("div",{className:"col-6",children:[(0,x.jsx)("label",{children:(0,x.jsx)(u.A,{id:"endDate",defaultMessage:"endDate"})}),(0,x.jsx)("div",{children:m.endDate})]})]}),(0,x.jsxs)("div",{className:"row text-center",children:[(0,x.jsxs)("div",{className:"col-6",children:[(0,x.jsx)("label",{children:(0,x.jsx)(u.A,{id:"payDate",defaultMessage:"payDate"})}),(0,x.jsx)("div",{children:m.payDate})]}),(0,x.jsxs)("div",{className:"col-6",children:[(0,x.jsx)("label",{children:(0,x.jsx)(u.A,{id:"remainingDays",defaultMessage:"remainingDays"})}),(0,x.jsx)("div",{children:(0,x.jsx)(Z,{ccDetails:m})})]})]})]})]})]})]})},q=e=>{const{onHide:a,onYes:t}=e,n=(0,s.useContext)(g.R);return(0,x.jsxs)(C.A,{...e,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsx)(C.A.Title,{children:(0,x.jsx)(u.A,{id:"sureAbtSqlQueries",defaultMessage:"sureAbtSqlQueries"})})}),(0,x.jsx)(C.A.Body,{className:"rounded-bottom "+("dark"===n.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:()=>t(),className:"btn btn-bni",children:(0,x.jsx)(u.A,{id:"allow",defaultMessage:"allow"})})}),(0,x.jsx)("div",{children:(0,x.jsx)("button",{onClick:()=>a(),className:"btn btn-secondary",children:(0,x.jsx)(u.A,{id:"restrict",defaultMessage:"restrict"})})})]})})]})};var Q=t(1308),X=t(5923),ee=t(6275);const ae=e=>{const a=(0,S.A)(),t=(0,s.useContext)(g.R),n=5242880,l=1e3,[r,o]=(0,s.useState)({}),[i,d]=(0,s.useState)([]),m=[{inc_exp_id:"null",inc_exp_name:"Gross profit",inc_exp_amount:1e6,inc_exp_plan_amount:0,inc_exp_type:"Cr",inc_exp_date:c()(new Date).format("YYYY-MM-DD").toString(),inc_exp_category:"Category name",inc_exp_bank:"Bank name",inc_exp_comments:"your profit comments"},{inc_exp_id:"null",inc_exp_name:"Gross expense",inc_exp_amount:5e5,inc_exp_plan_amount:0,inc_exp_type:"Dr",inc_exp_date:c()(new Date).format("YYYY-MM-DD").toString(),inc_exp_category:"Category name",inc_exp_bank:"Bank name",inc_exp_comments:"your expense comments"}];return(0,x.jsxs)(C.A,{...e,style:{zIndex:1e4},children:[(0,x.jsx)(C.A.Header,{closeButton:!0,children:(0,x.jsxs)(C.A.Title,{children:[(0,x.jsx)(u.A,{id:"bulkImport",defaultMessage:"bulkImport"}),(0,x.jsxs)("em",{className:"ps-1",children:["(",(0,x.jsxs)("small",{className:"pe-1",children:[(0,x.jsx)(u.A,{id:"limit",defaultMessage:"limit"}),":"," ","5 MB,"]}),(0,x.jsxs)("small",{className:"pe-1",children:[(0,x.jsx)(u.A,{id:"maxRows",defaultMessage:"maxRows"}),":"," ","1000,"]}),(0,x.jsxs)("small",{children:[(0,x.jsx)(u.A,{id:"type",defaultMessage:"type"}),": CSV,"," "]}),(0,x.jsxs)("small",{className:"pe-1",children:[(0,x.jsx)(u.A,{id:"date",defaultMessage:"date"})," ",(0,x.jsx)(u.A,{id:"type",defaultMessage:"type"}),":"," YYYY-MM-DD"]}),")"]})]})}),(0,x.jsx)(C.A.Body,{className:"rounded-bottom p-0 "+("dark"===t.userData.theme?"bg-dark text-white":"bg-white text-dark"),children:(0,x.jsxs)("div",{className:"dropZone",children:[(0,x.jsx)(ee.Ay,{accept:"text/csv,text/comma-separated-values,application/csv",maxSize:n,onDrop:(e,s,r)=>{var c;e.length>0&&(o(e[0]),(c=e[0],new Promise(((e,t)=>{const s=c,r=new FileReader;r.readAsText(s),r.onload=r=>{const o=[],c=r.target.result.split(/\r\n|\n/),i=c[0].split(",");if(s.size<=n)if(c.length-1<=l){for(let e=1;e<c.length;e++){const a=c[e].split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);if(a.length===i.length){const e=[];for(let s=0;s<i.length;s++)e.push({[i[s]]:a[s].replace(/\\/g,"").replaceAll('"',"")});const t=Object.assign({},...e);o.push(t)}}e(o)}else t(new Error(`${a.formatMessage({id:"maxAllowedRowLimitIs",defaultMessage:"maxAllowedRowLimitIs"})} 1000`));else t(new Error(`${a.formatMessage({id:"maxFileSizeLimitIs",defaultMessage:"maxFileSizeLimitIs"})} 5242880 MB`))},r.onerror=e=>{t(e)}}))).then((e=>{t.renderToast({message:`${e.length} ${a.formatMessage({id:"rowsAddedSuccessfully",defaultMessage:"rowsAddedSuccessfully"})}`,autoClose:1e4}),d(e)})).catch((e=>{d([]),t.renderToast({type:"error",icon:"fa fa-times-circle",message:e})})))},className:"text-center",children:e=>{let{getRootProps:a,getInputProps:t,isDragAccept:s,isDragReject:n}=e,l="dropZoneWrapper",r=(0,x.jsx)("div",{children:(0,x.jsx)(u.A,{id:"dragFilesHere",defaultMessage:"dragFilesHere"})});return s&&(l=`${l} bg-success`,r=(0,x.jsx)("div",{className:"upload-success",children:(0,x.jsx)(u.A,{id:"dropFileOrfilesHere",defaultMessage:"dropFileOrfilesHere"})})),n&&(l=`${l} bg-danger`,r=(0,x.jsx)("div",{className:"upload-error",children:(0,x.jsx)(u.A,{id:"fileTypeNotAllowed",defaultMessage:"fileTypeNotAllowed"})})),(0,x.jsxs)("div",{...a(),className:`${l} title`,children:[(0,x.jsx)("input",{...t()}),r]})}}),Object.keys(r).length>0&&(0,x.jsx)("div",{className:"p-1 text-center",children:(0,x.jsxs)("small",{className:"icon-bni",children:[(0,x.jsx)("i",{className:"fa fa-file-excel-o pe-1"}),r.name,(0,x.jsx)("small",{className:"ps-1",children:(0,x.jsxs)("em",{children:["(",(e=>{const a=(e/1024/1024).toFixed(2);if(a>0)return`${a} MB`;return`${(e/1024).toFixed(2)} KB`})(r.size),")"]})})]})}),(0,x.jsxs)("div",{className:"d-flex justify-content-evenly",children:[(0,x.jsx)("button",{className:"btn btn-bni w-50 rounded-0 rounded-start border-end",children:(0,x.jsxs)(I.A,{datas:m,filename:"inc-exp-csv-sample-import.csv",children:[(0,x.jsx)("i",{className:"fa fa-file-downoad pe-1"}),(0,x.jsx)(u.A,{id:"downloadCsvTemplate",defaultMessage:"downloadCsvTemplate"})]})}),(0,x.jsx)("button",{disabled:!i.length,onClick:()=>(()=>{const e=new FormData;e.append("data",JSON.stringify(i)),e.append("appId",t.userConfig.appId),D.A.post("/account_planner/bulkImport",e).then((e=>{e.data.response&&t.renderToast({message:a.formatMessage({id:"bulkImportSuccess",defaultMessage:"bulkImportSuccess"})}),e.data.response||t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"bulkImportFailed",defaultMessage:"bulkImportFailed"})}),null===e.data.response&&myAlertContext.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,x.jsx)(F.x,{}),content:(0,x.jsx)(F.E,{})})})).catch((e=>{t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"bulkImportFailed",defaultMessage:"bulkImportFailed"})})})).finally((()=>d([])))})(),className:"btn-bni w-50 rounded-0 rounded-end",children:(0,x.jsx)(u.A,{id:"submit",defaultMessage:"submit"})})]})]})})]})},te=(0,m.Ay)((e=>{var a;const{intl:t}=e,r=(0,s.useContext)(ne),o=(0,s.useContext)(g.R),i=(0,s.useContext)(P.O),{incExpList:d,bankList:m,insertData:p}=r,[h,f]=(0,s.useState)([]),[b,M]=(0,s.useState)(!1),j=()=>{M(!0),r.setInsertData([]);const e=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/getIncExpTemplate",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})();Promise.all([e]).then((e=>{const a=e[0].map((e=>{let{temp_inc_exp_name:a,temp_amount:t,temp_inc_exp_type:s,temp_inc_exp_date:n,temp_category:l,temp_bank:r}=e;return{inc_exp_id:"",inc_exp_name:a,inc_exp_amount:0,inc_exp_plan_amount:t,inc_exp_type:s,inc_exp_date:c()().date(n).add(1,"months").format("YYYY-MM-DD"),inc_exp_category:l,inc_exp_bank:r,inc_exp_comments:""}})).sort(((e,a)=>new Date(e.inc_exp_date.replace(/-/g,"/"))-new Date(a.inc_exp_date.replace(/-/g,"/"))));r.setInsertData(a)})).finally((()=>{M(!1)}))};(0,s.useEffect)((()=>{j()}),[t]),(0,s.useEffect)((()=>{const e={fetch:{dropDownList:d.map(((e,a)=>{let{id:t,value:s}=e;return{id:t,value:s}}))}},a={fetch:{dropDownList:m}};O.Kg[0].rowElements[3]="number",O.Kg[0].rowElements[6]=e,O.Kg[0].rowElements[7]=a,O.Kg[0].rowElements[4]={radio:{radioList:[{label:t.formatMessage({id:"credit",defaultMessage:"credit"}),value:"Cr",checked:!1},{label:t.formatMessage({id:"debit",defaultMessage:"debit"}),value:"Dr",checked:!0}]}};const s=(e,a)=>{const t=a&&e.filter((e=>{var t;return null===(t=e.value)||void 0===t?void 0:t.toLowerCase().includes(null===a||void 0===a?void 0:a.toLowerCase())}));return t.length>0?t[0].id:""},n=[...p].map((e=>(e.inc_exp_category=s(d,e.inc_exp_category),e.inc_exp_bank=s(m,e.inc_exp_bank),e)));f([]),setTimeout((()=>{const e=n.filter((e=>"Cr"===e.inc_exp_type)).reduce(((e,a)=>Number(e)+Number(a.inc_exp_plan_amount)),0),a=n.filter((e=>"Dr"===e.inc_exp_type)).reduce(((e,a)=>Number(e)+Number(a.inc_exp_plan_amount)),0);f({table:n,total:{inc_exp_plan_amount:[{value:e,prefix:"",suffix:"(+)"},{value:a,prefix:"",suffix:"(-)"},{value:e-a,prefix:"",suffix:"(=)",className:"rounded bni-bg text-dark p-1"}]}})}),100)}),[p,t]);const v=O.Kg.map((e=>{const a={header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!1},footer:{total:{title:t.formatMessage({id:"total",defaultMessage:"total"}),locale:"en",currency:"",maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=a,e.TableAliasRows=["id","transaction","amount","plan","type","date","category","bank","comments"].map((e=>t.formatMessage({id:e,defaultMessage:e}))),e})),y=()=>{f([])};return(0,x.jsxs)("div",{children:[(null===h||void 0===h||null===(a=h.table)||void 0===a?void 0:a.length)>0&&(0,x.jsxs)("div",{children:[(0,x.jsx)("h6",{children:(0,x.jsx)(u.A,{id:"planFromTemplate",defaultMessage:"planFromTemplate"})}),v.sort(((e,a)=>e.id>a.id)).map(((e,a)=>(0,x.jsx)(_.A,{config:e.config,Table:e.Table,TableRows:e.TableRows,TableAliasRows:e.TableAliasRows,rowElements:e.rowElements,dbData:h,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:e=>(e=>{const{status:a,data:s}=e;200===a?(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&r.renderToast({message:t.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&r.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&i.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,x.jsx)(F.x,{}),content:(0,x.jsx)(F.E,{})})):r.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(e),onChangeParams:e=>{},showTooltipFor:e.showTooltipFor,defaultValues:e.defaultValues,onReFetchData:y,cellWidth:[4,13,10,10,13,10,13,13,13],ajaxButtonName:t.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"inc_exp_appId",value:o.userConfig.appId},theme:o.userData.theme},a)))]}),b&&(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})]})}));var se=t(3058);const ne=s.createContext(),le=e=>{var a;const t=(0,S.A)(),r=(0,s.useContext)(Q.F);document.title=`${r.appName} - ${t.formatMessage({id:"moneyPlanner",defaultMessage:"moneyPlanner"})}`;const o=(0,s.useContext)(g.R),[i,d]=(0,s.useState)([]),[m,p]=(0,s.useState)([]),[h,f]=(0,s.useState)([]),[M,j]=(0,s.useState)([]),[v,_]=(0,s.useState)([]),[N,Y]=(0,s.useState)([]),[A,C]=(0,s.useState)([]),[w,k]=(0,s.useState)([]),[T,$]=(0,s.useState)(""),[I,P]=(0,s.useState)([]),[F,O]=(0,s.useState)(""),[z,U]=(0,s.useState)(""),[G,Z]=(0,s.useState)(""),[ee,le]=(0,s.useState)(""),[re,oe]=(0,s.useState)(""),[ce,ie]=(0,s.useState)({}),[de,ue]=(0,s.useState)(!1),[me,pe]=(0,s.useState)(!1),[ge,he]=(0,s.useState)(!1),[fe,xe]=(0,s.useState)(!1),[be,Me]=(0,s.useState)(!1),[je,ve]=(0,s.useState)(!1),[ye,_e]=(0,s.useState)(!1),De=(0,E.I)(),Ne={fetch:De.get("fetch"),date:De.get("date"),bank:De.get("bank"),card:De.get("card")},[Ye,Ae]=(0,s.useState)(!1),[Ce,Se]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/year_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),a=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/bank_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),s=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/cc_year_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),n=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/credit_card_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})(),l=(()=>{const e=new FormData;return e.append("appId",o.userConfig.appId),D.A.post("/account_planner/inc_exp_list",e).then((e=>e.data.response)).catch((e=>{console.log(e)}))})();Promise.all([e,a,s,n,l]).then((e=>{var a,s,n,l,r,o,i,u,m;(null===(a=e[0])||void 0===a?void 0:a.length)>0?d(e[0]):d([{id:t.formatMessage({id:"null",defaultMessage:"null"}),value:t.formatMessage({id:"null",defaultMessage:"null"})}]),(null===(s=e[0])||void 0===s?void 0:s.length)>0&&e[0][0].id?U(e[0][0].id):U("Null"),(null===(n=e[1])||void 0===n?void 0:n.length)>0?f(e[1]):f([{id:t.formatMessage({id:"null",defaultMessage:"null"}),value:t.formatMessage({id:"null",defaultMessage:"null"})}]),(null===(l=e[1])||void 0===l?void 0:l.length)>0&&e[1][0].id?Z(e[1][0].id):Z("Null"),(null===(r=e[2])||void 0===r?void 0:r.length)>0?p(e[2]):p([{id:t.formatMessage({id:"null",defaultMessage:"null"}),value:t.formatMessage({id:"null",defaultMessage:"null"})}]),(null===(o=e[2])||void 0===o?void 0:o.length)>0&&e[2][0].id?$(c()(new Date).format("YYYY").toString()):$("Null"),(null===(i=e[3])||void 0===i?void 0:i.length)>0?P(e[3]):P([{id:t.formatMessage({id:"null",defaultMessage:"null"}),value:t.formatMessage({id:"null",defaultMessage:"null"})}]),(null===(u=e[3])||void 0===u?void 0:u.length)>0&&e[3][0].id?O(null!==Ne&&void 0!==Ne&&Ne.card?null===Ne||void 0===Ne?void 0:Ne.card:e[3][0].id):O("Null"),(null===(m=e[4])||void 0===m?void 0:m.length)>0?Y(e[4]):Y([{id:null,value:null,isIncomeMetric:null}])})),_([])}),[]);const we=async(e,a)=>{ue(!0),j([]),k([]);const t=`${z}-01-01`,s=`${z}-12-31`;await((e,a,t)=>{const s=new FormData;return s.append("startDate",e),s.append("endDate",a),s.append("bank",t),s.append("appId",o.userConfig.appId),D.A.post("/account_planner/getIncExpChartData",s)})(t,s,G).then((async t=>{const s=t.data.response;j(s),await(e=>{const a=new FormData;return a.append("bank",e),a.append("appId",o.userConfig.appId),D.A.post("/account_planner/getBankDetails",a)})(G).then((async t=>{var n;C(t.data.response),"function"===typeof a&&e?await a(null===s||void 0===s||null===(n=s.category[0])||void 0===n?void 0:n.month):await a()})).catch((e=>{C([])}))})).catch((e=>{j([]),console.log(e)})).finally((()=>{ue(!1)}))},ke=async(e,a)=>{pe(!0),_([]),ie([]),oe(null),await(e=>{const a=new FormData;return a.append("bank",e),a.append("appId",o.userConfig.appId),D.A.post("/account_planner/credit_card_details",a)})(F).then((async t=>{const s=t.data.response[0];ie(s);const n=`${T}-01-01`,l=`${T}-12-31`;await((e,a,t)=>{const s=new FormData;return s.append("startDate",e),s.append("endDate",a),s.append("card",t),s.append("appId",o.userConfig.appId),D.A.post("/account_planner/getCreditCardChartData",s)})(n,l,F).then((async t=>{const n=t.data.response,l=n.map((e=>e.month)),r=l.findIndex((e=>e===c()().format("MMM-YYYY").toString())),o=r>-1?l[r]:n[11].month;_(n),"function"===typeof a&&e?await a(o):await a(s)})).catch((e=>{console.log(e)})).finally((()=>{pe(!1)}))})).catch((e=>{console.log(e)}))},Te=()=>(0,x.jsx)("div",{className:"relativeSpinner",children:(0,x.jsx)(n.A,{type:l.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})});return(0,s.useEffect)((()=>{const e=c()(Ne.date).format("YYYY").toString();i.length>0&&h.length>0&&"bankTransactions"===Ne.fetch&&(U(e),Z(Ne.bank),Ae(!0))}),[JSON.stringify(Ne),i,h]),(0,s.useEffect)((()=>{if(I.length>0&&m.length>0&&"ccTransactions"===Ne.fetch){const e=c()(Ne.date).format("YYYY").toString();$(e),O(Ne.card),Se(!0)}}),[JSON.stringify(Ne),I,m]),(0,s.useEffect)((()=>{if(z&&G&&Ye){const e=c()(Ne.date).format("MMM-YYYY").toString();we(!1,(()=>{le(e),Ae(!1),setTimeout((()=>{var e;null===(e=document.getElementById("incExpTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}}),[JSON.stringify(Ne),Ye,z,G]),(0,s.useEffect)((()=>{T&&F&&Ce&&ke(!1,(e=>{const a=Number(e.credit_card_start_date)>=Number(c()(Ne.date).format("D").toString())?c()(Ne.date).format("MMM-YYYY").toString():c()(Ne.date).add(1,"M").format("MMM-YYYY").toString();oe(a),Se(!1),setTimeout((()=>{var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(Ne),Ce,T,F]),(0,x.jsxs)(ne.Provider,{value:{renderToast:e=>{let{autoClose:a=5e3,type:t="success",position:s="top-right",message:n,theme:l="colored",hideProgressBar:r=!1,closeOnClick:o=!1,pauseOnHover:c=!0,draggable:i=!0}=e;return X.oR[t](n,{autoClose:a,position:s,theme:l,hideProgressBar:r,closeOnClick:o,pauseOnHover:c,draggable:i})},bankSelected:G,setBankSelected:Z,bankDetails:A,bankList:h,setBankList:f,yearSelected:z,setYearSelected:U,yearList:i,monthYearSelected:ee,onMonthYearSelected:e=>{le(e)},incExpList:N,setIncExpList:Y,ccBankList:I,ccBankSelected:F,setCcBankSelected:O,ccYearSelected:T,setCcYearSelected:$,ccYearList:m,setCcBankList:P,chartData:M,ccChartData:v,ccDetails:ce,setCcDetails:ie,ccMonthYearSelected:re,onCcMonthYearSelected:e=>{oe(e)},insertData:w,setInsertData:k},children:[(0,x.jsx)(X.N9,{className:"bniToaster"}),(0,x.jsxs)("section",{className:"",children:[ge&&(0,x.jsx)(J,{show:ge,onHide:()=>he(!1),size:"sm",animation:!1}),fe&&(0,x.jsx)(W,{className:"accountPlanner fastShopping",show:fe,onHide:()=>xe(!1),size:"sm",animation:!1}),be&&(0,x.jsx)(ae,{className:"accountPlanner",show:be,onHide:()=>Me(!1),centered:!0,size:"lg",backdrop:"static"}),je&&(0,x.jsx)(q,{className:"confirmQBModal",show:je,onHide:()=>{ve(!1),setToggleQueryBuilder(!1)},onYes:()=>{ve(!1),setToggleQueryBuilder(!0)},size:"md",animation:!1}),(0,x.jsxs)("div",{className:"m-2",children:[(0,x.jsx)(se.A,{icon:"fa fa-cubes",intlId:"moneyPlanner"}),(0,x.jsx)("div",{className:"pt-2",children:(0,x.jsx)("div",{className:`accountPlanner ${o.userData.theme}`,children:h.length>0&&i.length&&m.length>0&&I.length>0>0?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"badge "+("dark"===o.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:(0,x.jsx)(u.A,{id:"bankTransactions",defaultMessage:"bankTransactions"})}),(0,x.jsxs)("div",{className:"row mt-10",children:[(0,x.jsx)("div",{className:"col-lg-3 col-sm-4 py-2",children:(0,x.jsx)(B,{})}),(0,x.jsx)("div",{className:"col-lg-3 col-sm-4 py-2",children:(0,x.jsx)(R,{})}),(0,x.jsx)("div",{className:"col-lg-3 col-sm-4 py-2",children:(0,x.jsx)("div",{className:"d-grid gap-2",children:(0,x.jsx)("button",{onClick:()=>we(!0,(e=>{le(e)})),className:"btn icon-bni bni-border bni-border-all bni-border-all-1",children:(0,x.jsx)(u.A,{id:"generate",defaultMessage:"generate"})})})}),(0,x.jsx)("div",{className:"col-lg-1 col-4 py-2 mb-2",children:(0,x.jsx)("button",{onClick:()=>xe(!0),className:"btn btn-bni w-100",title:t.formatMessage({id:"fastShopping",defaultMessage:"fastShopping"}),children:(0,x.jsx)("i",{className:"fa fa-cart-plus"})})}),(0,x.jsx)("div",{className:"col-lg-1 col-4 py-2 mb-2",children:(0,x.jsx)("button",{onClick:()=>Me(!0),className:"btn btn-bni w-100",title:t.formatMessage({id:"bulkImport",defaultMessage:"bulkImport"}),disabled:"1"!==(null===o||void 0===o||null===(a=o.userConfig)||void 0===a?void 0:a.planIsBulkImport),children:(0,x.jsx)("i",{className:"fa fa-cloud-upload"})})}),(0,x.jsx)("div",{className:"col-lg-1 col-4 py-2 mb-2",children:(0,x.jsx)("button",{onClick:()=>_e(!ye),className:"btn btn-bni w-100",title:t.formatMessage({id:"planFromTemplate",defaultMessage:"planFromTemplate"}),children:(0,x.jsx)("i",{className:"fa fa-clone"})})})]}),h.length>0&&ye&&(0,x.jsx)(te,{}),de?Te():(0,x.jsx)(x.Fragment,{children:N.length>0&&A.length>0&&(0,x.jsx)(b,{})}),(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-md-12 b-0 mb-10 pr-0 pl-0",children:A.length>0&&(0,x.jsx)(L,{})})}),(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-md-12",children:(0,x.jsx)("div",{className:"badge "+("dark"===o.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:(0,x.jsx)(u.A,{id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})})}),(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("div",{className:"col-md-4 py-2",children:(0,x.jsx)(H,{})}),(0,x.jsx)("div",{className:"col-md-4 py-2",children:(0,x.jsx)(V,{})}),(0,x.jsx)("div",{className:"col-md-3 py-2",children:(0,x.jsx)("div",{className:"d-grid gap-2",children:(0,x.jsx)("button",{onClick:()=>ke(!0,(e=>{oe(e)})),className:"btn icon-bni bni-border bni-border-all bni-border-all-1",children:(0,x.jsx)(u.A,{id:"generate",defaultMessage:"generate"})})})}),(0,x.jsx)("div",{className:"col-md-1 py-2",children:(0,x.jsx)("button",{onClick:()=>he(!0),className:"btn btn-bni w-100",children:(0,x.jsx)("i",{className:"fa fa-calendar-o mt-20"})})})]}),me?Te():v&&v.length>0?(0,x.jsx)(y,{}):(0,x.jsx)("div",{className:"py-3 text-center",children:(0,x.jsx)(u.A,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})}),(0,x.jsx)("div",{className:"row",children:(0,x.jsx)("div",{className:"col-md-12 pt-2",children:re&&F&&N.length&&I.length&&ce&&(0,x.jsx)(K,{})})})]}):Te()})})]})]})]})}}}]);