"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[1770],{9595:(e,t,s)=>{s.d(t,{I:()=>r});var a=s(9950),n=s(8429);const r=()=>{const{search:e}=(0,n.zy)();return(0,a.useMemo)((()=>new URLSearchParams(e)),[e])}},6731:(e,t,s)=>{s.d(t,{E:()=>l,x:()=>i});s(9950);var a=s(3027),n=s(2074),r=s(4414);const i=()=>(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"d-flex align-items-center",children:[(0,r.jsx)("i",{className:"fa fa-exclamation-triangle fa-2x pt-2 text-danger"}),(0,r.jsxs)("div",{className:"ps-2",children:[(0,r.jsx)("div",{className:"fs-3",children:(0,r.jsx)(a.A,{id:"alert",defaultMessage:"alert"})}),(0,r.jsx)("div",{className:"fs-6",children:(0,r.jsx)(a.A,{id:"maximumQuotaExceeded",defaultMessage:"maximumQuotaExceeded"})})]})]})}),l=()=>(0,r.jsx)("div",{className:"d-flex align-items-center justify-content-between",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)(n.N_,{className:"btn btn-sm btn-primary me-1 rounded-pill",to:"/billing",children:[(0,r.jsx)("i",{className:"fa fa-credit-card-alt pe-1"}),(0,r.jsx)(a.A,{id:"upgradeNow",defaultMessage:"upgradeNow"})]}),(0,r.jsx)("span",{className:"fs-6",children:(0,r.jsx)(a.A,{id:"accessUnlimitedStorage",defaultMessage:"accessUnlimitedStorage"})})]})})},8002:(e,t,s)=>{s.r(t),s.d(t,{BoxPlotChart:()=>f,CircleShape:()=>v,CircularBarChart:()=>x,CylinderShape:()=>M,DensityChart:()=>u,DiamondShape:()=>k,DirectionArrowShape:()=>A,DivergingBarChart:()=>i,DonutChart:()=>m,DoubleArrowShape:()=>C,HorizontalArrowShape:()=>N,HorizontalBarChart:()=>o,LineChart:()=>p,LineShape:()=>E,PannableChart:()=>r,ParllelogramShape:()=>S,PieChart:()=>c,ScatterPlotChart:()=>h,SmileyEmoji:()=>z,SquareShape:()=>j,StackedVerticalBarChart:()=>d,TriangleShape:()=>y,Tshape:()=>w,VerticalBarChart:()=>n,VoronoiChart:()=>g,WordCloudChart:()=>b,ZoomableCirclePackingChart:()=>l});var a=s(9950);const n=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(8129)]).then(s.bind(s,8129)))),r=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(7771)]).then(s.bind(s,7771)))),i=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(2730)]).then(s.bind(s,2730)))),l=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(7626)]).then(s.bind(s,7626)))),o=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(5843)]).then(s.bind(s,5843)))),d=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(9066)]).then(s.bind(s,9066)))),c=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(8162)]).then(s.bind(s,8162)))),m=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(4596)]).then(s.bind(s,4596)))),h=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(2633)]).then(s.bind(s,2633)))),u=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(8566)]).then(s.bind(s,8566)))),f=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(3674)]).then(s.bind(s,1293)))),p=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(6180)]).then(s.bind(s,6180)))),g=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(166)]).then(s.bind(s,166)))),x=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(4778)]).then(s.bind(s,4778)))),b=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(853),s.e(6688)]).then(s.bind(s,6688)))),v=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(8939)]).then(s.bind(s,8939)))),y=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(6527)]).then(s.bind(s,6527)))),j=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(9754)]).then(s.bind(s,9754)))),k=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(316)]).then(s.bind(s,316)))),w=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(833)]).then(s.bind(s,833)))),N=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(6454)]).then(s.bind(s,6454)))),C=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(979)]).then(s.bind(s,979)))),S=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(6803)]).then(s.bind(s,6803)))),M=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(5005)]).then(s.bind(s,5005)))),A=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(1313)]).then(s.bind(s,1313)))),z=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(7901)]).then(s.bind(s,7901)))),E=(0,a.lazy)((()=>Promise.all([s.e(4761),s.e(910),s.e(7301)]).then(s.bind(s,7301))))},1770:(e,t,s)=>{s.r(t),s.d(t,{default:()=>z});var a=s(9950),n=s(246),r=s(6781),i=s(8459),l=s(5623),o=s(7937),d=s(5342),c=s(3302),m=s(1432),h=s(9288),u=s(3027),f=s(68),p=s(8002),g=s(7956),x=s(2436),b=s(4570),v=s(2016);const y=function(e,t){const s=(0,a.useRef)(!1),[n,r]=(0,a.useState)({top:t.y,left:t.x,rotate:t.z,width:t.props.width,height:t.props.height}),i=(0,a.useRef)({startX:0,startY:0,lastX:t.x,lastY:t.y});return(0,a.useEffect)((()=>{const t=document.getElementById(e);if(!t)throw new Error("Element with given id doesn't exist");const a=t.parentElement;if(!a)throw new Error("target element must have a parent");const n=async e=>{s.current=!0,i.current.startX=e.clientX,i.current.startY=e.clientY;[...e.target.classList].includes("resizeHandle")&&d(e)},l=async e=>{s.current=!1,i.current.lastX=t.offsetLeft,i.current.lastY=t.offsetTop},o=async e=>{if(s.current){const t=[...e.target.classList];t.includes("rotateHandle")||t.includes("resizeHandle")||c(e),t.includes("rotateHandle")&&m(e)}},d=async e=>{const s=e.target.parentElement.clientWidth,a=e.target.parentElement.clientHeight,n=e.pageX,i=e.pageY,l=e=>{const l=s-n+e.pageX,o=a-i+e.pageY;l<=v.Pb.maxWidth&&l>=v.Pb.minWidth&&o<=v.Pb.maxHeight&&o>=v.Pb.minHeight&&(t.style.width=`${l}px`,t.style.height=`${o}px`,r((e=>({...e,width:l,height:o}))))},o=()=>{document.body.removeEventListener("mousemove",l),document.body.removeEventListener("mouseup",o)};document.body.addEventListener("mousemove",l),document.body.addEventListener("mouseup",o)},c=async e=>{const s=e.clientX-i.current.startX+i.current.lastX,a=e.clientY-i.current.startY+i.current.lastY;t.style.top=`${a}px`,t.style.left=`${s}px`,r((e=>({...e,top:a,left:s})))},m=async e=>{const s=t.getBoundingClientRect(),a=s.left+s.width/2,n=s.top+s.height/2,i=Math.atan2(e.pageX-a,-(e.pageY-n))*(180/Math.PI);t.style.transform=`rotate(${i}deg)`,r((e=>({...e,rotate:i})))},h=async()=>{s.current=!1};t.addEventListener("mousedown",n),t.addEventListener("mouseup",l),t.addEventListener("mouseout",h),a.addEventListener("mousemove",o),a.addEventListener("mouseleave",l);return()=>{t.removeEventListener("mousedown",n),t.removeEventListener("mouseup",l),t.removeEventListener("mouseout",h),a.removeEventListener("mousemove",o),a.removeEventListener("mouseleave",l)}}),[e]),[n,r]};var j=s(5491),k=s.n(j),w=s(4414);const N=e=>{let{id:t,children:s,catId:n}=e;const r=(0,a.useContext)(f.A),{activeChart:i,deleteChart:l}=r;return(0,w.jsxs)(w.Fragment,{children:[i===t&&(0,w.jsxs)(w.Fragment,{children:[["SHAPES","EMOJI"].includes(v.XD[n])&&(0,w.jsx)("i",{className:"fa fa-times-circle position-absolute top-0 start-100 translate-middle text-danger heightHandle cursor-pointer",style:{zIndex:10},onClick:()=>l(t)}),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("i",{className:"fa fa-repeat fa-2x position-absolute icon-bni draggable rotateHandle",style:{left:"calc(50% - 5px)",top:"-40px"}}),!["EMOJI"].includes(v.XD[n])&&(0,w.jsx)("i",{className:"fa fa-arrows-h fa-rotate-90 position-absolute icon-bni draggable resizeHandle",style:{transform:"rotate(45deg)",zIndex:10,right:"-15px",bottom:"-15px"}})]})]}),s]})},C=e=>{var t;let{id:s,Component:n,chartObject:r}=e;const i=(0,h.A)(),[l]=y(s,r),o=(0,a.useContext)(f.A),{theme:d,activeSheet:c,sheets:m,setSheets:u,activeChart:p,setActiveChart:g,deleteChart:x,cloneChart:b,setFile:j}=o,[C,S]=(0,a.useState)(!1),M=(0,a.useRef)(null);(0,a.useEffect)((()=>{C||null==document.fullscreenElement||document.exitFullscreen()}),[C]);const A=(0,a.useCallback)(k()((e=>{u(e)}),300),[]);(0,a.useEffect)((()=>{const e=m.map((e=>(e.id===c&&(e.charts=e.charts.map((e=>(e.id===s&&(e={...e,x:l.left,y:l.top,z:l.rotate,props:{...e.props,width:l.width,height:l.height-(["SHAPES","EMOJI"].includes(v.XD[Number(e.catId)]),0)}}),e)))),e)));A(e,l)}),[l,s]);return(0,w.jsx)("div",{id:s,className:`position-absolute rounded bg-transparent ${d} ${p===s?"highlightedChart":""}`,onClick:()=>g(r.id),style:{top:r.y,left:r.x,transform:`rotate(${r.z}deg)`},children:["SHAPES","EMOJI"].includes(v.XD[r.catId])?(0,w.jsx)(N,{id:r.id,catId:r.catId,children:(0,w.jsx)(n,{...r.props,id:r.id})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)("div",{className:`d-flex column-gap-2 align-items-center justify-content-between bni-bg text-${"dark"===d?"black":"white"} p-1 ${r.visibility?"rounded-top":"rounded"}`,ref:M,children:[(0,w.jsx)("span",{style:{maxWidth:(null===r||void 0===r||null===(t=r.props)||void 0===t?void 0:t.width)/3+"px"||"150px"},className:"pe-2 small d-inline-block text-nowrap overflow-hidden text-truncate",title:r.props.name,children:r.props.name}),(0,w.jsx)("span",{className:"shape draggable",children:new Array(20).fill("").join(":")}),(0,w.jsxs)("span",{children:[(0,w.jsx)("i",{onClick:()=>b(r),title:i.formatMessage({id:"clone",defaultMessage:"clone"}),className:"fa fa-clipboard cursor-pointer me-2"}),C?(0,w.jsx)("i",{onClick:()=>S(!1),title:i.formatMessage({id:"closeFullScreen",defaultMessage:"closeFullScreen"}),className:"fa fa-stop-circle cursor-pointer me-2"}):(0,w.jsx)("i",{onClick:()=>{var e;S(!0),(e=document.getElementById(`${s}`)).requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},title:i.formatMessage({id:"fullScreen",defaultMessage:"fullScreen"}),className:"fa fa-play-circle cursor-pointer me-2"}),(0,w.jsx)("i",{onClick:()=>(e=>{const t=m.map((t=>(t.id===c&&(t.charts=t.charts.map((t=>(t.id===e&&(t={...t,visibility:!t.visibility}),t)))),t)));u(t),j((e=>({...e,isSaved:!1})))})(r.id),title:r.visibility?i.formatMessage({id:"minimize",defaultMessage:"minimize"}):i.formatMessage({id:"maximize",defaultMessage:"maximize"}),className:`fa fa-${r.visibility?"minus":"plus"}-circle cursor-pointer me-2`}),(0,w.jsx)("i",{onClick:()=>x(r.id),title:i.formatMessage({id:"confirmDelete",defaultMessage:"confirmDelete"}),className:"fa fa-times-circle cursor-pointer"})]})]}),(0,w.jsx)("div",{className:`border border-1 border-top-0 border-${"dark"===d?"black":"grey"} rounded-bottom`,children:(0,w.jsx)(N,{id:r.id,catId:r.catId,children:r.visibility&&(0,w.jsx)(n,{...r.props})})})]})})};var S=s(9845),M=s(6731),A=s(9595);const z=()=>{var e,t,s,y;const j=(0,h.A)(),k=(0,a.useContext)(f.A),N=(0,a.useContext)(x.R),z=(0,a.useContext)(S.O),E=Object.keys(p).reduce(((e,t)=>({...e,[t]:p[t]})),{}),{theme:P,activeSheet:F,setActiveSheet:I,defaultSheet:D,sheets:$,setSheets:L,activeChart:R,setActiveChart:W,workbookRef:H,file:T,setFile:q,saveLoading:X,setSaveLoading:B,savedWorkbooks:O,setSavedWorkbooks:Y}=k,[_,J]=(0,a.useState)(!0),[G,U]=(0,a.useState)(0),V=(0,a.useRef)(null),K=(0,a.useRef)(null),[Q,Z]=(0,a.useState)({width:null===K||void 0===K||null===(e=K.current)||void 0===e?void 0:e.clientWidth,height:null===K||void 0===K||null===(t=K.current)||void 0===t?void 0:t.clientHeight}),ee=()=>{B(!0);const e=new FormData;e.append("appId",N.userConfig.appId),b.A.post("workbook/getSavedWorkbooks",e).then((e=>{let{data:t}=e;Y(t.response)})).catch((e=>N.renderToast({type:"error",icon:"fa fa-times-circle",position:"bottom-center",message:j.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})}))).finally((()=>B(!1)))};(0,a.useEffect)((()=>{var e,t;ee(),Z({width:null===K||void 0===K||null===(e=K.current)||void 0===e?void 0:e.clientWidth,height:null===K||void 0===K||null===(t=K.current)||void 0===t?void 0:t.clientHeight})}),[]),(0,a.useEffect)((()=>{var e;const t=(null===(e=$.filter((e=>e.id===F))[0])||void 0===e?void 0:e.zoom)||100;U(t)}),[$,F]);const te=(0,A.I)(),se={fetch:te.get("fetch"),wbId:te.get("wbId")};(0,a.useEffect)((()=>{if("workbook"===se.fetch&&se.wbId&&O.length>0){const e=new FormData;e.append("id",se.wbId),e.append("appId",N.userConfig.appId),b.A.post("workbook/fetchWorkbookById",e).then((async e=>{let{data:t}=e;const s=JSON.parse(t.response.wb_object);L(s),q((e=>({...e,id:t.response.wb_id,name:t.response.wb_name,isSaved:!0}))),setTimeout((()=>{var e,t,a;I(null===(e=s[0])||void 0===e?void 0:e.id),W(null===(t=s[0])||void 0===t||null===(a=t.charts[0])||void 0===a?void 0:a.id)}),100)})).catch((()=>{}))}}),[JSON.stringify(se),O]);const ae=null===(s=$.filter((e=>e.id===F))[0])||void 0===s?void 0:s.charts,ne=()=>(0,w.jsx)("div",{className:"position-relative",style:{height:"calc(100vh - 200px)"},children:(0,w.jsx)("div",{className:"position-absolute w-100 h-100 d-flex align-items-center justify-content-center",children:(0,w.jsx)("i",{className:"fa fa-circle-o-notch fa-5x fa-spin icon-bni"})})}),re=()=>{B(!0);const e=new FormData;e.append("id",T.id),e.append("appId",N.userConfig.appId),b.A.post("workbook/deleteWorkbook",e).then((e=>{let{data:t}=e;t.response?(N.renderToast({position:"bottom-center",message:j.formatMessage({id:"workbookSuccessfullyDeleted",defaultMessage:"workbookSuccessfullyDeleted"})}),ee(),ie()):N.renderToast({position:"bottom-center",type:"error",icon:"fa fa-times-circle",message:j.formatMessage({id:"queryDeleteFailed",defaultMessage:"queryDeleteFailed"})})})).catch((e=>{N.renderToast({type:"error",icon:"fa fa-times-circle",message:j.formatMessage({id:"somethingWentWrong",defaultMessage:"somethingWentWrong"})})})).finally((()=>{B(!1),document.body.click()}))},ie=()=>{L(D),setTimeout((()=>{var e;I(null===(e=D[0])||void 0===e?void 0:e.id),q((e=>({...e,id:null,name:""}))),q((e=>({...e,isSaved:!0})))}),100)};return(0,w.jsxs)("div",{className:"",children:[(0,w.jsx)(r.A,{children:(0,w.jsx)(i.A,{className:""+(R?"pe-5":""),children:(0,w.jsxs)(l.A,{className:"rounded",size:"sm",children:[(0,w.jsx)(o.A,{variant:"",className:`rounded-0 border-start-0 border-${"dark"===P?"secondary":"light"} btn-${P}`,onClick:()=>ie(),title:j.formatMessage({id:"newWorkbook",defaultMessage:"newWorkbook"}),children:(0,w.jsx)("i",{className:"fa fa-book"})}),(0,w.jsxs)(d.A,{children:[(0,w.jsx)(d.A.Toggle,{className:"btn-bni border-"+("dark"===P?"secondary":"light"),children:(0,w.jsx)(u.A,{id:"workbook",defaultMessage:"workbook"})}),(0,w.jsx)(d.A.Menu,{variant:P,className:"overflow-auto",style:{maxHeight:"300px"},children:(null===O||void 0===O?void 0:O.length)>0?O.map(((e,t)=>(0,w.jsxs)(d.A.Item,{as:"div",className:"d-flex align-items-center px-1 py-0 small cursor-pointer",onClick:()=>(e=>{const t=new FormData;t.append("id",e),t.append("appId",N.userConfig.appId),b.A.post("workbook/fetchWorkbookById",t).then((e=>{let{data:t}=e;const s=JSON.parse(t.response.wb_object);L(s),q((e=>({...e,id:t.response.wb_id,name:t.response.wb_name,isSaved:!0}))),setTimeout((()=>{var e,t,a;I(null===(e=s[0])||void 0===e?void 0:e.id),W(null===(t=s[0])||void 0===t||null===(a=t.charts[0])||void 0===a?void 0:a.id)}),100)})).catch((()=>{}))})(e.wb_id),children:[(0,w.jsx)("i",{className:"fa fa-book icon-bni pe-2"}),(0,w.jsx)("div",{className:"small",children:e.wb_name})]},t))):(0,w.jsxs)(d.A.Item,{className:"d-flex align-items-center justify-content-center px-1 py-0 small",children:[(0,w.jsx)("i",{className:"fa fa-exclamation-triangle pe-2"}),(0,w.jsx)("span",{children:(0,w.jsx)(u.A,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})})]})})]}),(0,w.jsx)(c.A.Control,{className:"border-"+("dark"===P?"secondary":"light"),placeholder:`${j.formatMessage({id:"name",defaultMessage:"name"})}`,onChange:e=>q((t=>({...t,name:e.target.value}))),value:T.name,maxLength:25}),X&&(0,w.jsx)(o.A,{className:"bg-white border-0",children:(0,w.jsx)("i",{className:"fa fa-circle-o-notch fa-spin bni-text"})}),(0,w.jsx)(o.A,{variant:P,className:`border-${"dark"===P?"secondary":"light"} btn-${P} border-end-0`,onClick:()=>(()=>{B(!0);const e=new FormData,t={...T,sheets:$},s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});e.append("fileData",s),b.A.post("workbook/saveWorkbook",e).then((e=>{let{data:t}=e;null!==t.response&&t.response&&(q((e=>({...e,id:t.response}))),ee(),q((e=>({...e,isSaved:!0}))),N.renderToast({position:"bottom-center",message:j.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})})),null===t.response&&z.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,w.jsx)(M.x,{}),content:(0,w.jsx)(M.E,{})}),null===t.response||t.response||N.renderToast({position:"bottom-center",type:"error",icon:"fa fa-times-circle",message:j.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})})})).catch((e=>{N.renderToast({type:"error",icon:"fa fa-times-circle",position:"bottom-center",message:j.formatMessage({id:"somethingWentWrong",defaultMessage:"somethingWentWrong"})})})).finally((()=>B(!1)))})(),disabled:!(T.name&&$.some((e=>e.charts.length>0))),children:(0,w.jsx)("i",{className:"fa fa-save"})}),(0,w.jsx)(m.A,{trigger:"click",placement:"bottom",overlay:(0,w.jsxs)(n.A,{style:{zIndex:1e4},children:[(0,w.jsx)(n.A.Header,{as:"div",className:"bni-bg bni-text py-1 px-2",children:(0,w.jsx)("small",{children:j.formatMessage({id:"confirmDelete",defaultMessage:"confirmDelete"})})}),(0,w.jsxs)(n.A.Body,{style:{columnGap:"5px"},className:"p-1 d-flex align-items-center justify-content-between",children:[(0,w.jsx)("button",{onClick:()=>re(),className:"btn btn-sm btn-danger w-100 py-0",children:j.formatMessage({id:"yes",defaultMessage:"yes"})}),(0,w.jsx)("button",{onClick:()=>document.body.click(),className:"btn btn-sm btn-secondary w-100 py-0",children:j.formatMessage({id:"no",defaultMessage:"no"})})]})]}),rootClose:!0,children:(0,w.jsx)(o.A,{variant:P,className:`border-${"dark"===P?"secondary":"light"} btn-${P} border-end-0`,disabled:!T.id,children:(0,w.jsx)("i",{className:"fa fa-trash"})})}),(0,w.jsx)(m.A,{trigger:"click",placement:"bottom",overlay:(0,w.jsxs)(n.A,{style:{zIndex:1e4},children:[(0,w.jsx)(n.A.Header,{as:"div",className:"bni-bg bni-text py-1 px-2",children:(0,w.jsx)("small",{children:j.formatMessage({id:"info",defaultMessage:"info"})})}),(0,w.jsx)(n.A.Body,{className:"p-1",style:{width:"120px"},children:(0,w.jsxs)(r.A,{children:[(0,w.jsx)(i.A,{xs:8,children:(0,w.jsx)("small",{children:j.formatMessage({id:"sheets",defaultMessage:"sheets"})})}),(0,w.jsx)(i.A,{xs:4,children:(0,w.jsx)("small",{children:$.length})}),(0,w.jsx)(i.A,{xs:8,children:(0,w.jsx)("small",{children:j.formatMessage({id:"charts",defaultMessage:"charts"})})}),(0,w.jsx)(i.A,{xs:4,children:(0,w.jsx)("small",{children:$.map((e=>e.charts.length)).reduce(((e,t)=>e+t),0)})}),(0,w.jsx)(i.A,{xs:12,children:(0,w.jsxs)("small",{children:[j.formatMessage({id:"fileSize",defaultMessage:"fileSize"})," ",(JSON.stringify($).length/1024).toFixed(2)," Kb"]})})]})})]}),rootClose:!0,children:(0,w.jsx)(o.A,{variant:P,className:`border-${"dark"===P?"secondary":"light"} btn-${P} border-end-0`,style:{padding:"0 12px"},children:(0,w.jsx)("i",{className:"fa fa-info"})})}),(0,w.jsx)(o.A,{variant:P,className:`border-${"dark"===P?"secondary":"light"} btn-${P} border-end-0`,onClick:()=>J(!_),children:(0,w.jsx)("i",{className:"fa fa-th-large"})}),(0,w.jsx)(o.A,{variant:P,className:`border-${"dark"===P?"secondary":"light"} btn-${P} rounded-0`,onClick:()=>{var e;(e=H.current).requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},children:(0,w.jsx)("i",{className:"fa fa-expand"})})]})})}),(0,w.jsx)(a.Suspense,{fallback:(0,w.jsx)(ne,{}),children:(0,w.jsx)("div",{ref:K,className:"overflow-auto",style:{height:`${Q.height}px`},children:(0,w.jsx)("div",{ref:V,style:{zoom:G/100},className:`position-relative chart-container chart-container-${_?P:""} ${null===N||void 0===N||null===(y=N.userConfig)||void 0===y?void 0:y.webMenuType}`,onDrop:e=>(async e=>{if(ae.length<v.e_.chartLimit){const t=V.current.getBoundingClientRect(),s=JSON.parse(e.dataTransfer.getData("workbookDragData")),a=(0,g.A)(),n=$.map((n=>(n.id===F&&(n.charts=[...n.charts,{...s.chart,id:a,x:e.clientX-t.left,y:e.clientY-t.top,z:0}]),n)));await L(n),await W(a),await q((e=>({...e,isSaved:!1})))}else N.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:j.formatMessage({id:"chartLimitExceeded",defaultMessage:"chartLimitExceeded"})})})(e),onDragOver:e=>{e.preventDefault()},onClick:e=>{e.currentTarget===e.target&&W("")},children:(null===ae||void 0===ae?void 0:ae.length)>0?ae.map((e=>{const t=E[e.chartKey];return(0,w.jsx)(C,{id:e.id,Component:t,chartObject:e},e.id)})):(0,w.jsx)("div",{className:"d-flex align-items-center h-100 justify-content-center",children:(0,w.jsx)("kbd",{className:`text-secondary small bg-${P}`,children:(0,w.jsx)(u.A,{id:"startToDragChartsHere",defaultMessage:"startToDragChartsHere"})})})})})})]})}}}]);