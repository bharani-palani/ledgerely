(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[24],{100:function(e,t,n){"use strict";var a=n(25),r=n(27),c=n(28),i=n(34),o=n.n(i),s=n(1),l=n(39),u=n(56),d=Object(u.a)("popover-header"),b=Object(u.a)("popover-body"),f=n(74),j=n(75),p=n(0),h=["bsPrefix","placement","className","style","children","body","arrowProps","hasDoneInitialMeasure","popper","show"],m=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.placement,s=void 0===i?"right":i,u=e.className,d=e.style,m=e.children,O=e.body,v=e.arrowProps,g=e.hasDoneInitialMeasure,x=e.popper,y=e.show,w=Object(c.a)(e,h),k=Object(l.c)(n,"popover"),C=Object(l.d)(),N=(null==s?void 0:s.split("-"))||[],S=Object(r.a)(N,1)[0],E=Object(f.a)(S,C),M=d;return y&&!g&&(M=Object(a.a)(Object(a.a)({},d),Object(j.a)(null==x?void 0:x.strategy))),Object(p.jsxs)("div",Object(a.a)(Object(a.a)({ref:t,role:"tooltip",style:M,"x-placement":S,className:o()(u,k,S&&"bs-popover-".concat(E))},w),{},{children:[Object(p.jsx)("div",Object(a.a)({className:"popover-arrow"},v)),O?Object(p.jsx)(b,{children:m}):m]}))}));t.a=Object.assign(m,{Header:d,Body:b,POPPER_OFFSET:[0,8]})},1247:function(e,t,n){"use strict";n.r(t);var a=n(43),r=n(29),c=n(35),i=n(27),o=n(36),s=n(25),l=n(1),u=n(100),d=n(1263),b=n(933),f=n(1264),j=n(934),p=n(1243),h=n(1279),m=n(224),O=n(777),v=n(1260),g=n(90),x=n(214),y=n(1284),w=n(38),k=n(47),C=n(41);var N=function(e,t){var n=Object(l.useRef)(!1),o=Object(l.useState)({top:t.y,left:t.x,rotate:t.z,width:t.props.width,height:t.props.height}),u=Object(i.a)(o,2),d=u[0],b=u[1],f=Object(l.useRef)({startX:0,startY:0,lastX:t.x,lastY:t.y});return Object(l.useEffect)((function(){var t=document.getElementById(e);if(!t)throw new Error("Element with given id doesn't exist");var i=t.parentElement;if(!i)throw new Error("target element must have a parent");var o=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.current=!0,f.current.startX=t.clientX,f.current.startY=t.clientY,Object(a.a)(t.target.classList).includes("resizeHandle")&&d(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(c.a)(Object(r.a)().mark((function e(a){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.current=!1,f.current.lastX=t.offsetLeft,f.current.lastY=t.offsetTop;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.current&&((c=Object(a.a)(t.target.classList)).includes("rotateHandle")||c.includes("resizeHandle")||j(t),c.includes("rotateHandle")&&p(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(Object(r.a)().mark((function e(n){var a,c,i,o;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={width:n.target.parentElement.clientWidth,height:n.target.parentElement.clientHeight},c={x:n.pageX,y:n.pageY},i=function(e){var n=a.width-c.x+e.pageX,r=a.height-c.y+e.pageY;n<=C.a.maxWidth&&n>=C.a.minWidth&&r<=C.a.maxHeight&&r>=C.a.minHeight&&(t.style.width="".concat(n,"px"),t.style.height="".concat(r,"px"),b((function(e){return Object(s.a)(Object(s.a)({},e),{},{width:n,height:r})})))},o=function e(){document.body.removeEventListener("mousemove",i),document.body.removeEventListener("mouseup",e)},document.body.addEventListener("mousemove",i),document.body.addEventListener("mouseup",o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(c.a)(Object(r.a)().mark((function e(n){var a,c;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.clientX-f.current.startX+f.current.lastX,c=n.clientY-f.current.startY+f.current.lastY,t.style.top="".concat(c,"px"),t.style.left="".concat(a,"px"),b((function(e){return Object(s.a)(Object(s.a)({},e),{},{top:c,left:a})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(c.a)(Object(r.a)().mark((function e(n){var a,c,i;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.getBoundingClientRect(),c={x:a.left+a.width/2,y:a.top+a.height/2},i=Math.atan2(n.pageX-c.x,-(n.pageY-c.y))*(180/Math.PI),t.style.transform="rotate(".concat(i,"deg)"),b((function(e){return Object(s.a)(Object(s.a)({},e),{},{rotate:i})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(c.a)(Object(r.a)().mark((function e(){return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.current=!1;case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.addEventListener("mousedown",o),t.addEventListener("mouseup",l),t.addEventListener("mouseout",h),i.addEventListener("mousemove",u),i.addEventListener("mouseleave",l);return function(){t.removeEventListener("mousedown",o),t.removeEventListener("mouseup",l),t.removeEventListener("mouseout",h),i.removeEventListener("mousemove",u),i.removeEventListener("mouseleave",l)}}),[e]),[d,b]},S=n(140),E=n.n(S),M=n(0),P=function(e){var t=e.id,n=e.children,a=e.catId,r=Object(l.useContext)(g.a),c=r.activeChart,i=r.deleteChart;return Object(M.jsxs)(M.Fragment,{children:[c===t&&Object(M.jsxs)(M.Fragment,{children:[["SHAPES","EMOJI"].includes(C.b[a])&&Object(M.jsx)("i",{className:"fa fa-times-circle position-absolute top-0 start-100 translate-middle text-danger heightHandle cursor-pointer",style:{zIndex:10},onClick:function(){return i(t)}}),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("i",{className:"fa fa-repeat fa-2x position-absolute icon-bni draggable rotateHandle",style:{left:"calc(50% - 5px)",top:"-40px"}}),!["EMOJI"].includes(C.b[a])&&Object(M.jsx)("i",{className:"fa fa-arrows-h fa-rotate-90 position-absolute icon-bni draggable resizeHandle",style:{transform:"rotate(45deg)",zIndex:10,right:"-15px",bottom:"-15px"}})]})]}),n]})},z=function(e){var t,n=e.id,a=e.Component,r=e.chartObject,c=Object(O.a)(),o=N(n,r),u=Object(i.a)(o,1)[0],d=Object(l.useContext)(g.a),b=d.theme,f=d.activeSheet,j=d.sheets,p=d.setSheets,h=d.activeChart,m=d.setActiveChart,v=d.deleteChart,x=d.cloneChart,y=d.setFile,w=Object(l.useState)(!1),k=Object(i.a)(w,2),S=k[0],z=k[1],F=Object(l.useRef)(null);Object(l.useEffect)((function(){S||null==document.fullscreenElement||document.exitFullscreen()}),[S]);var T=Object(l.useCallback)(E()((function(e){p(e)}),300),[]);Object(l.useEffect)((function(){var e=j.map((function(e){return e.id===f&&(e.charts=e.charts.map((function(e){return e.id===n&&(e=Object(s.a)(Object(s.a)({},e),{},{x:u.left,y:u.top,z:u.rotate,props:Object(s.a)(Object(s.a)({},e.props),{},{width:u.width,height:u.height-(["SHAPES","EMOJI"].includes(C.b[Number(e.catId)]),0)})})),e}))),e}));T(e,u)}),[u,n]);return Object(M.jsx)("div",{id:n,className:"position-absolute rounded bg-transparent ".concat(b," ").concat(h===n?"highlightedChart":""),onClick:function(){return m(r.id)},style:{top:r.y,left:r.x,transform:"rotate(".concat(r.z,"deg)")},children:["SHAPES","EMOJI"].includes(C.b[r.catId])?Object(M.jsx)(P,{id:r.id,catId:r.catId,children:Object(M.jsx)(a,Object(s.a)({},Object(s.a)(Object(s.a)({},r.props),{},{id:r.id})))}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)("div",{className:"d-flex column-gap-2 align-items-center justify-content-between bni-bg text-".concat("dark"===b?"black":"white"," p-1 ").concat(r.visibility?"rounded-top":"rounded"),ref:F,children:[Object(M.jsx)("span",{style:{maxWidth:"".concat((null===r||void 0===r||null===(t=r.props)||void 0===t?void 0:t.width)/3,"px")||!1},className:"pe-2 small d-inline-block text-nowrap overflow-hidden text-truncate",title:r.props.name,children:r.props.name}),Object(M.jsx)("span",{className:"shape draggable",children:new Array(20).fill("").join(":")}),Object(M.jsxs)("span",{children:[Object(M.jsx)("i",{onClick:function(){return x(r)},title:c.formatMessage({id:"clone",defaultMessage:"clone"}),className:"fa fa-clipboard cursor-pointer me-2"}),S?Object(M.jsx)("i",{onClick:function(){return z(!1)},title:c.formatMessage({id:"closeFullScreen",defaultMessage:"closeFullScreen"}),className:"fa fa-stop-circle cursor-pointer me-2"}):Object(M.jsx)("i",{onClick:function(){var e;z(!0),(e=document.getElementById("".concat(n))).requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},title:c.formatMessage({id:"fullScreen",defaultMessage:"fullScreen"}),className:"fa fa-play-circle cursor-pointer me-2"}),Object(M.jsx)("i",{onClick:function(){return function(e){var t=j.map((function(t){return t.id===f&&(t.charts=t.charts.map((function(t){return t.id===e&&(t=Object(s.a)(Object(s.a)({},t),{},{visibility:!t.visibility})),t}))),t}));p(t),y((function(e){return Object(s.a)(Object(s.a)({},e),{},{isSaved:!1})}))}(r.id)},title:r.visibility?c.formatMessage({id:"minimize",defaultMessage:"minimize"}):c.formatMessage({id:"maximize",defaultMessage:"maximize"}),className:"fa fa-".concat(r.visibility?"minus":"plus","-circle cursor-pointer me-2")}),Object(M.jsx)("i",{onClick:function(){return v(r.id)},title:c.formatMessage({id:"confirmDelete",defaultMessage:"confirmDelete"}),className:"fa fa-times-circle cursor-pointer"})]})]}),Object(M.jsx)("div",{className:"border border-1 border-top-0 border-".concat("dark"===b?"black":"grey"," rounded-bottom"),children:Object(M.jsx)(P,{id:r.id,catId:r.catId,children:r.visibility&&Object(M.jsx)(a,Object(s.a)({},r.props))})})]})})},F=n(65),T=n(61),I=n(82);t.default=function(){var e,t,n,N,S=Object(O.a)(),E=Object(l.useContext)(g.a),P=Object(l.useContext)(w.a),D=Object(l.useContext)(F.a),R=Object.keys(x).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(o.a)({},t,x[t]))}),{}),L=E.theme,H=E.activeSheet,W=E.setActiveSheet,_=E.defaultSheet,q=E.sheets,B=E.setSheets,A=E.activeChart,J=E.setActiveChart,X=E.workbookRef,Y=E.file,U=E.setFile,V=E.saveLoading,G=E.setSaveLoading,K=E.savedWorkbooks,Q=E.setSavedWorkbooks,Z=Object(l.useState)(!0),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ne=Object(l.useState)(0),ae=Object(i.a)(ne,2),re=ae[0],ce=ae[1],ie=Object(l.useRef)(null),oe=Object(l.useState)({width:null===de||void 0===de||null===(e=de.current)||void 0===e?void 0:e.clientWidth,height:null===de||void 0===de||null===(t=de.current)||void 0===t?void 0:t.clientHeight}),se=Object(i.a)(oe,2),le=se[0],ue=se[1],de=Object(l.useRef)(null),be=function(){G(!0);var e=new FormData;e.append("appId",P.userConfig.appId),k.a.post("workbook/getSavedWorkbooks",e).then((function(e){var t=e.data;Q(t.response)})).catch((function(e){return P.renderToast({type:"error",icon:"fa fa-times-circle",position:"bottom-center",message:S.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})).finally((function(){return G(!1)}))};Object(l.useEffect)((function(){var e,t;be(),ue({width:null===de||void 0===de||null===(e=de.current)||void 0===e?void 0:e.clientWidth,height:null===de||void 0===de||null===(t=de.current)||void 0===t?void 0:t.clientHeight})}),[]),Object(l.useEffect)((function(){var e,t=(null===(e=q.filter((function(e){return e.id===H}))[0])||void 0===e?void 0:e.zoom)||100;ce(t)}),[q,H]);var fe=Object(I.a)(),je={fetch:fe.get("fetch"),wbId:fe.get("wbId")};Object(l.useEffect)((function(){if("workbook"===je.fetch&&je.wbId&&K.length>0){var e=new FormData;e.append("id",je.wbId),e.append("appId",P.userConfig.appId),k.a.post("workbook/fetchWorkbookById",e).then(function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n,a;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,a=JSON.parse(n.response.wb_object),B(a),U((function(e){return Object(s.a)(Object(s.a)({},e),{},{id:n.response.wb_id,name:n.response.wb_name,isSaved:!0})})),setTimeout((function(){var e,t,n;W(null===(e=a[0])||void 0===e?void 0:e.id),J(null===(t=a[0])||void 0===t||null===(n=t.charts[0])||void 0===n?void 0:n.id)}),100);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){}))}}),[JSON.stringify(je),K]);var pe=null===(n=q.filter((function(e){return e.id===H}))[0])||void 0===n?void 0:n.charts,he=function(){var e=Object(c.a)(Object(r.a)().mark((function e(t){var n,c,i,o;return Object(r.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(pe.length<C.c.chartLimit)){e.next=13;break}return n=ie.current.getBoundingClientRect(),c=JSON.parse(t.dataTransfer.getData("workbookDragData")),i=Object(y.a)(),o=q.map((function(e){return e.id===H&&(e.charts=[].concat(Object(a.a)(e.charts),[Object(s.a)(Object(s.a)({},c.chart),{},{id:i,x:t.clientX-n.left,y:t.clientY-n.top,z:0})])),e})),e.next=7,B(o);case 7:return e.next=9,J(i);case 9:return e.next=11,U((function(e){return Object(s.a)(Object(s.a)({},e),{},{isSaved:!1})}));case 11:e.next=14;break;case 13:P.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:S.formatMessage({id:"chartLimitExceeded",defaultMessage:"chartLimitExceeded"})});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){return Object(M.jsx)("div",{className:"position-relative",style:{height:"calc(100vh - 200px)"},children:Object(M.jsx)("div",{className:"position-absolute w-100 h-100 d-flex align-items-center justify-content-center",children:Object(M.jsx)("i",{className:"fa fa-circle-o-notch fa-5x fa-spin icon-bni"})})})},Oe=function(){G(!0);var e=new FormData;e.append("id",Y.id),e.append("appId",P.userConfig.appId),k.a.post("workbook/deleteWorkbook",e).then((function(e){e.data.response?(P.renderToast({position:"bottom-center",message:S.formatMessage({id:"workbookSuccessfullyDeleted",defaultMessage:"workbookSuccessfullyDeleted"})}),be(),ve()):P.renderToast({position:"bottom-center",type:"error",icon:"fa fa-times-circle",message:S.formatMessage({id:"queryDeleteFailed",defaultMessage:"queryDeleteFailed"})})})).catch((function(e){P.renderToast({type:"error",icon:"fa fa-times-circle",message:S.formatMessage({id:"somethingWentWrong",defaultMessage:"somethingWentWrong"})})})).finally((function(){G(!1),document.body.click()}))},ve=function(){B(_),setTimeout((function(){var e;W(null===(e=_[0])||void 0===e?void 0:e.id),U((function(e){return Object(s.a)(Object(s.a)({},e),{},{id:null,name:""})})),U((function(e){return Object(s.a)(Object(s.a)({},e),{},{isSaved:!0})}))}),100)};return Object(M.jsxs)("div",{className:"",children:[Object(M.jsx)(d.a,{children:Object(M.jsx)(b.a,{className:"".concat(A?"pe-5":""),children:Object(M.jsxs)(f.a,{className:"rounded",size:"sm",children:[Object(M.jsx)(j.a,{variant:"",className:"rounded-0 border-start-0 border-".concat("dark"===L?"secondary":"light"," btn-").concat(L),onClick:function(){return ve()},title:S.formatMessage({id:"newWorkbook",defaultMessage:"newWorkbook"}),children:Object(M.jsx)("i",{className:"fa fa-book"})}),Object(M.jsxs)(p.a,{children:[Object(M.jsx)(p.a.Toggle,{className:"btn-bni border-".concat("dark"===L?"secondary":"light"),children:Object(M.jsx)(v.a,{id:"workbook",defaultMessage:"workbook"})}),Object(M.jsx)(p.a.Menu,{variant:L,className:"overflow-auto",style:{maxHeight:"300px"},children:(null===K||void 0===K?void 0:K.length)>0?K.map((function(e,t){return Object(M.jsxs)(p.a.Item,{as:"div",className:"d-flex align-items-center px-1 py-0 small cursor-pointer",onClick:function(){return function(e){var t=new FormData;t.append("id",e),t.append("appId",P.userConfig.appId),k.a.post("workbook/fetchWorkbookById",t).then((function(e){var t=e.data,n=JSON.parse(t.response.wb_object);B(n),U((function(e){return Object(s.a)(Object(s.a)({},e),{},{id:t.response.wb_id,name:t.response.wb_name,isSaved:!0})})),setTimeout((function(){var e,t,a;W(null===(e=n[0])||void 0===e?void 0:e.id),J(null===(t=n[0])||void 0===t||null===(a=t.charts[0])||void 0===a?void 0:a.id)}),100)})).catch((function(){}))}(e.wb_id)},children:[Object(M.jsx)("i",{className:"fa fa-book icon-bni pe-2"}),Object(M.jsx)("div",{className:"small",children:e.wb_name})]},t)})):Object(M.jsxs)(p.a.Item,{className:"d-flex align-items-center justify-content-center px-1 py-0 small",children:[Object(M.jsx)("i",{className:"fa fa-exclamation-triangle pe-2"}),Object(M.jsx)("span",{children:Object(M.jsx)(v.a,{id:"noRecordsGenerated",defaultMessage:"noRecordsGenerated"})})]})})]}),Object(M.jsx)(h.a.Control,{className:"border-".concat("dark"===L?"secondary":"light"),placeholder:"".concat(S.formatMessage({id:"name",defaultMessage:"name"})),onChange:function(e){return U((function(t){return Object(s.a)(Object(s.a)({},t),{},{name:e.target.value})}))},value:Y.name,maxLength:25}),V&&Object(M.jsx)(j.a,{className:"bg-white border-0",children:Object(M.jsx)("i",{className:"fa fa-circle-o-notch fa-spin bni-text"})}),Object(M.jsx)(j.a,{variant:L,className:"border-".concat("dark"===L?"secondary":"light"," btn-").concat(L," border-end-0"),onClick:function(){return function(){G(!0);var e=new FormData,t=Object(s.a)(Object(s.a)({},Y),{},{sheets:q}),n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});e.append("fileData",n),k.a.post("workbook/saveWorkbook",e).then((function(e){var t=e.data;null!==t.response&&t.response&&(U((function(e){return Object(s.a)(Object(s.a)({},e),{},{id:t.response})})),be(),U((function(e){return Object(s.a)(Object(s.a)({},e),{},{isSaved:!0})})),P.renderToast({position:"bottom-center",message:S.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})})),null===t.response&&D.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(M.jsx)(T.b,{}),content:Object(M.jsx)(T.a,{})}),null===t.response||t.response||P.renderToast({position:"bottom-center",type:"error",icon:"fa fa-times-circle",message:S.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})})})).catch((function(e){P.renderToast({type:"error",icon:"fa fa-times-circle",position:"bottom-center",message:S.formatMessage({id:"somethingWentWrong",defaultMessage:"somethingWentWrong"})})})).finally((function(){return G(!1)}))}()},disabled:!(Y.name&&q.some((function(e){return e.charts.length>0}))),children:Object(M.jsx)("i",{className:"fa fa-save"})}),Object(M.jsx)(m.a,{trigger:"click",placement:"bottom",overlay:Object(M.jsxs)(u.a,{style:{zIndex:1e4},children:[Object(M.jsx)(u.a.Header,{as:"div",className:"bni-bg bni-text py-1 px-2",children:Object(M.jsx)("small",{children:S.formatMessage({id:"confirmDelete",defaultMessage:"confirmDelete"})})}),Object(M.jsxs)(u.a.Body,{style:{columnGap:"5px"},className:"p-1 d-flex align-items-center justify-content-between",children:[Object(M.jsx)("button",{onClick:function(){return Oe()},className:"btn btn-sm btn-danger w-100 py-0",children:S.formatMessage({id:"yes",defaultMessage:"yes"})}),Object(M.jsx)("button",{onClick:function(){return document.body.click()},className:"btn btn-sm btn-secondary w-100 py-0",children:S.formatMessage({id:"no",defaultMessage:"no"})})]})]}),rootClose:!0,children:Object(M.jsx)(j.a,{variant:L,className:"border-".concat("dark"===L?"secondary":"light"," btn-").concat(L," border-end-0"),disabled:!Y.id,children:Object(M.jsx)("i",{className:"fa fa-trash"})})}),Object(M.jsx)(m.a,{trigger:"click",placement:"bottom",overlay:Object(M.jsxs)(u.a,{style:{zIndex:1e4},children:[Object(M.jsx)(u.a.Header,{as:"div",className:"bni-bg bni-text py-1 px-2",children:Object(M.jsx)("small",{children:S.formatMessage({id:"info",defaultMessage:"info"})})}),Object(M.jsx)(u.a.Body,{className:"p-1",style:{width:"120px"},children:Object(M.jsxs)(d.a,{children:[Object(M.jsx)(b.a,{xs:8,children:Object(M.jsx)("small",{children:S.formatMessage({id:"sheets",defaultMessage:"sheets"})})}),Object(M.jsx)(b.a,{xs:4,children:Object(M.jsx)("small",{children:q.length})}),Object(M.jsx)(b.a,{xs:8,children:Object(M.jsx)("small",{children:S.formatMessage({id:"charts",defaultMessage:"charts"})})}),Object(M.jsx)(b.a,{xs:4,children:Object(M.jsx)("small",{children:q.map((function(e){return e.charts.length})).reduce((function(e,t){return e+t}),0)})}),Object(M.jsx)(b.a,{xs:12,children:Object(M.jsxs)("small",{children:[S.formatMessage({id:"fileSize",defaultMessage:"fileSize"})," ",(JSON.stringify(q).length/1024).toFixed(2)," Kb"]})})]})})]}),rootClose:!0,children:Object(M.jsx)(j.a,{variant:L,className:"border-".concat("dark"===L?"secondary":"light"," btn-").concat(L," border-end-0"),style:{padding:"0 12px"},children:Object(M.jsx)("i",{className:"fa fa-info"})})}),Object(M.jsx)(j.a,{variant:L,className:"border-".concat("dark"===L?"secondary":"light"," btn-").concat(L," border-end-0"),onClick:function(){return te(!ee)},children:Object(M.jsx)("i",{className:"fa fa-th-large"})}),Object(M.jsx)(j.a,{variant:L,className:"border-".concat("dark"===L?"secondary":"light"," btn-").concat(L," rounded-0"),onClick:function(){var e;(e=X.current).requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},children:Object(M.jsx)("i",{className:"fa fa-expand"})})]})})}),Object(M.jsx)(l.Suspense,{fallback:Object(M.jsx)(me,{}),children:Object(M.jsx)("div",{ref:de,className:"overflow-auto",style:{height:"".concat(le.height,"px")},children:Object(M.jsx)("div",{ref:ie,style:{zoom:re/100},className:"position-relative chart-container chart-container-".concat(ee?L:""," ").concat(null===P||void 0===P||null===(N=P.userConfig)||void 0===N?void 0:N.webMenuType),onDrop:function(e){return he(e)},onDragOver:function(e){e.preventDefault()},onClick:function(e){e.currentTarget===e.target&&J("")},children:(null===pe||void 0===pe?void 0:pe.length)>0?pe.map((function(e){var t=R[e.chartKey];return Object(M.jsx)(z,{id:e.id,Component:t,chartObject:e},e.id)})):Object(M.jsx)("div",{className:"d-flex align-items-center h-100 justify-content-center",children:Object(M.jsx)("kbd",{className:"text-secondary small bg-".concat(L),children:Object(M.jsx)(v.a,{id:"startToDragChartsHere",defaultMessage:"startToDragChartsHere"})})})})})})]})}},214:function(e,t,n){"use strict";n.r(t),n.d(t,"VerticalBarChart",(function(){return r})),n.d(t,"PannableChart",(function(){return c})),n.d(t,"DivergingBarChart",(function(){return i})),n.d(t,"ZoomableCirclePackingChart",(function(){return o})),n.d(t,"HorizontalBarChart",(function(){return s})),n.d(t,"StackedVerticalBarChart",(function(){return l})),n.d(t,"PieChart",(function(){return u})),n.d(t,"DonutChart",(function(){return d})),n.d(t,"ScatterPlotChart",(function(){return b})),n.d(t,"DensityChart",(function(){return f})),n.d(t,"BoxPlotChart",(function(){return j})),n.d(t,"LineChart",(function(){return p})),n.d(t,"VoronoiChart",(function(){return h})),n.d(t,"CircularBarChart",(function(){return m})),n.d(t,"WordCloudChart",(function(){return O})),n.d(t,"CircleShape",(function(){return v})),n.d(t,"TriangleShape",(function(){return g})),n.d(t,"SquareShape",(function(){return x})),n.d(t,"DiamondShape",(function(){return y})),n.d(t,"Tshape",(function(){return w})),n.d(t,"HorizontalArrowShape",(function(){return k})),n.d(t,"DoubleArrowShape",(function(){return C})),n.d(t,"ParllelogramShape",(function(){return N})),n.d(t,"CylinderShape",(function(){return S})),n.d(t,"DirectionArrowShape",(function(){return E})),n.d(t,"SmileyEmoji",(function(){return M})),n.d(t,"LineShape",(function(){return P}));var a=n(1),r=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(53)]).then(n.bind(null,591))})),c=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(45)]).then(n.bind(null,592))})),i=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(38)]).then(n.bind(null,593))})),o=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(56)]).then(n.bind(null,594))})),s=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(42)]).then(n.bind(null,595))})),l=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(50)]).then(n.bind(null,596))})),u=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(47)]).then(n.bind(null,597))})),d=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(39)]).then(n.bind(null,598))})),b=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(30)]).then(n.bind(null,626))})),f=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(66)]).then(n.bind(null,632))})),j=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(32)]).then(n.bind(null,620))})),p=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(43)]).then(n.bind(null,599))})),h=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(54)]).then(n.bind(null,600))})),m=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(34)]).then(n.bind(null,601))})),O=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(7),n.e(17),n.e(55)]).then(n.bind(null,623))})),v=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(33)]).then(n.bind(null,606))})),g=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(51)]).then(n.bind(null,607))})),x=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(49)]).then(n.bind(null,608))})),y=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(36)]).then(n.bind(null,633))})),w=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(52)]).then(n.bind(null,609))})),k=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(41)]).then(n.bind(null,610))})),C=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(40)]).then(n.bind(null,611))})),N=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(46)]).then(n.bind(null,612))})),S=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(35)]).then(n.bind(null,613))})),E=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(37)]).then(n.bind(null,614))})),M=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(48)]).then(n.bind(null,615))})),P=Object(a.lazy)((function(){return Promise.all([n.e(0),n.e(1),n.e(44)]).then(n.bind(null,616))}))},224:function(e,t,n){"use strict";var a=n(25),r=n(28),c=n(43),i=n(27),o=n(126),s=n(1),l=n(104),u=n(135),d=Math.pow(2,31)-1;function b(e,t,n){var a=n-Date.now();e.current=a<=d?setTimeout(t,a):setTimeout((function(){return b(e,t,n)}),d)}function f(){var e=Object(l.a)(),t=Object(s.useRef)();return Object(u.a)((function(){return clearTimeout(t.current)})),Object(s.useMemo)((function(){var n=function(){return clearTimeout(t.current)};return{set:function(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e()&&(n(),r<=d?t.current=setTimeout(a,r):b(t,a,Date.now()+r))},clear:n}}),[])}n(106);var j=n(99),p=n(57),h=n(34),m=n.n(h),O=n(9),v=n.n(O),g=n(105),x=n(159),y=n(118),w=n(93),k=n(53),C=n(148),N=n(143),S=function(){};var E=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.disabled,r=n.clickTrigger,c=t||S;Object(C.a)(e,c,{disabled:a,clickTrigger:r});var i=Object(k.a)((function(e){Object(N.a)(e)&&c(e)}));Object(s.useEffect)((function(){if(!a&&null!=e){var t=Object(w.a)(Object(C.b)(e)),n=(t.defaultView||window).event,r=Object(y.a)(t,"keyup",(function(e){e!==n?i(e):n=void 0}));return function(){r()}}}),[e,a,i])},M=n(142),P=n(147),z=n(162),F=s.forwardRef((function(e,t){var n=e.flip,a=e.offset,r=e.placement,c=e.containerPadding,o=e.popperConfig,l=void 0===o?{}:o,u=e.transition,d=e.runTransition,b=Object(g.a)(),f=Object(i.a)(b,2),j=f[0],h=f[1],m=Object(g.a)(),O=Object(i.a)(m,2),y=O[0],w=O[1],k=Object(p.a)(h,t),C=Object(M.a)(e.container),N=Object(M.a)(e.target),S=Object(s.useState)(!e.show),F=Object(i.a)(S,2),T=F[0],I=F[1],D=Object(x.a)(N,j,Object(P.a)({placement:r,enableEvents:!!e.show,containerPadding:c||5,flip:n,offset:a,arrowElement:y,popperConfig:l}));e.show&&T&&I(!1);var R=e.show||!T;if(E(j,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!R)return null;var L=e.onExit,H=e.onExiting,W=e.onEnter,_=e.onEntering,q=e.onEntered,B=e.children(Object.assign({},D.attributes.popper,{style:D.styles.popper,ref:k}),{popper:D,placement:r,show:!!e.show,arrowProps:Object.assign({},D.attributes.arrow,{style:D.styles.arrow,ref:w})});return B=Object(z.a)(u,d,{in:!!e.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:B,onExit:L,onExiting:H,onExited:function(){I(!0),e.onExited&&e.onExited.apply(e,arguments)},onEnter:W,onEntering:_,onEntered:q}),C?v.a.createPortal(B,C):null}));F.displayName="Overlay";var T=F,I=n(103),D=n(141),R=n(39),L=n(100),H=n(97);var W=n(119),_=n(86),q=n(0),B=["children","transition","popperConfig","rootClose","placement","show"];var A=s.forwardRef((function(e,t){var n=e.children,c=e.transition,o=void 0===c?W.a:c,l=e.popperConfig,u=void 0===l?{}:l,d=e.rootClose,b=void 0!==d&&d,f=e.placement,j=void 0===f?"top":f,h=e.show,O=void 0!==h&&h,v=Object(r.a)(e,B),g=Object(s.useRef)({}),x=Object(s.useState)(null),y=Object(i.a)(x,2),w=y[0],C=y[1],N=function(e){var t=Object(s.useRef)(null),n=Object(R.c)(void 0,"popover"),a=Object(R.c)(void 0,"tooltip"),r=Object(s.useMemo)((function(){return{name:"offset",options:{offset:function(){if(e)return e;if(t.current){if(Object(D.a)(t.current,n))return L.a.POPPER_OFFSET;if(Object(D.a)(t.current,a))return H.a.TOOLTIP_OFFSET}return[0,0]}}}}),[e,n,a]);return[t,[r]]}(v.offset),S=Object(i.a)(N,2),E=S[0],M=S[1],P=Object(p.a)(t,E),z=!0===o?W.a:o||void 0,F=Object(k.a)((function(e){C(e),null==u||null==u.onFirstUpdate||u.onFirstUpdate(e)}));return Object(I.a)((function(){w&&(null==g.current.scheduleUpdate||g.current.scheduleUpdate())}),[w]),Object(s.useEffect)((function(){O||C(null)}),[O]),Object(q.jsx)(T,Object(a.a)(Object(a.a)({},v),{},{ref:P,popperConfig:Object(a.a)(Object(a.a)({},u),{},{modifiers:M.concat(u.modifiers||[]),onFirstUpdate:F}),transition:z,rootClose:b,placement:j,show:O,children:function(e,t){var r,c,i=t.arrowProps,l=t.popper,d=t.show;!function(e,t){var n=e.ref,a=t.ref;e.ref=n.__wrapped||(n.__wrapped=function(e){return n(Object(_.a)(e))}),t.ref=a.__wrapped||(a.__wrapped=function(e){return a(Object(_.a)(e))})}(e,i);var b=null==l?void 0:l.placement,f=Object.assign(g.current,{state:null==l?void 0:l.state,scheduleUpdate:null==l?void 0:l.update,placement:b,outOfBoundaries:(null==l||null==(r=l.state)||null==(c=r.modifiersData.hide)?void 0:c.isReferenceHidden)||!1,strategy:u.strategy}),j=!!w;return"function"===typeof n?n(Object(a.a)(Object(a.a)(Object(a.a)({},e),{},{placement:b,show:d},!o&&d&&{className:"show"}),{},{popper:f,arrowProps:i,hasDoneInitialMeasure:j})):s.cloneElement(n,Object(a.a)(Object(a.a)({},e),{},{placement:b,arrowProps:i,popper:f,hasDoneInitialMeasure:j,className:m()(n.props.className,!o&&d&&"show"),style:Object(a.a)(Object(a.a)({},n.props.style),e.style)}))}}))}));A.displayName="Overlay";var J=A,X=["trigger","overlay","children","popperConfig","show","defaultShow","onToggle","delay","placement","flip"];function Y(e,t,n){var a=Object(i.a)(t,1)[0],r=a.currentTarget,s=a.relatedTarget||a.nativeEvent[n];s&&s===r||Object(o.a)(r,s)||e.apply(void 0,Object(c.a)(t))}t.a=function(e){var t=e.trigger,n=void 0===t?["hover","focus"]:t,c=e.overlay,o=e.children,l=e.popperConfig,u=void 0===l?{}:l,d=e.show,b=e.defaultShow,h=void 0!==b&&b,m=e.onToggle,O=e.delay,v=e.placement,g=e.flip,x=void 0===g?v&&-1!==v.indexOf("auto"):g,y=Object(r.a)(e,X),w=Object(s.useRef)(null),k=Object(p.a)(w,o.ref),C=f(),N=Object(s.useRef)(""),S=Object(j.b)(d,h,m),E=Object(i.a)(S,2),M=E[0],P=E[1],z=function(e){return e&&"object"===typeof e?e:{show:e,hide:e}}(O),F="function"!==typeof o?s.Children.only(o).props:{},T=F.onFocus,I=F.onBlur,D=F.onClick,R=Object(s.useCallback)((function(){C.clear(),N.current="show",z.show?C.set((function(){"show"===N.current&&P(!0)}),z.show):P(!0)}),[z.show,P,C]),L=Object(s.useCallback)((function(){C.clear(),N.current="hide",z.hide?C.set((function(){"hide"===N.current&&P(!1)}),z.hide):P(!1)}),[z.hide,P,C]),H=Object(s.useCallback)((function(){R(),null==T||T.apply(void 0,arguments)}),[R,T]),W=Object(s.useCallback)((function(){L(),null==I||I.apply(void 0,arguments)}),[L,I]),B=Object(s.useCallback)((function(){P(!M),null==D||D.apply(void 0,arguments)}),[D,P,M]),A=Object(s.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y(R,t,"fromElement")}),[R]),U=Object(s.useCallback)((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Y(L,t,"toElement")}),[L]),V=null==n?[]:[].concat(n),G={ref:function(e){k(Object(_.a)(e))}};return-1!==V.indexOf("click")&&(G.onClick=B),-1!==V.indexOf("focus")&&(G.onFocus=H,G.onBlur=W),-1!==V.indexOf("hover")&&(G.onMouseOver=A,G.onMouseOut=U),Object(q.jsxs)(q.Fragment,{children:["function"===typeof o?o(G):Object(s.cloneElement)(o,G),Object(q.jsx)(J,Object(a.a)(Object(a.a)({},y),{},{show:M,onHide:L,flip:x,placement:v,popperConfig:u,target:w.current,children:c}))]})}},61:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));n(1);var a=n(1260),r=n(64),c=n(0),i=function(){return Object(c.jsx)("div",{children:Object(c.jsxs)("div",{className:"d-flex align-items-center",children:[Object(c.jsx)("i",{className:"fa fa-exclamation-triangle fa-2x pt-2 text-danger"}),Object(c.jsxs)("div",{className:"ps-2",children:[Object(c.jsx)("div",{className:"fs-3",children:Object(c.jsx)(a.a,{id:"alert",defaultMessage:"alert"})}),Object(c.jsx)("div",{className:"fs-6",children:Object(c.jsx)(a.a,{id:"maximumQuotaExceeded",defaultMessage:"maximumQuotaExceeded"})})]})]})})},o=function(){return Object(c.jsx)("div",{className:"d-flex align-items-center justify-content-between",children:Object(c.jsxs)("div",{children:[Object(c.jsxs)(r.a,{className:"btn btn-sm btn-primary me-1 rounded-pill",to:"/billing",children:[Object(c.jsx)("i",{className:"fa fa-credit-card-alt pe-1"}),Object(c.jsx)(a.a,{id:"upgradeNow",defaultMessage:"upgradeNow"})]}),Object(c.jsx)("span",{className:"fs-6",children:Object(c.jsx)(a.a,{id:"accessUnlimitedStorage",defaultMessage:"accessUnlimitedStorage"})})]})})}},74:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(6),r=n(5),c=n(7),i=n(8),o=n(1);o.Component;function s(e,t){var n=e;return"left"===e?n=t?"end":"start":"right"===e&&(n=t?"start":"end"),n}},75:function(e,t,n){"use strict";function a(){return{position:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"absolute",top:"0",left:"0",opacity:"0",pointerEvents:"none"}}n.d(t,"a",(function(){return a}))},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(1),r=n(77),c=function(){var e=Object(r.h)().search;return Object(a.useMemo)((function(){return new URLSearchParams(e)}),[e])}},97:function(e,t,n){"use strict";var a=n(25),r=n(27),c=n(28),i=n(34),o=n.n(i),s=n(1),l=n(39),u=n(74),d=n(75),b=n(0),f=["bsPrefix","placement","className","style","children","arrowProps","hasDoneInitialMeasure","popper","show"],j=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.placement,s=void 0===i?"right":i,j=e.className,p=e.style,h=e.children,m=e.arrowProps,O=e.hasDoneInitialMeasure,v=e.popper,g=e.show,x=Object(c.a)(e,f);n=Object(l.c)(n,"tooltip");var y=Object(l.d)(),w=(null==s?void 0:s.split("-"))||[],k=Object(r.a)(w,1)[0],C=Object(u.a)(k,y),N=p;return g&&!O&&(N=Object(a.a)(Object(a.a)({},p),Object(d.a)(null==v?void 0:v.strategy))),Object(b.jsxs)("div",Object(a.a)(Object(a.a)({ref:t,style:N,role:"tooltip","x-placement":k,className:o()(j,n,"bs-tooltip-".concat(C))},x),{},{children:[Object(b.jsx)("div",Object(a.a)({className:"tooltip-arrow"},m)),Object(b.jsx)("div",{className:"".concat(n,"-inner"),children:h})]}))}));j.displayName="Tooltip",t.a=Object.assign(j,{TOOLTIP_OFFSET:[0,6]})}}]);