"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[3314],{6447:(e,s,t)=>{t.d(s,{U:()=>n});t(9950);var l=t(8045),i=t(8989),a=t(4414);function n(e){const{children:s}=e,{attributes:t,listeners:n,setNodeRef:r,transform:d,transition:o}=(0,l.gl)({id:e.id}),c={transform:i.Ks.Transform.toString(d),transition:o};return(0,a.jsx)("div",{ref:r,style:c,...t,...n,children:s})}},3314:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var l=t(9950),i=t(68),a=t(246),n=t(4268),r=t(3302),d=t(7937),o=t(1432),c=t(7956),u=t(9288),m=t(3027),x=t(1576),h=t(2016),b=t(2436),f=t(2581),g=t(3718),j=t(8045),p=t(6447),v=t(4414);const N=e=>{var s,t;const N=(0,u.A)(),k=(0,l.useContext)(i.A),A=(0,l.useContext)(b.R),{sheets:M,setSheets:C,theme:w,activeSheet:y,setActiveSheet:S,setActiveChart:$}=k,{styles:z}=e,I=null===(s=M.filter((e=>e.id===y))[0])||void 0===s?void 0:s.zoom,[L,T]=(0,l.useState)({state:!1,id:null,label:null,source:null}),E=(0,l.useRef)([]);(0,l.useEffect)((()=>{const e=M[0].id;S(e)}),[]);const R=e=>{if(M.length<h.e_.sheetLimit){const s={...e},t=(0,c.A)(),l={id:t,order:M.length,label:`${s.label} (${N.formatMessage({id:"clone",defaultMessage:"clone"})})`.substring(0,15),charts:s.charts,zoom:s.zoom},i=[...M,l];C(i),setTimeout((()=>{S(t)}),[500])}else A.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:N.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},D=e=>{let s=M.findIndex((e=>e.id===y));if(s=e?s+1:s-1,s>-1&&s<M.length){const e=M[s].id;S(e)}};(0,l.useEffect)((()=>{var e;const s=M.findIndex((e=>e.id===y));null===E||void 0===E||null===(e=E.current[s])||void 0===e||e.scrollIntoView({inline:"start"}),$("")}),[y]);const H=e=>{const s=M.map((s=>(s.id===y&&(s.zoom=e),s)));C(s)},_=(0,g.FR)((0,g.MS)(g.AN,{activationConstraint:{distance:5}}),(0,g.MS)(g.IG,{activationConstraint:{distance:5}}),(0,g.MS)(g.uN,{coordinateGetter:j.JR}));return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(x.A,{show:L.state&&"delete"===L.source,confirmationstring:N.formatMessage({id:"areYouSureToDeleteSheet",defaultMessage:"areYouSureToDeleteSheet"}),handleHide:()=>{T((e=>({...e,state:!1,id:null,label:null,source:null})))},handleYes:()=>(()=>{const e=L.id,s=M.filter((s=>s.id!==e));C(s),S((()=>s[0].id)),T((e=>({...e,state:!1,id:null,label:null,source:null})))})(),size:"md"}),(0,v.jsxs)(n.A,{...e,style:{zIndex:1e4},show:L.state&&"rename"===L.source,onHide:()=>T((e=>({...e,state:!1,id:null,label:null,source:null}))),size:"sm",animation:!1,centered:!0,backdrop:"static",children:[(0,v.jsx)(n.A.Header,{children:(0,v.jsx)(n.A.Title,{children:(0,v.jsx)(m.A,{id:"rename",defaultMessage:"rename"})})}),(0,v.jsxs)(n.A.Body,{className:"container-fluid rounded-bottom "+("dark"===w?"bg-dark text-white":"bg-white text-dark"),children:[(0,v.jsx)(r.A.Control,{type:"text",maxLength:15,placeholder:N.formatMessage({id:"maxLetters",defaultMessage:"maxLetters"},{n:15}),className:"mb-2",onChange:e=>T((s=>({...s,label:e.target.value}))),value:L.label}),(0,v.jsxs)("div",{className:"d-flex",children:[(0,v.jsx)(d.A,{variant:`btn btn-${w} w-50 me-2`,onClick:()=>T((e=>({...e,state:!1,id:null,label:null}))),children:(0,v.jsx)(m.A,{id:"cancel",defaultMessage:"cancel"})}),(0,v.jsx)(d.A,{variant:"btn btn-bni w-50",disabled:!(null!==L&&void 0!==L&&null!==(t=L.label)&&void 0!==t&&t.length),onClick:()=>(()=>{const e=L.id,s=M.map(((s,t)=>s.id===e?{...s,label:L.label}:s));C(s),T((e=>({...e,state:!1,id:null,label:null,source:null})))})(),children:(0,v.jsx)(m.A,{id:"submit",defaultMessage:"submit"})})]})]})]}),(0,v.jsxs)("div",{className:`d-flex justify-content-between border border-1 ${"dark"===w?"border-secondary":""} rounded-bottom border-top-0`,style:{...z},children:[(0,v.jsx)("button",{className:"btn btn-sm btn-bni border-0 px-3",onClick:()=>{if(M.length<h.e_.sheetLimit){const e=(0,c.A)(),s={id:e,order:M.length,label:`${N.formatMessage({id:"sheet",defaultMessage:"sheet"})} ${M.length+1}`,charts:[],zoom:100},t=[...M,s];C(t),setTimeout((()=>{S(e)}),500)}else A.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:N.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},style:{borderRadius:"0px 0px 0px 5px"},children:(0,v.jsx)("i",{className:"fa fa-plus"})}),(0,v.jsx)("button",{onClick:()=>D(0),className:`btn btn-sm btn-${"dark"===w?"dark":"white"} border-0 border-end px-2 rounded-0`,disabled:0===M.findIndex((e=>e.id===y)),children:(0,v.jsx)("i",{className:"fa fa-chevron-left"})}),(0,v.jsx)("div",{className:"d-flex w-75 flex-row overflow-hidden",children:(0,v.jsx)(g.Mp,{sensors:_,collisionDetection:g.fp,onDragEnd:e=>{let{active:s,over:t}=e;if(s.id!==t.id){const e=M.findIndex((e=>{let{id:t}=e;return t===s.id})),l=M.findIndex((e=>{let{id:s}=e;return s===t.id})),i=(0,j.be)(M,e,l);C(i)}},children:(0,v.jsx)(j.gB,{items:M,strategy:j.m$,children:M.map(((e,s)=>{return(0,v.jsx)(p.U,{id:e.id,children:(0,v.jsxs)("div",{className:"cursor-pointer d-flex border-3 align-items-center bg-"+("dark"===w?"dark":"white"),ref:e=>{E.current[s]=e},children:[(0,v.jsx)(o.A,{trigger:"click",placement:"top",overlay:(t=e,(0,v.jsxs)(a.A,{id:"popover-basic",children:[(0,v.jsx)(a.A.Header,{as:"div",className:"bni-bg bni-text",children:(0,v.jsx)(m.A,{id:"action",defaultMessage:"action"})}),(0,v.jsx)(a.A.Body,{className:"p-0",children:(0,v.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,v.jsx)("li",{className:"list-group-item cursor-pointer",onClick:()=>T((e=>({...e,state:!0,id:t.id,label:t.label,source:"rename"}))),children:(0,v.jsx)(m.A,{id:"rename",defaultMessage:"rename"})}),M.length>1&&(0,v.jsx)("li",{className:"list-group-item cursor-pointer text-danger",onClick:()=>T((e=>({...e,state:!0,id:t.id,label:t.label,source:"delete"}))),children:(0,v.jsx)(m.A,{id:"delete",defaultMessage:"delete"})}),(0,v.jsx)("li",{onClick:()=>R(t),className:"list-group-item cursor-pointer rounded-bottom",children:(0,v.jsx)(m.A,{id:"clone",defaultMessage:"clone"})})]})})]})),rootClose:!0,children:(0,v.jsx)("i",{className:"fa fa-cog px-2"})}),(0,v.jsx)("div",{style:{minWidth:130},className:`rounded-0 btn btn-sm btn-${y===e.id?"bni":w} border-0 border-end ${"dark"===w?"border-secondary":""}`,onClick:()=>S(e.id),children:e.label})]})},e.id);var t}))})})}),(0,v.jsx)("button",{onClick:()=>D(1),className:`btn btn-sm btn-${"dark"===w?"dark":"white"} border-0 border-0 border-start border-end px-2 rounded-0`,disabled:M.findIndex((e=>e.id===y))===M.length-1,children:(0,v.jsx)("i",{className:"fa fa-chevron-right"})}),(0,v.jsxs)("div",{className:"d-flex align-items-center",children:[(0,v.jsx)("div",{className:"px-1",children:(0,v.jsx)("i",{className:"fa fa-minus cursor-pointer",onClick:()=>I<=200&&I>100&&H(I-1)})}),(0,v.jsx)("div",{className:"",style:{width:"150px"},children:(0,v.jsx)(f.A,{min:100,max:200,value:I,step:1,orientation:"horizontal",onChange:e=>H(e),tooltip:!1})}),(0,v.jsx)("div",{className:"px-1",children:(0,v.jsx)("i",{className:"fa fa-plus cursor-pointer",onClick:()=>I<200&&I>=100&&H(I+1)})}),(0,v.jsxs)("div",{className:"px-1 w-50px",children:[I,"%"]})]})]})]})}}}]);