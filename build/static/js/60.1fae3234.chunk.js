(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[60],{1103:function(e,t,a){"use strict";a.r(t);var n=a(25),c=a(29),s=a(35),r=a(27),o=a(1),i=a.n(o),d=a(132),l=a(1265),u=a(1263),b=a(933),f=a(47),p=a(71),m=a(38),j=a(67),g=a(777),h=a(1260),O=a(120),x=a.n(O),D=a(51),M=a.n(D),C=a(52),y=a.n(C),w=a(48),v=a(92),T=a(82),_=a(108),S=a(73),I=a(61),R=a(65),N=a(328),P=a(0),k=i.a.createContext(void 0);t.default=function(){var e,t=Object(g.a)(),a=Object(o.useContext)(p.a);document.title="".concat(a.appName," - ").concat(t.formatMessage({id:"creditCard",defaultMessage:"creditCard"}));var i=Object(o.useContext)(m.a),O=Object(o.useContext)(S.a),D=Object(o.useContext)(R.a),C=Object(o.useState)(!1),E=Object(r.a)(C,2),A=E[0],F=E[1],V=Object(o.useState)(!1),Y=Object(r.a)(V,2),L=Y[0],H=Y[1],J=Object(o.useState)(!0),K=Object(r.a)(J,2),W=K[0],B=K[1],U=Object(o.useState)({}),G=Object(r.a)(U,2),q=G[0],z=G[1],Q=Object(o.useState)({creditCard:"",startDate:M()().startOf("month").toDate(),endDate:M()().endOf("month").toDate()}),X=Object(r.a)(Q,2),Z=X[0],$=X[1],ee=Object(o.useState)({}),te=Object(r.a)(ee,2),ae=te[0],ne=te[1],ce={start:0,limit:10,searchString:""},se=Object(o.useState)(ce),re=Object(r.a)(se,2),oe=re[0],ie=re[1],de=Object(o.useState)(ce),le=Object(r.a)(de,2),ue=le[0],be=le[1],fe={config:{header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:t.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"cCTable",Table:"creditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[t.formatMessage({id:"name",defaultMessage:"name"}),t.formatMessage({id:"date",defaultMessage:"date"}),t.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),t.formatMessage({id:"credits",defaultMessage:"credits"}),t.formatMessage({id:"purchases",defaultMessage:"purchases"}),t.formatMessage({id:"interest",defaultMessage:"interest"}),t.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},pe=function(){var e=Object(s.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),(t=new FormData).append("appId",i.userConfig.appId),e.abrupt("return",f.a.post("/account_planner/credit_card_list",t).then((function(e){z(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return B(!1)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(e){H(!0),ne({}),setTimeout((function(){var t=function(){var e=new FormData;return e.append("limit",ue.limit),e.append("start",ue.start),e.append("searchString",ue.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","creditCardTrx"),e.append("WhereClause","a.cc_appId = '".concat(i.userConfig.appId,"' && a.cc_for_card = '").concat(Z.creditCard,"' && d.credit_card_appId = '").concat(i.userConfig.appId,"' && a.cc_date >= '").concat(M()(Z.startDate).format("YYYY-MM-DD").toString(),"' && a.cc_date <= '").concat(M()(Z.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([t]).then((function(t){ne(t[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){H(!1),F(!0)}))}),100)};Object(o.useEffect)((function(){pe()}),[]);Object(o.useEffect)((function(){Ie()}),[oe]);var je=Object(T.a)(),ge={fetch:je.get("fetch"),creditCardId:je.get("creditCardId"),startDate:je.get("startDate"),endDate:je.get("endDate")},he=Object(o.useState)(!1),Oe=Object(r.a)(he,2),xe=Oe[0],De=Oe[1];Object(o.useEffect)((function(){"creditCard"===ge.fetch&&ge.creditCardId&&(De(!0),$((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:ge.creditCardId,startDate:M()(ge.startDate).toDate(),endDate:M()(ge.endDate).toDate()})})),be(ce))}),[JSON.stringify(ge)]),Object(o.useEffect)((function(){"creditCard"===ge.fetch&&Z.creditCard&&Z.startDate&&Z.endDate&&xe&&me((function(){De(!1),setTimeout((function(){var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(ge),Z.creditCard,xe]);var Me=function(){return Object(P.jsx)("div",{className:"relativeSpinner",children:Object(P.jsx)(y.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},Ce=["id","name","last4DigitCardNo","startDate","endDate","payDate","annuaInterestRate","localeLanguage","localeCurrency"],ye=["checkbox","textbox","textbox","number","number","number","number",{fetch:{dropDownList:N.c},searchable:!0},{fetch:{dropDownList:N.b},searchable:!0}],we=_.b.filter((function(e){return"creditCardAccounts"===e.id})).map((function(e){var a={header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:O.localeLanguage,currency:O.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=a,e.TableAliasRows=Ce.map((function(e){return t.formatMessage({id:e,defaultMessage:e})})),e.rowElements=ye,e}))[0],ve=Object(o.useState)([]),Te=Object(r.a)(ve,2),_e=Te[0],Se=Te[1],Ie=function(){Se([]);var e=function(e,t){var a=new FormData;return a.append("TableRows",t),a.append("Table",e),a.append("limit",oe.limit),a.append("start",oe.start),a.append("searchString",oe.searchString),a.append("appId",i.userConfig.appId),f.a.post("/account_planner/getAccountPlanner",a)}(we.Table,we.TableRows);Promise.all([e]).then(function(){var e=Object(s.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se(t[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(o.useEffect)((function(){A&&me()}),[ue,A]),Object(P.jsx)(k.Provider,{value:{cCList:q,selection:Z},children:Object(P.jsxs)(l.a,{fluid:!0,className:"pb-5",children:[Object(P.jsx)(d.a,{icon:"fa fa-credit-card",intlId:"creditCard"}),W?Object(P.jsx)(Me,{}):Object(P.jsxs)(P.Fragment,{children:[_e&&(null===(e=Object.keys(_e))||void 0===e?void 0:e.length)>0&&Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(v.a,{className:"pt-3",config:we.config,Table:we.Table,TableRows:we.TableRows,TableAliasRows:we.TableAliasRows,rowElements:we.rowElements,defaultValues:we.defaultValues,dbData:_e,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,a){var n=e.status,c=e.data;if(200===n){if(e&&c&&"boolean"===typeof c.response&&null!==c.response&&c.response&&i.renderToast({message:t.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&c&&"boolean"===typeof c.response&&null!==c.response&&!1===c.response&&i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&c&&null===c.response&&D.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(P.jsx)(I.b,{}),content:Object(P.jsx)(I.a,{})}),e&&c&&"object"===typeof c.response&&null!==c.response){var s;s=1451===c.response.number?"foreignKeyDeleteMessage":"",i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:s,defaultMessage:s})})}}else i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,we.id)},apiParams:oe,onChangeParams:function(e){return function(e){ie((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)},onReFetchData:function(){return Ie()},cellWidth:we.cellWidth,ajaxButtonName:t.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"credit_card_appId",value:i.userConfig.appId},theme:i.userData.theme})}),Object(P.jsxs)(u.a,{className:"align-items-center ".concat(!Object.keys(ae).length>0?"pb-5":""),children:[Object(P.jsx)(b.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(P.jsx)(j.a,{placeholder:"".concat(t.formatMessage({id:"select",defaultMessage:"select"})," ").concat(t.formatMessage({id:"creditCard",defaultMessage:"creditCard"})),onChange:function(e,t,a){$((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:t})}))},element:{fetch:{dropDownList:q.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Z.creditCard,type:"single",searchable:!0,theme:i.userData.theme})}),Object(P.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(P.jsx)("span",{children:Object(P.jsx)(h.a,{id:"startDate",defaultMessage:"startDate"})}),Object(P.jsx)(x.a,{className:"bg-white text-dark",value:Z.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(t){return Object(n.a)(Object(n.a)({},t),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(P.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(P.jsx)("span",{children:Object(P.jsx)(h.a,{id:"endDate",defaultMessage:"endDate"})}),Object(P.jsx)(x.a,{className:"bg-white text-dark",value:Z.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(t){return Object(n.a)(Object(n.a)({},t),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(P.jsx)(b.a,{sm:3,className:"pb-2",children:Object(P.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return me()},disabled:!Z.creditCard,children:Object(P.jsx)(h.a,{id:"generate",defaultMessage:"generate"})})})]})]}),L&&Object(P.jsx)(Me,{}),ae&&Object.keys(ae).length>0&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"py-2",children:Object(P.jsx)("span",{className:"badge ".concat("dark"===i.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:t.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),Object(P.jsx)(v.a,{id:fe.id,config:fe.config,Table:fe.Table,TableRows:fe.TableRows,TableAliasRows:fe.TableAliasRows,rowElements:fe.rowElements,defaultValues:fe.defaultValues,dbData:ae,cellWidth:[20,10,10,10,10,10,10],theme:i.userData.theme,apiParams:ue,onChangeParams:function(e){return function(e){be((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)}})]}),0===Object.keys(ae).length&&A&&!L&&Object(P.jsx)("div",{className:"text-center py-2",children:Object(P.jsx)(h.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},82:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(1),c=a(77),s=function(){var e=Object(c.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);