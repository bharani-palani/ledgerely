(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[70],{1188:function(e,t,n){"use strict";n.r(t);var a=n(42),c=n(25),r=n(27),i=n(1),s=n(86),l=n(1253),o=n(1290),d=n(1287),u=n(938),b=n(1293),j=n(265),f=n.n(j),x=n(376),m=n(1292),O=n(779),h=n(1269),g=n(234),p=n(41),v=n(39),k=n(0);t.default=function(e){var t,n,j=Object(O.a)(),N=Object(i.useContext)(s.a),w=Object(i.useContext)(v.a),M=N.sheets,C=N.setSheets,y=N.theme,S=N.activeSheet,z=N.setActiveSheet,L=N.setActiveChart,I=e.styles,E=null===(t=M.filter((function(e){return e.id===S}))[0])||void 0===t?void 0:t.zoom,T=Object(i.useState)({state:!1,id:null,label:null,source:null}),H=Object(r.a)(T,2),Y=H[0],A=H[1],D=Object(i.useRef)([]),R=Object(i.useRef)(null);Object(i.useEffect)((function(){var e=M[0].id;z(e)}),[]);var B=Object(x.b)((function(e){var t=e.children;return Object(k.jsx)("div",{className:"d-flex noScroll",style:{width:"100%",overflowX:"auto",overflowY:"hidden"},ref:R,children:t})})),J=function(e){if(M.length<p.c.sheetLimit){var t=Object(c.a)({},e),n=Object(m.a)(),r={id:n,order:M.length,label:"".concat(t.label," (").concat(j.formatMessage({id:"clone",defaultMessage:"clone"}),")").substring(0,15),charts:t.charts,zoom:t.zoom},i=[].concat(Object(a.a)(M),[r]);C(i),setTimeout((function(){z(n)}),[500])}else w.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:j.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},F=function(e){var t=M.findIndex((function(e){return e.id===S}));if((t=e?t+1:t-1)>-1&&t<M.length){var n=M[t].id;z(n)}};Object(i.useEffect)((function(){var e,t=M.findIndex((function(e){return e.id===S}));null===D||void 0===D||null===(e=D.current[t])||void 0===e||e.scrollIntoView({inline:"start"}),L("")}),[S]);var V=function(e){var t=M.map((function(t){return t.id===S&&(t.zoom=e),t}));C(t)};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(g.a,{show:Y.state&&"delete"===Y.source,confirmationstring:j.formatMessage({id:"areYouSureToDeleteSheet",defaultMessage:"areYouSureToDeleteSheet"}),handleHide:function(){A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!1,id:null,label:null,source:null})}))},handleYes:function(){return function(){var e=Y.id,t=M.filter((function(t){return t.id!==e}));C(t),z((function(){return t[0].id})),A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!1,id:null,label:null,source:null})}))}()},size:"md"}),Object(k.jsxs)(o.a,Object(c.a)(Object(c.a)({},e),{},{style:{zIndex:9999},show:Y.state&&"rename"===Y.source,onHide:function(){return A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!1,id:null,label:null,source:null})}))},size:"sm",animation:!1,centered:!0,backdrop:"static",children:[Object(k.jsx)(o.a.Header,{children:Object(k.jsx)(o.a.Title,{children:Object(k.jsx)(h.a,{id:"rename",defaultMessage:"rename"})})}),Object(k.jsxs)(o.a.Body,{className:"container-fluid rounded-bottom ".concat("dark"===y?"bg-dark text-white":"bg-white text-dark"),children:[Object(k.jsx)(d.a.Control,{type:"text",maxLength:15,placeholder:j.formatMessage({id:"maxLetters",defaultMessage:"maxLetters"},{n:15}),className:"mb-2",onChange:function(e){return A((function(t){return Object(c.a)(Object(c.a)({},t),{},{label:e.target.value})}))},value:Y.label}),Object(k.jsxs)("div",{className:"d-flex",children:[Object(k.jsx)(u.a,{variant:"btn btn-".concat(y," w-50 me-2"),onClick:function(){return A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!1,id:null,label:null})}))},children:Object(k.jsx)(h.a,{id:"cancel",defaultMessage:"cancel"})}),Object(k.jsx)(u.a,{variant:"btn btn-bni w-50",disabled:!(null!==Y&&void 0!==Y&&null!==(n=Y.label)&&void 0!==n&&n.length),onClick:function(){return function(){var e=Y.id,t=M.map((function(t,n){return t.id===e?Object(c.a)(Object(c.a)({},t),{},{label:Y.label}):t}));C(t),A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!1,id:null,label:null,source:null})}))}()},children:Object(k.jsx)(h.a,{id:"submit",defaultMessage:"submit"})})]})]})]})),Object(k.jsxs)("div",{className:"d-flex border border-1 ".concat("dark"===y?"border-secondary":""," rounded-bottom border-top-0"),style:Object(c.a)({},I),children:[Object(k.jsx)("button",{className:"btn btn-sm btn-bni border-0 px-3",onClick:function(){if(M.length<p.c.sheetLimit){var e=Object(m.a)(),t={id:e,order:M.length,label:"".concat(j.formatMessage({id:"sheet",defaultMessage:"sheet"})," ").concat(M.length+1),charts:[],zoom:100},n=[].concat(Object(a.a)(M),[t]);C(n),setTimeout((function(){z(e)}),500)}else w.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:j.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},style:{borderRadius:"0px 0px 0px 5px"},children:Object(k.jsx)("i",{className:"fa fa-plus"})}),Object(k.jsx)("button",{onClick:function(){return F(0)},className:"btn btn-sm btn-".concat("dark"===y?"dark":"white"," border-0 border-end px-2 rounded-0"),disabled:0===M.findIndex((function(e){return e.id===S})),children:Object(k.jsx)("i",{className:"fa fa-chevron-left"})}),Object(k.jsx)(B,{pressDelay:200,onSortEnd:function(e){var t=e.oldIndex,n=e.newIndex,a=Object(x.a)(M,t,n);C(a)},lockAxis:"x",axis:"x",children:M.map((function(e,t){var n=Object(x.c)((function(){return Object(k.jsxs)("div",{className:"cursor-pointer d-flex border-3 align-items-center bg-".concat("dark"===y?"dark":"white"),ref:function(e){D.current[t]=e},children:[Object(k.jsx)(b.a,{trigger:"click",placement:"top",overlay:(n=e,Object(k.jsxs)(l.a,{id:"popover-basic",children:[Object(k.jsx)(l.a.Header,{as:"div",className:"bni-bg bni-text",children:Object(k.jsx)(h.a,{id:"action",defaultMessage:"action"})}),Object(k.jsx)(l.a.Body,{className:"p-0",children:Object(k.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(k.jsx)("li",{className:"list-group-item cursor-pointer",onClick:function(){return A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!0,id:n.id,label:n.label,source:"rename"})}))},children:Object(k.jsx)(h.a,{id:"rename",defaultMessage:"rename"})}),M.length>1&&Object(k.jsx)("li",{className:"list-group-item cursor-pointer text-danger",onClick:function(){return A((function(e){return Object(c.a)(Object(c.a)({},e),{},{state:!0,id:n.id,label:n.label,source:"delete"})}))},children:Object(k.jsx)(h.a,{id:"delete",defaultMessage:"delete"})}),Object(k.jsx)("li",{onClick:function(){return J(n)},className:"list-group-item cursor-pointer rounded-bottom",children:Object(k.jsx)(h.a,{id:"clone",defaultMessage:"clone"})})]})})]})),rootClose:!0,children:Object(k.jsx)("i",{className:"fa fa-cog px-2"})}),Object(k.jsx)("div",{style:{minWidth:130},className:"rounded-0 btn btn-sm btn-".concat(S===e.id?"bni":y," border-0 border-end ").concat("dark"===y?"border-secondary":""),onClick:function(){return z(e.id)},children:e.label})]});var n}));return Object(k.jsx)(n,{index:t},e.id)}))}),Object(k.jsx)("button",{onClick:function(){return F(1)},className:"btn btn-sm btn-".concat("dark"===y?"dark":"white"," border-0 border-0 border-start border-end px-2 rounded-0"),disabled:M.findIndex((function(e){return e.id===S}))===M.length-1,children:Object(k.jsx)("i",{className:"fa fa-chevron-right"})}),Object(k.jsxs)("div",{className:"d-flex align-items-center",children:[Object(k.jsx)("div",{className:"px-1",children:Object(k.jsx)("i",{className:"fa fa-minus cursor-pointer",onClick:function(){return E<=200&&E>100&&V(E-1)}})}),Object(k.jsx)("div",{className:"",style:{width:"150px"},children:Object(k.jsx)(f.a,{min:100,max:200,value:E,step:1,orientation:"horizontal",onChange:function(e){return V(e)},tooltip:!1})}),Object(k.jsx)("div",{className:"px-1",children:Object(k.jsx)("i",{className:"fa fa-plus cursor-pointer",onClick:function(){return E<200&&E>=100&&V(E+1)}})}),Object(k.jsxs)("div",{className:"px-1 w-50px",children:[E,"%"]})]})]})]})}}}]);