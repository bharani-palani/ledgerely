(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[59],{1101:function(e,a,t){"use strict";t.r(a);var n=t(25),s=t(29),c=t(35),r=t(27),o=t(1),i=t.n(o),l=t(132),d=t(1265),u=t(1263),b=t(933),f=t(47),g=t(71),p=t(38),m=t(67),j=t(777),h=t(1260),O=t(120),x=t.n(O),M=t(51),y=t.n(M),_=t(52),D=t.n(_),w=t(48),T=t(92),v=t(82),C=t(108),S=t(73),k=t(61),R=t(65),I=t(0),P=i.a.createContext(void 0);a.default=function(){var e=Object(j.a)(),a=Object(o.useContext)(g.a);document.title="".concat(a.appName," - ").concat(e.formatMessage({id:"category",defaultMessage:"category"}));var t=Object(o.useContext)(p.a),i=Object(o.useContext)(S.a),O=Object(o.useContext)(R.a),M=Object(o.useState)(!1),_=Object(r.a)(M,2),N=_[0],E=_[1],Y=Object(o.useState)(!1),A=Object(r.a)(Y,2),F=A[0],V=A[1],z=Object(o.useState)(!0),B=Object(r.a)(z,2),H=B[0],L=B[1],W=Object(o.useState)([]),J=Object(r.a)(W,2),K=J[0],U=J[1],G=Object(o.useState)({category:"",startDate:y()().startOf("month").toDate(),endDate:y()().endOf("month").toDate()}),q=Object(r.a)(G,2),Q=q[0],X=q[1],Z=Object(o.useState)([]),$=Object(r.a)(Z,2),ee=$[0],ae=$[1],te=Object(o.useState)([]),ne=Object(r.a)(te,2),se=ne[0],ce=ne[1],re={start:0,limit:10,searchString:""},oe=Object(o.useState)(re),ie=Object(r.a)(oe,2),le=ie[0],de=ie[1],ue=Object(o.useState)(re),be=Object(r.a)(ue,2),fe=be[0],ge=be[1],pe=Object(o.useState)(re),me=Object(r.a)(pe,2),je=me[0],he=me[1],Oe={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"categorizedBankTrx",Table:"categorizedBankTrx",label:"Categorized bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"amount",defaultMessage:"amount"}),e.formatMessage({id:"type",defaultMessage:"type"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},xe={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"catCreditCardTrx",Table:"categorizedCreditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),e.formatMessage({id:"credits",defaultMessage:"credits"}),e.formatMessage({id:"purchases",defaultMessage:"purchases"}),e.formatMessage({id:"interest",defaultMessage:"interest"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},Me=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){var a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),(a=new FormData).append("limit",le.limit),a.append("start",le.start),a.append("searchString",le.searchString),a.append("appId",t.userConfig.appId),e.abrupt("return",f.a.post("/account_planner/inc_exp_list",a).then((function(e){return U(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return L(!1)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(e){V(!0),ae([]),ce([]),setTimeout((function(){var a=function(){var e=new FormData;return e.append("limit",fe.limit),e.append("start",fe.start),e.append("searchString",fe.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","categorizedBankTrx"),e.append("WhereClause","a.inc_exp_appId = '".concat(t.userConfig.appId,"' && b.inc_exp_cat_id = '").concat(Q.category,"' && d.bank_appId = '").concat(t.userConfig.appId,"' && a.inc_exp_date >= '").concat(y()(Q.startDate).format("YYYY-MM-DD").toString(),"' && a.inc_exp_date <= '").concat(y()(Q.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}(),n=function(){var e=new FormData;return e.append("limit",je.limit),e.append("start",je.start),e.append("searchString",je.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","categorizedCreditCardTrx"),e.append("WhereClause","a.cc_appId = '".concat(t.userConfig.appId,"' && b.inc_exp_cat_id = '").concat(Q.category,"' && d.credit_card_appId = '").concat(t.userConfig.appId,"' && a.cc_date >= '").concat(y()(Q.startDate).format("YYYY-MM-DD").toString(),"' && a.cc_date <= '").concat(y()(Q.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([a,n]).then((function(a){var t=a[0].data.response,n=a[1].data.response;ae(t),ce(n);var s=(null===t||void 0===t?void 0:t.table.length)>0?"bank":"creditCard";"function"===typeof e&&e(s)})).catch((function(e){return console.log("bbb",e)})).finally((function(){V(!1),E(!0)}))}),100)};Object(o.useEffect)((function(){Me()}),[le]);var _e=Object(v.a)(),De={fetch:_e.get("fetch"),categoryId:_e.get("categoryId"),startDate:_e.get("startDate"),endDate:_e.get("endDate")},we=Object(o.useState)(!1),Te=Object(r.a)(we,2),ve=Te[0],Ce=Te[1];Object(o.useEffect)((function(){"category"===De.fetch&&De.categoryId&&(Ce(!0),X((function(e){return Object(n.a)(Object(n.a)({},e),{},{category:De.categoryId,startDate:y()(De.startDate).toDate(),endDate:y()(De.endDate).toDate()})})))}),[JSON.stringify(De)]),Object(o.useEffect)((function(){"category"===De.fetch&&Q.category&&Q.startDate&&Q.endDate&&ve&&ye((function(e){Ce(!1),setTimeout((function(){var a,t="bank"===e?"categorizedBankTrx":"catCreditCardTrx";null===(a=document.getElementById(t))||void 0===a||a.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),1e3)}))}),[JSON.stringify(De),Q.category,ve]);var Se=function(){return Object(I.jsx)("div",{className:"relativeSpinner",children:Object(I.jsx)(D.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},ke=["id","name","isIncomeMetric","isPlanMetric"],Re=["checkbox","textbox",{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}},{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}}],Ie=C.b.filter((function(e){return"incExpCat"===e.id})).map((function(a){var t={header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:i.localeLanguage,currency:i.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return a.config=t,a.TableAliasRows=ke.map((function(a){return e.formatMessage({id:a,defaultMessage:a})})),a.rowElements=Re,a}))[0],Pe=Object(o.useState)([]),Ne=Object(r.a)(Pe,2),Ee=Ne[0],Ye=Ne[1],Ae=function(){Ye([]);var e=function(e,a){var n=new FormData;return n.append("TableRows",a),n.append("Table",e),n.append("limit",le.limit),n.append("start",le.start),n.append("searchString",le.searchString),n.append("appId",t.userConfig.appId),f.a.post("/account_planner/getAccountPlanner",n)}(Ie.Table,Ie.TableRows);Promise.all([e]).then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(a){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ye(a[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())};Object(o.useEffect)((function(){Ae()}),[le]);return Object(o.useEffect)((function(){N&&ye()}),[fe,je,N]),Object(I.jsx)(P.Provider,{value:{incExpList:K,selection:Q},children:Object(I.jsxs)(d.a,{fluid:!0,children:[Object(I.jsx)(l.a,{icon:"fa fa-sitemap",intlId:"category"}),H?Object(I.jsx)(Se,{}):Object(I.jsxs)(I.Fragment,{children:[Ee&&Object.keys(Ee).length>0&&Object(I.jsx)(I.Fragment,{children:Object(I.jsx)(T.a,{className:"pt-3",config:Ie.config,Table:Ie.Table,TableRows:Ie.TableRows,TableAliasRows:Ie.TableAliasRows,rowElements:Ie.rowElements,defaultValues:Ie.defaultValues,dbData:Ee,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(a){return function(a,n){var s=a.status,c=a.data;if(200===s){if(a&&c&&"boolean"===typeof c.response&&null!==c.response&&c.response&&t.renderToast({message:e.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),a&&c&&"boolean"===typeof c.response&&null!==c.response&&!1===c.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),a&&c&&null===c.response&&O.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(I.jsx)(k.b,{}),content:Object(I.jsx)(k.a,{})}),a&&c&&"object"===typeof c.response&&null!==c.response){var r;r=1451===c.response.number?"foreignKeyDeleteMessage":"",t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:r,defaultMessage:r})})}}else t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(a,Ie.id)},apiParams:le,onChangeParams:function(e){return function(e){de((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)},onReFetchData:function(){return Ae()},cellWidth:Ie.cellWidth,ajaxButtonName:e.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"inc_exp_cat_appId",value:t.userConfig.appId},theme:t.userData.theme})}),Object(I.jsxs)(u.a,{className:"align-items-center ".concat(Object.keys(ee).length>0||Object.keys(se).length>0?"":"pb-5"),children:[Object(I.jsx)(b.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(I.jsx)(m.a,{placeholder:"".concat(e.formatMessage({id:"select",defaultMessage:"select"})," ").concat(e.formatMessage({id:"category",defaultMessage:"category"})),onChange:function(e,a,t){X((function(e){return Object(n.a)(Object(n.a)({},e),{},{category:a})}))},element:{fetch:{dropDownList:K.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Q.category,type:"single",searchable:!0,theme:t.userData.theme})}),Object(I.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(I.jsx)("span",{children:Object(I.jsx)(h.a,{id:"startDate",defaultMessage:"startDate"})}),Object(I.jsx)(x.a,{className:"bg-white text-dark",value:Q.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(I.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(I.jsx)("span",{children:Object(I.jsx)(h.a,{id:"endDate",defaultMessage:"endDate"})}),Object(I.jsx)(x.a,{className:"bg-white text-dark",value:Q.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(I.jsx)(b.a,{sm:3,className:"pb-2",children:Object(I.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return ye()},disabled:F||!Q.category,children:Object(I.jsx)(h.a,{id:"generate",defaultMessage:"generate"})})})]})]}),F&&Object(I.jsx)(Se,{}),ee&&Object.keys(ee).length>0&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"py-2",children:Object(I.jsx)("span",{className:"badge ".concat("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),Object(I.jsx)(T.a,{id:Oe.id,config:Oe.config,Table:Oe.Table,TableRows:Oe.TableRows,TableAliasRows:Oe.TableAliasRows,rowElements:Oe.rowElements,defaultValues:Oe.defaultValues,dbData:ee,cellWidth:[20,7,10,5,20],theme:t.userData.theme,apiParams:fe,onChangeParams:function(e){return function(e){ge((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)}})]}),se&&Object.keys(se).length>0>0&&Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"py-2",children:Object(I.jsx)("span",{className:"badge ".concat("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),Object(I.jsx)(T.a,{id:xe.id,config:xe.config,Table:xe.Table,TableRows:xe.TableRows,TableAliasRows:xe.TableAliasRows,rowElements:xe.rowElements,defaultValues:xe.defaultValues,dbData:se,cellWidth:[20,7,10,10,10,10,20],theme:t.userData.theme,apiParams:je,onChangeParams:function(e){return function(e){he((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)}})]}),0===Object.keys(se).length&&0===Object.keys(ee).length&&N&&Object(I.jsx)("div",{className:"text-center py-2",children:Object(I.jsx)(h.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},82:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(1),s=t(77),c=function(){var e=Object(s.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);