(this["webpackJsonpledgerely.com"]=this["webpackJsonpledgerely.com"]||[]).push([[60],{1083:function(e,t,a){"use strict";a.r(t);var n=a(25),c=a(28),r=a(29),s=a(26),o=a(1),i=a.n(o),d=a(137),l=a(1248),u=a(1246),f=a(902),b=a(49),m=a(74),p=a(41),g=a(70),j=a(785),h=a(1243),O=a(126),x=a.n(O),D=a(53),M=a.n(D),y=a(55),C=a.n(y),w=a(50),v=a(98),T=a(86),_=a(113),S=a(75),I=a(63),R=a(68),N=a(333),P=a(0),k=i.a.createContext(void 0);t.default=function(){var e,t=Object(j.a)(),a=Object(o.useContext)(m.a);document.title="".concat(a.appName," - ").concat(t.formatMessage({id:"creditCard",defaultMessage:"creditCard"}));var i=Object(o.useContext)(p.a),O=Object(o.useContext)(S.a),D=Object(o.useContext)(R.a),y=Object(o.useState)(!1),E=Object(s.a)(y,2),A=E[0],F=E[1],V=Object(o.useState)(!1),Y=Object(s.a)(V,2),L=Y[0],H=Y[1],J=Object(o.useState)(!0),K=Object(s.a)(J,2),W=K[0],B=K[1],U=Object(o.useState)({}),G=Object(s.a)(U,2),q=G[0],z=G[1],Q=Object(o.useState)({creditCard:"",startDate:M()().startOf("month").toDate(),endDate:M()().endOf("month").toDate()}),X=Object(s.a)(Q,2),Z=X[0],$=X[1],ee=Object(o.useState)({}),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],ce={start:0,limit:10,searchString:""},re=Object(o.useState)(ce),se=Object(s.a)(re,2),oe=se[0],ie=se[1],de=Object(o.useState)(ce),le=Object(s.a)(de,2),ue=le[0],fe=le[1],be={config:{header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:t.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"cCTable",Table:"creditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[t.formatMessage({id:"name",defaultMessage:"name"}),t.formatMessage({id:"date",defaultMessage:"date"}),t.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),t.formatMessage({id:"credits",defaultMessage:"credits"}),t.formatMessage({id:"purchases",defaultMessage:"purchases"}),t.formatMessage({id:"interest",defaultMessage:"interest"}),t.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},me=function(){var e=Object(r.a)(Object(c.a)().mark((function e(){var t;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),(t=new FormData).append("appId",i.userConfig.appId),e.abrupt("return",b.a.post("/account_planner/credit_card_list",t).then((function(e){z(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return B(!1)})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(e){H(!0),ne({}),setTimeout((function(){var t=function(){var e=new FormData;return e.append("limit",ue.limit),e.append("start",ue.start),e.append("searchString",ue.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","creditCardTrx"),e.append("WhereClause","a.cc_appId = '".concat(i.userConfig.appId,"' && a.cc_for_card = '").concat(Z.creditCard,"' && d.credit_card_appId = '").concat(i.userConfig.appId,"' && a.cc_date >= '").concat(M()(Z.startDate).format("YYYY-MM-DD").toString(),"' && a.cc_date <= '").concat(M()(Z.endDate).format("YYYY-MM-DD").toString(),"'")),b.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([t]).then((function(t){ne(t[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){H(!1),F(!0)}))}),100)};Object(o.useEffect)((function(){me()}),[]);Object(o.useEffect)((function(){Ie()}),[oe]);var ge=Object(T.a)(),je={fetch:ge.get("fetch"),creditCardId:ge.get("creditCardId"),startDate:ge.get("startDate"),endDate:ge.get("endDate")},he=Object(o.useState)(!1),Oe=Object(s.a)(he,2),xe=Oe[0],De=Oe[1];Object(o.useEffect)((function(){"creditCard"===je.fetch&&je.creditCardId&&(De(!0),$((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:je.creditCardId,startDate:M()(je.startDate).toDate(),endDate:M()(je.endDate).toDate()})})),fe(ce))}),[JSON.stringify(je)]),Object(o.useEffect)((function(){"creditCard"===je.fetch&&Z.creditCard&&Z.startDate&&Z.endDate&&xe&&pe((function(){De(!1),setTimeout((function(){var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(je),Z.creditCard,xe]);var Me=function(){return Object(P.jsx)("div",{className:"relativeSpinner",children:Object(P.jsx)(C.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},ye=["id","name","last4DigitCardNo","startDate","endDate","payDate","annuaInterestRate","localeLanguage","localeCurrency"],Ce=["checkbox","textbox","textbox","number","number","number","number",{fetch:{dropDownList:N.c},searchable:!0},{fetch:{dropDownList:N.b},searchable:!0}],we=_.b.filter((function(e){return"creditCardAccounts"===e.id})).map((function(e){var a={header:{searchPlaceholder:t.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:O.localeLanguage,currency:O.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=a,e.TableAliasRows=ye.map((function(e){return t.formatMessage({id:e,defaultMessage:e})})),e.rowElements=Ce,e}))[0],ve=Object(o.useState)([]),Te=Object(s.a)(ve,2),_e=Te[0],Se=Te[1],Ie=function(){Se([]);var e=function(e,t){var a=new FormData;return a.append("TableRows",t),a.append("Table",e),a.append("limit",oe.limit),a.append("start",oe.start),a.append("searchString",oe.searchString),a.append("appId",i.userConfig.appId),b.a.post("/account_planner/getAccountPlanner",a)}(we.Table,we.TableRows);Promise.all([e]).then(function(){var e=Object(r.a)(Object(c.a)().mark((function e(t){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se(t[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(o.useEffect)((function(){A&&pe()}),[ue,A]),Object(P.jsx)(k.Provider,{value:{cCList:q,selection:Z},children:Object(P.jsxs)(l.a,{fluid:!0,className:"pb-5",children:[Object(P.jsx)(d.a,{icon:"fa fa-credit-card",intlId:"creditCard"}),W?Object(P.jsx)(Me,{}):Object(P.jsxs)(P.Fragment,{children:[_e&&(null===(e=Object.keys(_e))||void 0===e?void 0:e.length)>0&&Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(v.a,{className:"pt-3",config:we.config,Table:we.Table,TableRows:we.TableRows,TableAliasRows:we.TableAliasRows,rowElements:we.rowElements,defaultValues:we.defaultValues,dbData:_e,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,a){var n=e.status,c=e.data;if(200===n){if(e&&c&&"boolean"===typeof c.response&&null!==c.response&&c.response&&i.renderToast({message:t.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&c&&"boolean"===typeof c.response&&null!==c.response&&!1===c.response&&i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&c&&null===c.response&&D.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(P.jsx)(I.b,{}),content:Object(P.jsx)(I.a,{})}),e&&c&&"object"===typeof c.response&&null!==c.response){var r;r=1451===c.response.number?"foreignKeyDeleteMessage":"",i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:r,defaultMessage:r})})}}else i.renderToast({type:"error",icon:"fa fa-times-circle",message:t.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,we.id)},apiParams:oe,onChangeParams:function(e){return function(e){ie((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)},onReFetchData:function(){return Ie()},cellWidth:we.cellWidth,ajaxButtonName:t.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"credit_card_appId",value:i.userConfig.appId},theme:i.userData.theme})}),Object(P.jsxs)(u.a,{className:"align-items-center ".concat(!Object.keys(ae).length>0?"pb-5":""),children:[Object(P.jsx)(f.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(P.jsx)(g.a,{placeholder:"".concat(t.formatMessage({id:"select",defaultMessage:"select"})," ").concat(t.formatMessage({id:"creditCard",defaultMessage:"creditCard"})),onChange:function(e,t,a){$((function(e){return Object(n.a)(Object(n.a)({},e),{},{creditCard:t})}))},element:{fetch:{dropDownList:q.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Z.creditCard,type:"single",searchable:!0,theme:i.userData.theme})}),Object(P.jsxs)(f.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(P.jsx)("span",{children:Object(P.jsx)(h.a,{id:"startDate",defaultMessage:"startDate"})}),Object(P.jsx)(x.a,{className:"bg-white text-dark",value:Z.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(t){return Object(n.a)(Object(n.a)({},t),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(P.jsxs)(f.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(P.jsx)("span",{children:Object(P.jsx)(h.a,{id:"endDate",defaultMessage:"endDate"})}),Object(P.jsx)(x.a,{className:"bg-white text-dark",value:Z.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(t){return Object(n.a)(Object(n.a)({},t),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(P.jsx)(f.a,{sm:3,className:"pb-2",children:Object(P.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return pe()},disabled:!Z.creditCard,children:Object(P.jsx)(h.a,{id:"generate",defaultMessage:"generate"})})})]})]}),L&&Object(P.jsx)(Me,{}),ae&&Object.keys(ae).length>0&&Object(P.jsxs)(P.Fragment,{children:[Object(P.jsx)("div",{className:"py-2",children:Object(P.jsx)("span",{className:"badge ".concat("dark"===i.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:t.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),Object(P.jsx)(v.a,{id:be.id,config:be.config,Table:be.Table,TableRows:be.TableRows,TableAliasRows:be.TableAliasRows,rowElements:be.rowElements,defaultValues:be.defaultValues,dbData:ae,cellWidth:[20,10,10,10,10,10,10],theme:i.userData.theme,apiParams:ue,onChangeParams:function(e){return function(e){fe((function(t){return Object(n.a)(Object(n.a)({},t),e)}))}(e)}})]}),0===Object.keys(ae).length&&A&&!L&&Object(P.jsx)("div",{className:"text-center py-2",children:Object(P.jsx)(h.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},86:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1),c=a(79),r=function(){var e=Object(c.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);