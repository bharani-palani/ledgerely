"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[5265],{5265:(e,a,t)=>{t.r(a),t.d(a,{default:()=>S});var s=t(9950),r=t(3058),n=t(5358),c=t(6781),d=t(8459),l=t(4570),o=t(1308),i=t(2436),u=t(970),m=t(9288),g=t(3027),p=t(3932),f=t(9051),h=t.n(f),b=t(8311),x=t(2083),D=t(8630),M=t(9595),C=t(3177),y=t(7391),w=t(6731),j=t(9845),T=t(2097),_=t(4414);const A=s.createContext(void 0),S=()=>{var e;const a=(0,m.A)(),t=(0,s.useContext)(o.F);document.title=`${t.appName} - ${a.formatMessage({id:"creditCard",defaultMessage:"creditCard"})}`;const f=(0,s.useContext)(i.R),S=(0,s.useContext)(y.U),v=(0,s.useContext)(j.O),[I,R]=(0,s.useState)(!1),[N,P]=(0,s.useState)(!1),[k,E]=(0,s.useState)(!0),[F,O]=(0,s.useState)({}),[$,V]=(0,s.useState)({creditCard:"",startDate:h()().startOf("month").toDate(),endDate:h()().endOf("month").toDate()}),[Y,L]=(0,s.useState)({}),H={start:0,limit:10,searchString:""},[K,W]=(0,s.useState)(H),[G,B]=(0,s.useState)(H),J={config:{header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:a.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"cCTable",Table:"creditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[a.formatMessage({id:"name",defaultMessage:"name"}),a.formatMessage({id:"date",defaultMessage:"date"}),a.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),a.formatMessage({id:"credits",defaultMessage:"credits"}),a.formatMessage({id:"purchases",defaultMessage:"purchases"}),a.formatMessage({id:"interest",defaultMessage:"interest"}),a.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},U=e=>{P(!0),L({}),setTimeout((()=>{const a=(()=>{const e=new FormData;return e.append("limit",G.limit),e.append("start",G.start),e.append("searchString",G.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","creditCardTrx"),e.append("WhereClause",`a.cc_appId = '${f.userConfig.appId}' && a.cc_for_card = '${$.creditCard}' && d.credit_card_appId = '${f.userConfig.appId}' && a.cc_date >= '${h()($.startDate).format("YYYY-MM-DD").toString()}' && a.cc_date <= '${h()($.endDate).format("YYYY-MM-DD").toString()}'`),l.A.post("/account_planner/getAccountPlanner",e)})();Promise.all([a]).then((a=>{L(a[0].data.response),"function"===typeof e&&e()})).catch((e=>console.log("bbb",e))).finally((()=>{P(!1),R(!0)}))}),100)};(0,s.useEffect)((()=>{(async()=>{E(!0);const e=new FormData;e.append("appId",f.userConfig.appId),l.A.post("/account_planner/credit_card_list",e).then((e=>{O(e.data.response)})).catch((e=>{console.log(e)})).finally((()=>E(!1)))})()}),[]);(0,s.useEffect)((()=>{ne()}),[K]);const q=(0,M.I)(),z={fetch:q.get("fetch"),creditCardId:q.get("creditCardId"),startDate:q.get("startDate"),endDate:q.get("endDate")},[Q,X]=(0,s.useState)(!1);(0,s.useEffect)((()=>{"creditCard"===z.fetch&&z.creditCardId&&(X(!0),V((e=>({...e,creditCard:z.creditCardId,startDate:h()(z.startDate).toDate(),endDate:h()(z.endDate).toDate()}))),B(H))}),[JSON.stringify(z)]),(0,s.useEffect)((()=>{"creditCard"===z.fetch&&$.creditCard&&$.startDate&&$.endDate&&Q&&U((()=>{X(!1),setTimeout((()=>{var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(z),$.creditCard,Q]);const Z=()=>(0,_.jsx)("div",{className:"relativeSpinner",children:(0,_.jsx)(b.A,{type:x.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})}),ee=["id","name","last4DigitCardNo","startDate","endDate","payDate","annuaInterestRate","localeLanguage","localeCurrency"],ae=["checkbox","textbox","textbox","number","number","number","number",{fetch:{dropDownList:T.HF},searchable:!0},{fetch:{dropDownList:T.Mi},searchable:!0}],te=C.GG.filter((e=>"creditCardAccounts"===e.id)).map((e=>{const t={header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:S.localeLanguage,currency:S.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=t,e.TableAliasRows=ee.map((e=>a.formatMessage({id:e,defaultMessage:e}))),e.rowElements=ae,e}))[0],[se,re]=(0,s.useState)([]),ne=()=>{re([]);const e=((e,a)=>{const t=new FormData;return t.append("TableRows",a),t.append("Table",e),t.append("limit",K.limit),t.append("start",K.start),t.append("searchString",K.searchString),t.append("appId",f.userConfig.appId),l.A.post("/account_planner/getAccountPlanner",t)})(te.Table,te.TableRows);Promise.all([e]).then((async e=>{re(e[0].data.response)}))};return(0,s.useEffect)((()=>{I&&U()}),[G,I]),(0,_.jsx)(A.Provider,{value:{cCList:F,selection:$},children:(0,_.jsxs)(n.A,{fluid:!0,className:"pb-5",children:[(0,_.jsx)(r.A,{icon:"fa fa-credit-card",intlId:"creditCard"}),k?(0,_.jsx)(Z,{}):(0,_.jsxs)(_.Fragment,{children:[se&&(null===(e=Object.keys(se))||void 0===e?void 0:e.length)>0&&(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(D.A,{className:"pt-3",config:te.config,Table:te.Table,TableRows:te.TableRows,TableAliasRows:te.TableAliasRows,rowElements:te.rowElements,defaultValues:te.defaultValues,dbData:se,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:e=>(e=>{const{status:t,data:s}=e;if(200===t){if(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&f.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&f.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&v.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,_.jsx)(w.x,{}),content:(0,_.jsx)(w.E,{})}),e&&s&&"object"===typeof s.response&&null!==s.response){let e;e=1451===s.response.number?"foreignKeyDeleteMessage":"",f.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:e,defaultMessage:e})})}}else f.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(e,te.id),apiParams:K,onChangeParams:e=>(e=>{W((a=>({...a,...e})))})(e),onReFetchData:()=>ne(),cellWidth:te.cellWidth,ajaxButtonName:a.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"credit_card_appId",value:f.userConfig.appId},theme:f.userData.theme})}),(0,_.jsxs)(c.A,{className:"align-items-center "+(!Object.keys(Y).length>0?"pb-5":""),children:[(0,_.jsx)(d.A,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:(0,_.jsx)(u.A,{placeholder:`${a.formatMessage({id:"select",defaultMessage:"select"})} ${a.formatMessage({id:"creditCard",defaultMessage:"creditCard"})}`,onChange:(e,a,t)=>{V((e=>({...e,creditCard:a})))},element:{fetch:{dropDownList:F.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:$.creditCard,type:"single",searchable:!0,theme:f.userData.theme})}),(0,_.jsxs)(d.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,_.jsx)("span",{children:(0,_.jsx)(g.A,{id:"startDate",defaultMessage:"startDate"})}),(0,_.jsx)(p.A,{className:"bg-white text-dark",value:$.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{V((a=>({...a,startDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,_.jsxs)(d.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,_.jsx)("span",{children:(0,_.jsx)(g.A,{id:"endDate",defaultMessage:"endDate"})}),(0,_.jsx)(p.A,{className:"bg-white text-dark",value:$.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{V((a=>({...a,endDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,_.jsx)(d.A,{sm:3,className:"pb-2",children:(0,_.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:()=>U(),disabled:!$.creditCard,children:(0,_.jsx)(g.A,{id:"generate",defaultMessage:"generate"})})})]})]}),N&&(0,_.jsx)(Z,{}),Y&&Object.keys(Y).length>0&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("div",{className:"py-2",children:(0,_.jsx)("span",{className:"badge "+("dark"===f.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:a.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),(0,_.jsx)(D.A,{id:J.id,config:J.config,Table:J.Table,TableRows:J.TableRows,TableAliasRows:J.TableAliasRows,rowElements:J.rowElements,defaultValues:J.defaultValues,dbData:Y,cellWidth:[20,10,10,10,10,10,10],theme:f.userData.theme,apiParams:G,onChangeParams:e=>(e=>{B((a=>({...a,...e})))})(e)})]}),0===Object.keys(Y).length&&I&&!N&&(0,_.jsx)("div",{className:"text-center py-2",children:(0,_.jsx)(g.A,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}}}]);