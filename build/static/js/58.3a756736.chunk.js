(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[58],{1102:function(e,a,t){"use strict";t.r(a);var n=t(25),s=t(29),c=t(35),r=t(27),o=t(1),i=t.n(o),l=t(132),u=t(1265),b=t(1263),d=t(933),f=t(47),p=t(71),m=t(38),g=t(67),j=t(777),h=t(1260),O=t(120),x=t.n(O),D=t(51),M=t.n(D),y=t(52),k=t.n(y),w=t(48),v=t(92),T=t(82),_=t(108),S=t(73),C=t(61),I=t(65),R=t(328),N=t(0),P=i.a.createContext(void 0);a.default=function(){var e,a=Object(j.a)(),t=Object(o.useContext)(p.a);document.title="".concat(t.appName," - ").concat(a.formatMessage({id:"bank",defaultMessage:"bank"}));var i=Object(o.useContext)(m.a),O=Object(o.useContext)(S.a),D=Object(o.useContext)(I.a),y=Object(o.useState)(!1),A=Object(r.a)(y,2),E=A[0],F=A[1],L=Object(o.useState)(!1),V=Object(r.a)(L,2),Y=V[0],H=V[1],J=Object(o.useState)(!0),K=Object(r.a)(J,2),W=K[0],B=K[1],U=Object(o.useState)([]),G=Object(r.a)(U,2),q=G[0],z=G[1],Q=Object(o.useState)({bank:"",startDate:M()().startOf("month").toDate(),endDate:M()().endOf("month").toDate()}),X=Object(r.a)(Q,2),Z=X[0],$=X[1],ee=Object(o.useState)([]),ae=Object(r.a)(ee,2),te=ae[0],ne=ae[1],se={start:0,limit:10,searchString:""},ce=Object(o.useState)(se),re=Object(r.a)(ce,2),oe=re[0],ie=re[1],le=Object(o.useState)(se),ue=Object(r.a)(le,2),be=ue[0],de=ue[1],fe={config:{header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:a.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"bankTable",Table:"bankTrx",label:"Bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[a.formatMessage({id:"name",defaultMessage:"name"}),a.formatMessage({id:"date",defaultMessage:"date"}),a.formatMessage({id:"amount",defaultMessage:"amount"}),a.formatMessage({id:"type",defaultMessage:"type"}),a.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},pe=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){var a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),(a=new FormData).append("limit",oe.limit),a.append("start",oe.start),a.append("searchString",oe.searchString),a.append("appId",i.userConfig.appId),e.abrupt("return",f.a.post("/account_planner/bank_list",a).then((function(e){z(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return B(!1)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(e){H(!0),ne([]),setTimeout((function(){var a=function(){var e=new FormData;return e.append("limit",be.limit),e.append("start",be.start),e.append("searchString",be.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","bankTrx"),e.append("WhereClause","a.inc_exp_appId = '".concat(i.userConfig.appId,"' && a.inc_exp_bank = '").concat(Z.bank,"' && d.bank_appId = '").concat(i.userConfig.appId,"' && a.inc_exp_date >= '").concat(M()(Z.startDate).format("YYYY-MM-DD").toString(),"' && a.inc_exp_date <= '").concat(M()(Z.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([a]).then((function(a){ne(a[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){H(!1),F(!0)}))}),100)};Object(o.useEffect)((function(){pe()}),[]);var ge=Object(T.a)(),je={fetch:ge.get("fetch"),bankId:ge.get("bankId"),startDate:ge.get("startDate"),endDate:ge.get("endDate")},he=Object(o.useState)(!1),Oe=Object(r.a)(he,2),xe=Oe[0],De=Oe[1];Object(o.useEffect)((function(){"bank"===je.fetch&&je.bankId&&(De(!0),$((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:je.bankId,startDate:M()(je.startDate).toDate(),endDate:M()(je.endDate).toDate()})})))}),[JSON.stringify(je)]),Object(o.useEffect)((function(){"bank"===je.fetch&&Z.bank&&Z.startDate&&Z.endDate&&xe&&me((function(){De(!1),setTimeout((function(){var e;null===(e=document.getElementById("bankTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(je),Z.bank,xe]);var Me=function(){return Object(N.jsx)("div",{className:"relativeSpinner middle",children:Object(N.jsx)(k.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},ye=["id","bank","accountNumber","swiftCode","type","country","sort","localeLanguage","localeCurrency"],ke=["checkbox","textbox","textbox","textbox",{fetch:{dropDownList:[{id:"SAV",value:a.formatMessage({id:"savingsAccount",defaultMessage:"savingsAccount"})},{id:"CUR",value:a.formatMessage({id:"currentAccount",defaultMessage:"currentAccount"})}]}},{fetch:{dropDownList:R.a},searchable:!0},"number",{fetch:{dropDownList:R.c},searchable:!0},{fetch:{dropDownList:R.b},searchable:!0}],we=_.b.filter((function(e){return"bankAccounts"===e.id})).map((function(e){var t={header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:O.localeLanguage,currency:O.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=t,e.TableAliasRows=ye.map((function(e){return a.formatMessage({id:e,defaultMessage:e})})),e.rowElements=ke,e}))[0],ve=Object(o.useState)([]),Te=Object(r.a)(ve,2),_e=Te[0],Se=Te[1],Ce=function(){Se([]);var e=function(e,a){var t=new FormData;return t.append("TableRows",a),t.append("Table",e),t.append("limit",oe.limit),t.append("start",oe.start),t.append("searchString",oe.searchString),t.append("appId",i.userConfig.appId),f.a.post("/account_planner/getAccountPlanner",t)}(we.Table,we.TableRows);Promise.all([e]).then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(a){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Se(a[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())};Object(o.useEffect)((function(){Ce()}),[oe]);return Object(o.useEffect)((function(){E&&me()}),[be,E]),Object(N.jsx)(P.Provider,{value:{bankList:q,selection:Z},children:Object(N.jsxs)(u.a,{fluid:!0,children:[Object(N.jsx)(l.a,{icon:"fa fa-bank",intlId:"bank"}),W?Object(N.jsx)(Me,{}):Object(N.jsxs)(N.Fragment,{children:[_e&&(null===(e=Object.keys(_e))||void 0===e?void 0:e.length)>0&&Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(v.a,{className:"pt-3",config:we.config,Table:we.Table,TableRows:we.TableRows,TableAliasRows:we.TableAliasRows,rowElements:we.rowElements,defaultValues:we.defaultValues,dbData:_e,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,t){var n=e.status,s=e.data;if(200===n){if(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&i.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&i.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&D.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(N.jsx)(C.b,{}),content:Object(N.jsx)(C.a,{})}),e&&s&&"object"===typeof s.response&&null!==s.response){var c;c=1451===s.response.number?"foreignKeyDeleteMessage":"",i.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:c,defaultMessage:c})})}}else i.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,we.id)},apiParams:oe,onChangeParams:function(e){return function(e){ie((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)},onReFetchData:function(){return Ce()},cellWidth:we.cellWidth,ajaxButtonName:a.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"bank_appId",value:i.userConfig.appId},theme:i.userData.theme})}),Object(N.jsxs)(b.a,{className:"align-items-center ".concat(Object.keys(te).length>0?"":"pb-5"),children:[Object(N.jsx)(d.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(N.jsx)(g.a,{placeholder:"".concat(a.formatMessage({id:"select",defaultMessage:"select"})," ").concat(a.formatMessage({id:"bank",defaultMessage:"bank"})),onChange:function(e,a,t){$((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:a})}))},element:{fetch:{dropDownList:q.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Z.bank,type:"single",searchable:!0,theme:i.userData.theme})}),Object(N.jsxs)(d.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(N.jsx)("span",{children:Object(N.jsx)(h.a,{id:"startDate",defaultMessage:"startDate"})}),Object(N.jsx)(x.a,{className:"bg-white text-dark",value:Z.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(a){return Object(n.a)(Object(n.a)({},a),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(N.jsxs)(d.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(N.jsx)("span",{children:Object(N.jsx)(h.a,{id:"endDate",defaultMessage:"endDate"})}),Object(N.jsx)(x.a,{className:"bg-white text-dark",value:Z.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){$((function(a){return Object(n.a)(Object(n.a)({},a),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(N.jsx)(d.a,{sm:3,className:"pb-2",children:Object(N.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return me()},disabled:Y||!Z.bank,children:Object(N.jsx)(h.a,{id:"generate",defaultMessage:"generate"})})})]})]}),Y&&Object(N.jsx)(Me,{}),te&&Object.keys(te).length>0&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"py-2",children:Object(N.jsx)("span",{className:"badge ".concat("dark"===i.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:a.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),Object(N.jsx)(v.a,{id:fe.id,config:fe.config,Table:fe.Table,TableRows:fe.TableRows,TableAliasRows:fe.TableAliasRows,rowElements:fe.rowElements,defaultValues:fe.defaultValues,dbData:te,cellWidth:[25,7,10,5,20],theme:i.userData.theme,apiParams:be,onChangeParams:function(e){return function(e){de((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)}})]}),0===Object.keys(te).length&&E&&!Y&&Object(N.jsx)("div",{className:"text-center py-2",children:Object(N.jsx)(h.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},82:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(1),s=t(77),c=function(){var e=Object(s.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);