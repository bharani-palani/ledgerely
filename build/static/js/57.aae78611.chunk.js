(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[57],{255:function(e,t,a){"use strict";var n=a(24),s=a(27),c=a(35),i=a.n(c),l=a(1),r=a(42),o=a(0),u=["bsPrefix","className","as"],d=l.forwardRef((function(e,t){var a=e.bsPrefix,c=e.className,l=e.as,d=void 0===l?"div":l,b=Object(s.a)(e,u),p=Object(r.c)(a,"row"),j=Object(r.a)(),f=Object(r.b)(),m="".concat(p,"-cols"),O=[];return j.forEach((function(e){var t,a=b[e];delete b[e],t=null!=a&&"object"===typeof a?a.cols:a;var n=e!==f?"-".concat(e):"";null!=t&&O.push("".concat(m).concat(n,"-").concat(t))})),Object(o.jsx)(d,Object(n.a)(Object(n.a)({ref:t},b),{},{className:i.a.apply(void 0,[c,p].concat(O))}))}));d.displayName="Row",t.a=d},267:function(e,t,a){"use strict";a.r(t),a.d(t,"BillingContext",(function(){return k})),a.d(t,"CurrencyPrice",(function(){return P}));var n=a(24),s=a(25),c=a(1),i=a.n(c),l=a(36),r=a(56),o=a(787),u=a(1263),d=a(1284),b=a(932),p=a(255),j=a(937),f=a(43),m=a(49),O=a.n(m),y=a(44),g=a(71),h=a(0),x=Object(c.lazy)((function(){return Promise.all([a.e(59),a.e(62)]).then(a.bind(null,1250))})),v=Object(c.lazy)((function(){return a.e(60).then(a.bind(null,1183))})),M=Object(c.lazy)((function(){return a.e(61).then(a.bind(null,1251))})),C=Object(c.lazy)((function(){return a.e(7).then(a.bind(null,598)).then((function(e){return{default:e.CouponHeading}}))})),N=Object(c.lazy)((function(){return a.e(7).then(a.bind(null,598)).then((function(e){return{default:e.CouponContent}}))})),k=i.a.createContext(void 0),P=function(e){var t=e.amount,a=e.suffix,n=e.symbol,s=(t.toFixed(2)+"").split(".");return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("sup",{className:"fs-6",children:n}),Object(h.jsx)("span",{className:"fs-3",children:Number(s[0]).toLocaleString("en-US")}),Object(h.jsxs)("sub",{children:[".",s[1],a]})]})};t.default=function(e){var t=Object(o.a)(),a=Object(c.useContext)(l.a),i=Object(c.useContext)(r.a),m=Object(c.useState)([]),S=Object(s.a)(m,2),w=S[0],I=S[1],L=Object(c.useState)(!0),T=Object(s.a)(L,2),A=T[0],E=T[1],D=Object(c.useState)(!1),z=Object(s.a)(D,2),B=z[0],F=z[1],Y=Object(c.useState)({}),_=Object(s.a)(Y,2),R=_[0],U=_[1],H=Object(c.useState)([]),J=Object(s.a)(H,2),Q=J[0],W=J[1],V=Object(c.useState)(!1),q=Object(s.a)(V,2),G=q[0],K=q[1],X=Object(c.useState)({}),Z=Object(s.a)(X,2),$=Z[0],ee=Z[1],te={month:{prop:"planPriceMonthly",stripeProp:"pricingMonthStripeId",suffix:"  / ".concat(t.formatMessage({id:"month",defaultMessage:"month"}))},year:{prop:"planPriceYearly",stripeProp:"pricingYearStripeId",suffix:" / ".concat(t.formatMessage({id:"year",defaultMessage:"year"}))}},ae=["planBankAccountsLimit","planCreditCardAccounts","planCategoriesLimit","planUsersLimit","planTemplateLimit","planTrxLimit","planCreditCardTrxLimit","planDatasourceLimit","planWorkbookLimit","planStorageLimit","planIsBulkImport","planIsEmailAlerts","planIsPredictions","planIsTransactionSearch","visualizationLimit"],ne=[{key:"planBankAccountsLimit",type:"numericNull",label:t.formatMessage({id:"bankAccounts",defaultMessage:"bankAccounts"})},{key:"planCreditCardAccounts",type:"numericNull",label:t.formatMessage({id:"creditCardAccounts",defaultMessage:"creditCardAccounts"})},{key:"planCategoriesLimit",type:"numericNull",label:t.formatMessage({id:"incExpCat",defaultMessage:"incExpCat"})},{key:"planUsersLimit",type:"numericNull",label:t.formatMessage({id:"users",defaultMessage:"users"})},{key:"planTemplateLimit",type:"numericNull",label:t.formatMessage({id:"planners",defaultMessage:"planners"})},{key:"planTrxLimit",type:"numericNull",label:t.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})},{key:"planCreditCardTrxLimit",type:"numericNull",label:t.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})},{key:"planDatasourceLimit",type:"bytesOrNull",label:t.formatMessage({id:"dataSource",defaultMessage:"dataSource"})},{key:"planWorkbookLimit",type:"bytesOrNull",label:t.formatMessage({id:"workbook",defaultMessage:"workbook"})},{key:"planStorageLimit",type:"bytesOrNull",label:t.formatMessage({id:"fileStorage",defaultMessage:"fileStorage"})},{key:"planIsBulkImport",type:"boolean",label:t.formatMessage({id:"bulkImport",defaultMessage:"bulkImport"})},{key:"planIsEmailAlerts",type:"boolean",label:t.formatMessage({id:"emailAlerts",defaultMessage:"emailAlerts"})},{key:"planIsPredictions",type:"boolean",label:t.formatMessage({id:"predictions",defaultMessage:"predictions"})},{key:"planIsTransactionSearch",type:"boolean",label:t.formatMessage({id:"globalSearch",defaultMessage:"globalSearch"})},{key:"visualizationLimit",type:"numericNull",label:t.formatMessage({id:"visualizations",defaultMessage:"visualizations"})}],se=[{value:"month",label:t.formatMessage({id:"monthly",defaultMessage:"monthly"})},{value:"year",label:t.formatMessage({id:"yearly",defaultMessage:"yearly"})}],ce=Object(c.useState)({currency:a.userConfig.currency,cycle:"month",stripeCustomerId:a.userConfig.stripeCustomerId,stripePriceId:"",invoice:[{id:"price",label:t.formatMessage({id:"price",defaultMessage:"price"}),value:0},{id:"creditAdjustment",label:t.formatMessage({id:"creditAdjustment",defaultMessage:"creditAdjustment"}),value:0},{id:"discount",label:t.formatMessage({id:"discount",defaultMessage:"discount"}),title:"",value:0},{id:"tax",label:t.formatMessage({id:"tax",defaultMessage:"tax"}),title:"",value:0}],total:0}),ie=Object(s.a)(ce,2),le=ie[0],re=ie[1],oe=Number(le.invoice.reduce((function(e,t){return e+t.value}),0).toFixed(2)),ue=function(){return f.a.post("/payments/checkDiscounts")};Object(c.useEffect)((function(){i.setConfig({show:!1});var e=function(){var e=new FormData;return e.append("appId",a.userConfig.appId),e.append("currency",a.userConfig.currency),e.append("env","production"),f.a.post("/payments/availableBillingPlans",e)}(),t=ue();return Promise.all([e,t]).then((function(e){I(e[0].data.response);var t=Object.keys(e[0].data.response[0]).sort((function(e,t){return ae.indexOf(e)-ae.indexOf(t)}));W(t),ee(e[1].data.response.all[0])})).catch((function(e){return console.log(e)})).finally((function(){return E(!1)})),function(){i.setConfig({show:!1})}}),[]),Object(c.useEffect)((function(){$&&Object.keys($).length>0&&i.setConfig({show:!0,className:"alert-success border-0 text-dark",type:"success",dismissible:!0,heading:Object(h.jsx)(C,{}),content:Object(h.jsx)(N,{values:{n:null===$||void 0===$?void 0:$.percent_off,y:$.name}})})}),[$]),Object(c.useEffect)((function(){if(null!==R&&void 0!==R&&R.planId){F(!0);var e=ue(),t=((new FormData).append("country",a.userConfig.country),f.a.get("/payments/checkTaxes")),s=function(){var e=new FormData;return e.append("stripeCustomerId",a.userConfig.stripeCustomerId),e.append("stripePriceId",le.stripePriceId),f.a.post("/payments/deductExhaustedUsage",e)}();Promise.all([e,t,s]).then((function(e){var t=e[0].data.response,a=t.name,s=t.value/100*R[te[le.cycle].prop];s=-Number(s.toFixed(2));var c=e[1].data.response,i=c.name,l=c.value/100*R[te[le.cycle].prop];l=Number(l.toFixed(2));var r=e[2].data.response.adjustmentCredit;re((function(e){return Object(n.a)(Object(n.a)({},e),{},{invoice:e.invoice.map((function(e){return"discount"===e.id&&Object.assign(e,{title:a,value:s}),"tax"===e.id&&Object.assign(e,{title:i,value:l}),"creditAdjustment"===e.id?Object.assign(e,{value:r}):e}))})}))})).catch((function(e){return console.log(e)})).finally((function(){return F(!1)}))}}),[R.planId,le.cycle]);var de=function(e){var a=e.planPriceMonthly,n=e.planPriceYearly,s=e.isPlanOptable,c=e.planPriceCurrencySymbol;return Object(h.jsxs)("div",{style:s?{}:{textDecoration:"line-through"},className:"d-flex align-items-center justify-content-center text-center",children:[Object(h.jsx)("div",{className:"pe-2",children:Object(h.jsx)(P,{amount:a,suffix:" / ".concat(t.formatMessage({id:"month",defaultMessage:"month"})),symbol:c})}),Object(h.jsx)("div",{className:"w-50",children:Object(h.jsx)(P,{amount:n,suffix:" / ".concat(t.formatMessage({id:"year",defaultMessage:"year"})),symbol:c})})]})},be=function(e){var t=e.planTitle,a=e.planDescription;return Object(h.jsxs)("div",{className:"text-center py-2",children:[Object(h.jsx)("div",{className:"fs-4",children:Object(h.jsx)(u.a,{id:t,defaultMessage:t})}),Object(h.jsx)("div",{style:{fontSize:"0.75rem"},children:Object(h.jsx)(u.a,{id:a,defaultMessage:a})})]})},pe=function(n){var s=n.planName,c=n.planCode,i=n.isPlanOptable;return Object(h.jsxs)("div",{className:"bni-bg rounded-top text-dark px-2 py-1 d-flex align-items-center justify-content-between",children:[Object(h.jsxs)("div",{style:i?{}:{textDecoration:"line-through"},children:[R.planCode===c&&Object(h.jsx)("i",{className:"fa fa-check-circle pe-1"}),Object(h.jsx)("span",{children:Object(h.jsx)(u.a,{id:s,defaultMessage:s})}),!i&&Object(h.jsx)(d.a,{placement:"right",delay:{show:250,hide:400},overlay:je(e,t.formatMessage({id:"maximumQuotaExceeded",defaultMessage:"maximumQuotaExceeded"})),triggerType:"hover",children:Object(h.jsx)("i",{className:"fa fa-info-circle ps-1 cursor-pointer"})})]}),a.userConfig.planCode===c&&Object(h.jsx)("div",{children:Object(h.jsx)("span",{className:"badge rounded-pill bg-dark",children:Object(h.jsx)(u.a,{id:"currentPlan",defaultMessage:"currentPlan"})})})]})},je=function(e,t){return Object(h.jsx)(b.a,{id:"button-tooltip-".concat(Math.random()),className:"in show",children:t})},fe=function(e){var t,a,n,s,c=e.obj,i=e.t,l=ne.filter((function(e){return e.key===c})),r=null===(t=l[0])||void 0===t?void 0:t.label,o="";return o="numericNull"===(null===(a=l[0])||void 0===a?void 0:a.type)?null!==i[c]?i[c]:Object(h.jsx)("span",{className:"text-success",children:"\u221e"}):"bytesOrNull"===(null===(n=l[0])||void 0===n?void 0:n.type)?null!==i[c]?"".concat(i[c]/1024/1024," MB"):Object(h.jsx)("span",{className:"text-success",children:"\u221e"}):"boolean"===(null===(s=l[0])||void 0===s?void 0:s.type)?i[c]?Object(h.jsx)("i",{className:"fa fa-check text-success"}):Object(h.jsx)("i",{className:"fa fa-times text-danger"}):i[c],Object(h.jsxs)("div",{className:"d-flex align-items-center justify-content-between pb-1",children:[Object(h.jsx)("div",{children:r}),Object(h.jsx)("div",{children:o})]})},me=function(){return Object(h.jsx)("div",{className:"relativeSpinner",children:Object(h.jsx)(O.a,{type:y.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},Oe=function(e){U(e),ye(e),setTimeout((function(){window.scrollTo(0,document.body.scrollHeight)}),1e3)},ye=function(e){if(e.isPlanOptable){var t=w.filter((function(t){return t.planCode===e.planCode}))[0].planPriceMonthly,a=w.filter((function(t){return t.planCode===e.planCode}))[0].pricingMonthStripeId;re((function(e){return Object(n.a)(Object(n.a)({},e),{},{stripePriceId:a,cycle:se[0].value,invoice:e.invoice.map((function(e){return"price"===e.id?Object.assign(e,{value:t}):e}))})}))}},ge=function(e){return Number(e.planPriceMonthly)&&Number(e.planPriceYearly)?Object(h.jsx)("button",{onClick:function(){return Oe(e)},disabled:!e.isPlanOptable,className:"w-100 btn btn-bni p-1 rounded-top-0 border-0",title:"Subscribe now",children:Object(h.jsx)(de,{planPriceMonthly:e.planPriceMonthly,planPriceYearly:e.planPriceYearly,isPlanOptable:e.isPlanOptable,planPriceCurrencySymbol:e.planPriceCurrencySymbol})}):Object(h.jsx)("button",{disabled:!e.isPlanOptable,className:"w-100 btn btn-bni rounded-top-0 border-0 py-2",children:Object(h.jsx)("div",{className:"py-1",children:Object(h.jsx)(u.a,{id:"free",defaultMessage:"free"})})})},he=Object(c.useState)(!1),xe=Object(s.a)(he,2),ve=xe[0],Me=xe[1],Ce=Object(c.useState)(""),Ne=Object(s.a)(Ce,2),ke=Ne[0],Pe=Ne[1],Se=Object(g.h)().search,we=new URLSearchParams(Se).get("session_id");return Object(c.useEffect)((function(){Pe(we)}),[we]),Object(c.useEffect)((function(){ke&&Me(!0)}),[ke]),Object(h.jsx)(c.Suspense,{fallback:me(),children:Object(h.jsxs)(k.Provider,{value:{summary:le,setSummary:re,cycleList:se,table:w,selectedPlan:R,cycleRef:te,total:oe,billingLoader:B,showCheckout:G,setShowCheckout:K,sessionId:ke,showSessionPopup:ve,setShowSessionPopup:Me},children:[Object(h.jsx)(M,{}),Object(h.jsxs)("div",{className:"container-fluid",children:[Object(h.jsx)("div",{className:"bg-gradient ".concat("dark"===a.userData.theme?"bg-dark darkBoxShadow":"bg-white lightBoxShadow"," mt-2 ps-3 py-2 rounded-pill mb-4"),children:Object(h.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:Object(h.jsxs)("div",{className:"d-flex align-items-center",children:[Object(h.jsx)("i",{className:"fa fa-credit-card-alt fa-1x"}),Object(h.jsx)("div",{className:"ps-2 mb-0",children:Object(h.jsx)(u.a,{id:"billing",defaultMessage:"billing"})})]})})}),A&&me(),!A&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{children:w&&w.length>0&&Object(h.jsx)(p.a,{className:"",children:w.map((function(e,t){return Object(h.jsx)(j.a,{md:6,lg:3,className:"pb-3",children:Object(h.jsxs)("div",{className:"rounded-3 border ".concat("dark"===a.userData.theme?"border-black":"border-1"," ").concat(e.isPlanOptable?"cursor-pointer":"cursor-not-allowed"," ").concat(R.planCode===e.planCode?"animate__animated animate__headShake":""),style:R.planCode===e.planCode?{boxShadow:"0 0 20px 0px #000"}:{},onClick:function(){return e.isPlanOptable&&Oe(e)},children:[Object(h.jsx)(pe,Object(n.a)({},e)),Object(h.jsx)(be,Object(n.a)({},e)),Object(h.jsx)("div",{className:"p-2",children:Q.filter((function(e){return!["planId","planCode","planName","planTitle","planDescription","planIsActive","planPriceMonthly","planPriceYearly","planPriceCurrencySymbol","pricingMonthStripeId","pricingYearStripeId"].includes(e)})).map((function(t,a){return Object(h.jsx)(fe,{obj:t,t:e},a)}))}),Object(h.jsx)(ge,Object(n.a)({},e))]})},t)}))})}),Object(h.jsx)(x,{}),Object(h.jsx)("hr",{className:"mt-5"}),Object(h.jsx)(p.a,{children:Object(h.jsx)(j.a,{sm:6,children:Object(h.jsx)(v,{})})})]})]})]})})}}}]);