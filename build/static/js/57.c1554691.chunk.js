(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[57],{1101:function(e,a,t){"use strict";t.r(a);var n=t(25),s=t(28),c=t(34),r=t(27),o=t(1),i=t.n(o),l=t(117),u=t(1265),b=t(1263),d=t(932),f=t(47),p=t(37),m=t(64),g=t(775),j=t(1260),h=t(106),O=t.n(h),x=t(51),D=t.n(x),y=t(52),M=t.n(y),w=t(48),k=t(87),v=t(78),T=t(96),_=t(70),S=t(58),C=t(62),I=t(315),R=t(0),P=i.a.createContext(void 0);a.default=function(){var e,a=Object(g.a)(),t=Object(o.useContext)(p.a),i=Object(o.useContext)(_.a),h=Object(o.useContext)(C.a),x=Object(o.useState)(!1),y=Object(r.a)(x,2),N=y[0],A=y[1],E=Object(o.useState)(!1),F=Object(r.a)(E,2),L=F[0],V=F[1],Y=Object(o.useState)(!0),H=Object(r.a)(Y,2),J=H[0],K=H[1],W=Object(o.useState)([]),B=Object(r.a)(W,2),U=B[0],G=B[1],q=Object(o.useState)({bank:"",startDate:D()().startOf("month").toDate(),endDate:D()().endOf("month").toDate()}),z=Object(r.a)(q,2),Q=z[0],X=z[1],Z=Object(o.useState)([]),$=Object(r.a)(Z,2),ee=$[0],ae=$[1],te={start:0,limit:10,searchString:""},ne=Object(o.useState)(te),se=Object(r.a)(ne,2),ce=se[0],re=se[1],oe=Object(o.useState)(te),ie=Object(r.a)(oe,2),le=ie[0],ue=ie[1],be={config:{header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:a.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"bankTable",Table:"bankTrx",label:"Bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[a.formatMessage({id:"name",defaultMessage:"name"}),a.formatMessage({id:"date",defaultMessage:"date"}),a.formatMessage({id:"amount",defaultMessage:"amount"}),a.formatMessage({id:"type",defaultMessage:"type"}),a.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},de=function(){var e=Object(c.a)(Object(s.a)().mark((function e(){var a;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!0),(a=new FormData).append("limit",ce.limit),a.append("start",ce.start),a.append("searchString",ce.searchString),a.append("appId",t.userConfig.appId),e.abrupt("return",f.a.post("/account_planner/bank_list",a).then((function(e){G(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return K(!1)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){V(!0),ae([]),setTimeout((function(){var a=function(){var e=new FormData;return e.append("limit",le.limit),e.append("start",le.start),e.append("searchString",le.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","bankTrx"),e.append("WhereClause","a.inc_exp_appId = '".concat(t.userConfig.appId,"' && a.inc_exp_bank = '").concat(Q.bank,"' && d.bank_appId = '").concat(t.userConfig.appId,"' && a.inc_exp_date >= '").concat(D()(Q.startDate).format("YYYY-MM-DD").toString(),"' && a.inc_exp_date <= '").concat(D()(Q.endDate).format("YYYY-MM-DD").toString(),"'")),f.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([a]).then((function(a){ae(a[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){V(!1),A(!0)}))}),100)};Object(o.useEffect)((function(){de()}),[]);var pe=Object(v.a)(),me={fetch:pe.get("fetch"),bankId:pe.get("bankId"),startDate:pe.get("startDate"),endDate:pe.get("endDate")},ge=Object(o.useState)(!1),je=Object(r.a)(ge,2),he=je[0],Oe=je[1];Object(o.useEffect)((function(){"bank"===me.fetch&&me.bankId&&(Oe(!0),X((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:me.bankId,startDate:D()(me.startDate).toDate(),endDate:D()(me.endDate).toDate()})})))}),[JSON.stringify(me)]),Object(o.useEffect)((function(){"bank"===me.fetch&&Q.bank&&Q.startDate&&Q.endDate&&he&&fe((function(){Oe(!1),setTimeout((function(){var e;null===(e=document.getElementById("bankTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(me),Q.bank,he]);var xe=function(){return Object(R.jsx)("div",{className:"relativeSpinner middle",children:Object(R.jsx)(M.a,{type:w.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},De=["id","bank","accountNumber","swiftCode","type","country","sort","localeLanguage","localeCurrency"],ye=["checkbox","textbox","textbox","textbox",{fetch:{dropDownList:[{id:"SAV",value:a.formatMessage({id:"savingsAccount",defaultMessage:"savingsAccount"})},{id:"CUR",value:a.formatMessage({id:"currentAccount",defaultMessage:"currentAccount"})}]}},{fetch:{dropDownList:I.a},searchable:!0},"number",{fetch:{dropDownList:I.c},searchable:!0},{fetch:{dropDownList:I.b},searchable:!0}],Me=T.b.filter((function(e){return"bankAccounts"===e.id})).map((function(e){var t={header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:i.localeLanguage,currency:i.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=t,e.TableAliasRows=De.map((function(e){return a.formatMessage({id:e,defaultMessage:e})})),e.rowElements=ye,e}))[0],we=Object(o.useState)([]),ke=Object(r.a)(we,2),ve=ke[0],Te=ke[1],_e=function(){Te([]);var e=function(e,a){var n=new FormData;return n.append("TableRows",a),n.append("Table",e),n.append("limit",ce.limit),n.append("start",ce.start),n.append("searchString",ce.searchString),n.append("appId",t.userConfig.appId),f.a.post("/account_planner/getAccountPlanner",n)}(Me.Table,Me.TableRows);Promise.all([e]).then(function(){var e=Object(c.a)(Object(s.a)().mark((function e(a){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Te(a[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())};Object(o.useEffect)((function(){_e()}),[ce]);return Object(o.useEffect)((function(){N&&fe()}),[le,N]),Object(R.jsx)(P.Provider,{value:{bankList:U,selection:Q},children:Object(R.jsxs)(u.a,{fluid:!0,children:[Object(R.jsx)(l.a,{icon:"fa fa-bank",intlId:"bank"}),J?Object(R.jsx)(xe,{}):Object(R.jsxs)(R.Fragment,{children:[ve&&(null===(e=Object.keys(ve))||void 0===e?void 0:e.length)>0&&Object(R.jsx)(R.Fragment,{children:Object(R.jsx)(k.a,{className:"pt-3",config:Me.config,Table:Me.Table,TableRows:Me.TableRows,TableAliasRows:Me.TableAliasRows,rowElements:Me.rowElements,defaultValues:Me.defaultValues,dbData:ve,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,n){var s=e.status,c=e.data;if(200===s){if(e&&c&&"boolean"===typeof c.response&&null!==c.response&&c.response&&t.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&c&&"boolean"===typeof c.response&&null!==c.response&&!1===c.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&c&&null===c.response&&h.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(R.jsx)(S.b,{}),content:Object(R.jsx)(S.a,{})}),e&&c&&"object"===typeof c.response&&null!==c.response){var r;r=1451===c.response.number?"foreignKeyDeleteMessage":"",t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:r,defaultMessage:r})})}}else t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,Me.id)},apiParams:ce,onChangeParams:function(e){return function(e){re((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)},onReFetchData:function(){return _e()},cellWidth:Me.cellWidth,ajaxButtonName:a.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"bank_appId",value:t.userConfig.appId},theme:t.userData.theme})}),Object(R.jsxs)(b.a,{className:"align-items-center ".concat(Object.keys(ee).length>0?"":"pb-5"),children:[Object(R.jsx)(d.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(R.jsx)(m.a,{placeholder:"".concat(a.formatMessage({id:"select",defaultMessage:"select"})," ").concat(a.formatMessage({id:"bank",defaultMessage:"bank"})),onChange:function(e,a,t){X((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:a})}))},element:{fetch:{dropDownList:U.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Q.bank,type:"single",searchable:!0,theme:t.userData.theme})}),Object(R.jsxs)(d.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(R.jsx)("span",{children:Object(R.jsx)(j.a,{id:"startDate",defaultMessage:"startDate"})}),Object(R.jsx)(O.a,{className:"bg-white text-dark",value:Q.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(R.jsxs)(d.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(R.jsx)("span",{children:Object(R.jsx)(j.a,{id:"endDate",defaultMessage:"endDate"})}),Object(R.jsx)(O.a,{className:"bg-white text-dark",value:Q.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(R.jsx)(d.a,{sm:3,className:"pb-2",children:Object(R.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return fe()},disabled:L||!Q.bank,children:Object(R.jsx)(j.a,{id:"generate",defaultMessage:"generate"})})})]})]}),L&&Object(R.jsx)(xe,{}),ee&&Object.keys(ee).length>0&&Object(R.jsxs)(R.Fragment,{children:[Object(R.jsx)("div",{className:"py-2",children:Object(R.jsx)("span",{className:"badge ".concat("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:a.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),Object(R.jsx)(k.a,{id:be.id,config:be.config,Table:be.Table,TableRows:be.TableRows,TableAliasRows:be.TableAliasRows,rowElements:be.rowElements,defaultValues:be.defaultValues,dbData:ee,cellWidth:[25,7,10,5,20],theme:t.userData.theme,apiParams:le,onChangeParams:function(e){return function(e){ue((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)}})]}),0===Object.keys(ee).length&&N&&!L&&Object(R.jsx)("div",{className:"text-center py-2",children:Object(R.jsx)(j.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},78:function(e,a,t){"use strict";t.d(a,"a",(function(){return c}));var n=t(1),s=t(72),c=function(){var e=Object(s.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}}}]);