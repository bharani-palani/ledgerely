"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[3314],{6447:(e,t,n)=>{n.d(t,{U:()=>i});n(9950);var r=n(8045),a=n(8989),o=n(4414);function i(e){const{children:t}=e,{attributes:n,listeners:i,setNodeRef:l,transform:s,transition:d}=(0,r.gl)({id:e.id}),c={transform:a.Ks.Transform.toString(s),transition:d};return(0,o.jsx)("div",{ref:l,style:c,...n,...i,children:t})}},3314:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var r=n(9950),a=n(68),o=n(246),i=n(4268),l=n(3302),s=n(7937),d=n(1432),c=n(7956),u=n(9288),f=n(3027),h=n(1576),m=n(2016),p=n(2436),b=n(2581),v=n(3718),g=n(8045),x=n(6447),y=n(4414);const j=e=>{var t,n;const j=(0,u.A)(),w=(0,r.useContext)(a.A),M=(0,r.useContext)(p.R),{sheets:_,setSheets:N,theme:k,activeSheet:C,setActiveSheet:A,setActiveChart:S}=w,{styles:O}=e,E=null===(t=_.filter((e=>e.id===C))[0])||void 0===t?void 0:t.zoom,[P,D]=(0,r.useState)({state:!1,id:null,label:null,source:null}),T=(0,r.useRef)([]);(0,r.useEffect)((()=>{const e=_[0].id;A(e)}),[]);const L=e=>{if(_.length<m.e_.sheetLimit){const t={...e},n=(0,c.A)(),r={id:n,order:_.length,label:`${t.label} (${j.formatMessage({id:"clone",defaultMessage:"clone"})})`.substring(0,15),charts:t.charts,zoom:t.zoom},a=[..._,r];N(a),setTimeout((()=>{A(n)}),[500])}else M.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:j.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},z=e=>{let t=_.findIndex((e=>e.id===C));if(t=e?t+1:t-1,t>-1&&t<_.length){const e=_[t].id;A(e)}};(0,r.useEffect)((()=>{var e;const t=_.findIndex((e=>e.id===C));null===T||void 0===T||null===(e=T.current[t])||void 0===e||e.scrollIntoView({inline:"start"}),S("")}),[C]);const I=e=>{const t=_.map((t=>(t.id===C&&(t.zoom=e),t)));N(t)},F=(0,v.FR)((0,v.MS)(v.AN,{activationConstraint:{distance:5}}),(0,v.MS)(v.IG,{activationConstraint:{distance:5}}),(0,v.MS)(v.uN,{coordinateGetter:g.JR}));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(h.A,{show:P.state&&"delete"===P.source,confirmationstring:j.formatMessage({id:"areYouSureToDeleteSheet",defaultMessage:"areYouSureToDeleteSheet"}),handleHide:()=>{D((e=>({...e,state:!1,id:null,label:null,source:null})))},handleYes:()=>(()=>{const e=P.id,t=_.filter((t=>t.id!==e));N(t),A((()=>t[0].id)),D((e=>({...e,state:!1,id:null,label:null,source:null})))})(),size:"md"}),(0,y.jsxs)(i.A,{...e,style:{zIndex:1e4},show:P.state&&"rename"===P.source,onHide:()=>D((e=>({...e,state:!1,id:null,label:null,source:null}))),size:"sm",animation:!1,centered:!0,backdrop:"static",children:[(0,y.jsx)(i.A.Header,{children:(0,y.jsx)(i.A.Title,{children:(0,y.jsx)(f.A,{id:"rename",defaultMessage:"rename"})})}),(0,y.jsxs)(i.A.Body,{className:"container-fluid rounded-bottom "+("dark"===k?"bg-dark text-white":"bg-white text-dark"),children:[(0,y.jsx)(l.A.Control,{type:"text",maxLength:15,placeholder:j.formatMessage({id:"maxLetters",defaultMessage:"maxLetters"},{n:15}),className:"mb-2",onChange:e=>D((t=>({...t,label:e.target.value}))),value:P.label}),(0,y.jsxs)("div",{className:"d-flex",children:[(0,y.jsx)(s.A,{variant:`btn btn-${k} w-50 me-2`,onClick:()=>D((e=>({...e,state:!1,id:null,label:null}))),children:(0,y.jsx)(f.A,{id:"cancel",defaultMessage:"cancel"})}),(0,y.jsx)(s.A,{variant:"btn btn-bni w-50",disabled:!(null!==P&&void 0!==P&&null!==(n=P.label)&&void 0!==n&&n.length),onClick:()=>(()=>{const e=P.id,t=_.map(((t,n)=>t.id===e?{...t,label:P.label}:t));N(t),D((e=>({...e,state:!1,id:null,label:null,source:null})))})(),children:(0,y.jsx)(f.A,{id:"submit",defaultMessage:"submit"})})]})]})]}),(0,y.jsxs)("div",{className:`d-flex border border-1 ${"dark"===k?"border-secondary":""} rounded-bottom border-top-0`,style:{...O},children:[(0,y.jsx)("button",{className:"btn btn-sm btn-bni border-0 px-3",onClick:()=>{if(_.length<m.e_.sheetLimit){const e=(0,c.A)(),t={id:e,order:_.length,label:`${j.formatMessage({id:"sheet",defaultMessage:"sheet"})} ${_.length+1}`,charts:[],zoom:100},n=[..._,t];N(n),setTimeout((()=>{A(e)}),500)}else M.renderToast({type:"warn",icon:"fa fa-exclamation-triangle",position:"bottom-center",message:j.formatMessage({id:"sheetLimitExceeded",defaultMessage:"sheetLimitExceeded"})})},style:{borderRadius:"0px 0px 0px 5px"},children:(0,y.jsx)("i",{className:"fa fa-plus"})}),(0,y.jsx)("button",{onClick:()=>z(0),className:`btn btn-sm btn-${"dark"===k?"dark":"white"} border-0 border-end px-2 rounded-0`,disabled:0===_.findIndex((e=>e.id===C)),children:(0,y.jsx)("i",{className:"fa fa-chevron-left"})}),(0,y.jsx)("div",{className:"d-flex w-75 flex-row overflow-hidden",children:(0,y.jsx)(v.Mp,{sensors:F,collisionDetection:v.fp,onDragEnd:e=>{let{active:t,over:n}=e;if(t.id!==n.id){const e=_.findIndex((e=>{let{id:n}=e;return n===t.id})),r=_.findIndex((e=>{let{id:t}=e;return t===n.id})),a=(0,g.be)(_,e,r);N(a)}},children:(0,y.jsx)(g.gB,{items:_,strategy:g.m$,children:_.map(((e,t)=>{return(0,y.jsx)(x.U,{id:e.id,children:(0,y.jsxs)("div",{className:"cursor-pointer d-flex border-3 align-items-center bg-"+("dark"===k?"dark":"white"),ref:e=>{T.current[t]=e},children:[(0,y.jsx)(d.A,{trigger:"click",placement:"top",overlay:(n=e,(0,y.jsxs)(o.A,{id:"popover-basic",children:[(0,y.jsx)(o.A.Header,{as:"div",className:"bni-bg bni-text",children:(0,y.jsx)(f.A,{id:"action",defaultMessage:"action"})}),(0,y.jsx)(o.A.Body,{className:"p-0",children:(0,y.jsxs)("ul",{className:"list-group list-group-flush",children:[(0,y.jsx)("li",{className:"list-group-item cursor-pointer",onClick:()=>D((e=>({...e,state:!0,id:n.id,label:n.label,source:"rename"}))),children:(0,y.jsx)(f.A,{id:"rename",defaultMessage:"rename"})}),_.length>1&&(0,y.jsx)("li",{className:"list-group-item cursor-pointer text-danger",onClick:()=>D((e=>({...e,state:!0,id:n.id,label:n.label,source:"delete"}))),children:(0,y.jsx)(f.A,{id:"delete",defaultMessage:"delete"})}),(0,y.jsx)("li",{onClick:()=>L(n),className:"list-group-item cursor-pointer rounded-bottom",children:(0,y.jsx)(f.A,{id:"clone",defaultMessage:"clone"})})]})})]})),rootClose:!0,children:(0,y.jsx)("i",{className:"fa fa-cog px-2"})}),(0,y.jsx)("div",{style:{minWidth:130},className:`rounded-0 btn btn-sm btn-${C===e.id?"bni":k} border-0 border-end ${"dark"===k?"border-secondary":""}`,onClick:()=>A(e.id),children:e.label})]})},e.id);var n}))})})}),(0,y.jsx)("button",{onClick:()=>z(1),className:`btn btn-sm btn-${"dark"===k?"dark":"white"} border-0 border-0 border-start border-end px-2 rounded-0`,disabled:_.findIndex((e=>e.id===C))===_.length-1,children:(0,y.jsx)("i",{className:"fa fa-chevron-right"})}),(0,y.jsxs)("div",{className:"d-flex align-items-center",children:[(0,y.jsx)("div",{className:"px-1",children:(0,y.jsx)("i",{className:"fa fa-minus cursor-pointer",onClick:()=>E<=200&&E>100&&I(E-1)})}),(0,y.jsx)("div",{className:"",style:{width:"150px"},children:(0,y.jsx)(b.A,{min:100,max:200,value:E,step:1,orientation:"horizontal",onChange:e=>I(e),tooltip:!1})}),(0,y.jsx)("div",{className:"px-1",children:(0,y.jsx)("i",{className:"fa fa-plus cursor-pointer",onClick:()=>E<200&&E>=100&&I(E+1)})}),(0,y.jsxs)("div",{className:"px-1 w-50px",children:[E,"%"]})]})]})]})}},613:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=c(n(8738)),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=u(e)&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var i=a?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=e[o]}return r.default=e,n&&n.set(e,r),r}(n(9950)),o=c(n(1942)),i=c(n(853)),l=n(9328),s=n(4414);function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function c(e){return e&&e.__esModule?e:{default:e}}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function f(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y(r.key),r)}}function p(e,t,n){return t=v(t),function(e,t){if(t&&("object"===u(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,b()?Reflect.construct(t,n||[],v(e).constructor):t.apply(e,n))}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(b=function(){return!!e})()}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function g(e,t){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},g(e,t)}function x(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}var j={orientation:{horizontal:{dimension:"width",direction:"left",reverseDirection:"right",coordinate:"x"},vertical:{dimension:"height",direction:"top",reverseDirection:"bottom",coordinate:"y"}}},w=function(e){function t(e,n){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),x(a=p(this,t,[e,n]),"handleFormat",(function(e){var t=a.props.format;return t?t(e):e})),x(a,"handleUpdate",(function(){if(a.slider){var e=a.props.orientation,t=(0,l.capitalize)(j.orientation[e].dimension),n=a.slider["offset".concat(t)],r=a.handle["offset".concat(t)];a.setState({limit:n-r,grab:r/2})}})),x(a,"handleStart",(function(e){var t=a.props.onChangeStart;document.addEventListener("mousemove",a.handleDrag),document.addEventListener("mouseup",a.handleEnd),a.setState({active:!0},(function(){t&&t(e)}))})),x(a,"handleDrag",(function(e){e.stopPropagation();var t=a.props.onChange,n=e.target,r=n.className,o=n.classList,i=n.dataset;if(t&&"rangeslider__labels"!==r){var l=a.position(e);o&&o.contains("rangeslider__label-item")&&i.value&&(l=parseFloat(i.value)),t&&t(l,e)}})),x(a,"handleEnd",(function(e){var t=a.props.onChangeComplete;a.setState({active:!1},(function(){t&&t(e)})),document.removeEventListener("mousemove",a.handleDrag),document.removeEventListener("mouseup",a.handleEnd)})),x(a,"handleKeyDown",(function(e){e.preventDefault();var t,n=e.keyCode,r=a.props,o=r.value,i=r.min,l=r.max,s=r.step,d=r.onChange;switch(n){case 38:case 39:t=o+s>l?l:o+s,d&&d(t,e);break;case 37:case 40:t=o-s<i?i:o-s,d&&d(t,e)}})),x(a,"getPositionFromValue",(function(e){var t=a.state.limit,n=a.props,r=n.min,o=(e-r)/(n.max-r);return Math.round(o*t)})),x(a,"getValueFromPosition",(function(e){var t=a.state.limit,n=a.props,r=n.orientation,o=n.min,i=n.max,s=n.step,d=(0,l.clamp)(e,0,t)/(t||1),c=s*Math.round(d*(i-o)/s),u="horizontal"===r?c+o:i-c;return(0,l.clamp)(u,o,i)})),x(a,"position",(function(e){var t=a.state.grab,n=a.props,r=n.orientation,o=n.reverse,i=a.slider,s=j.orientation[r].coordinate,d=o?j.orientation[r].reverseDirection:j.orientation[r].direction,c="client".concat((0,l.capitalize)(s)),u=e.touches?e.touches[0][c]:e[c],f=i.getBoundingClientRect()[d],h=o?f-u-t:u-f-t;return a.getValueFromPosition(h)})),x(a,"coordinates",(function(e){var t=a.state,n=t.limit,r=t.grab,o=a.props.orientation,i=a.getValueFromPosition(e),l=a.getPositionFromValue(i),s="horizontal"===o?l+r:l;return{fill:"horizontal"===o?s:n-s,handle:s,label:s}})),x(a,"renderLabels",(function(e){return(0,s.jsx)("ul",{ref:function(e){a.labels=e},className:(0,r.default)("rangeslider__labels"),children:e})})),a.state={active:!1,limit:0,grab:0},a}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.handleUpdate(),new i.default(this.handleUpdate).observe(this.slider)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,a=t.orientation,o=t.className,i=t.tooltip,l=t.reverse,d=t.labels,c=t.min,u=t.max,h=t.handleLabel,m=this.state.active,p=j.orientation[a].dimension,b=l?j.orientation[a].reverseDirection:j.orientation[a].direction,v=this.getPositionFromValue(n),g=this.coordinates(v),y=x({},p,"".concat(g.fill,"px")),w=x({},b,"".concat(g.handle,"px")),M=i&&m,_=[],N=Object.keys(d);if(N.length>0){var k,C=f(N=N.sort((function(e,t){return l?e-t:t-e})));try{for(C.s();!(k=C.n()).done;){var A=k.value,S=this.getPositionFromValue(A),O=this.coordinates(S),E=x({},b,"".concat(O.label,"px"));_.push((0,s.jsx)("li",{className:(0,r.default)("rangeslider__label-item"),"data-value":A,onMouseDown:this.handleDrag,onTouchStart:this.handleStart,onTouchEnd:this.handleEnd,style:E,children:this.props.labels[A]},A))}}catch(P){C.e(P)}finally{C.f()}}return(0,s.jsxs)("div",{ref:function(t){e.slider=t},className:(0,r.default)("rangeslider","rangeslider-".concat(a),{"rangeslider-reverse":l},o),onMouseDown:this.handleDrag,onMouseUp:this.handleEnd,onTouchStart:this.handleStart,onTouchEnd:this.handleEnd,"aria-valuemin":c,"aria-valuemax":u,"aria-valuenow":n,"aria-orientation":a,children:[(0,s.jsx)("div",{className:"rangeslider__fill",style:y}),(0,s.jsxs)("div",{ref:function(t){e.handle=t},className:"rangeslider__handle",onMouseDown:this.handleStart,onTouchMove:this.handleDrag,onTouchEnd:this.handleEnd,onKeyDown:this.handleKeyDown,style:w,tabIndex:0,children:[M&&(0,s.jsx)("div",{ref:function(t){e.tooltip=t},className:"rangeslider__handle-tooltip",children:(0,s.jsx)("span",{children:this.handleFormat(n)})}),(0,s.jsx)("div",{className:"rangeslider__handle-label",children:h})]}),d&&this.renderLabels(_)]})}}])&&m(n.prototype,a),o&&m(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,o}(a.Component);x(w,"propTypes",{min:o.default.number,max:o.default.number,step:o.default.number,value:o.default.number,orientation:o.default.string,tooltip:o.default.bool,reverse:o.default.bool,labels:o.default.object,handleLabel:o.default.string,format:o.default.func,onChangeStart:o.default.func,onChange:o.default.func,onChangeComplete:o.default.func}),x(w,"defaultProps",{min:0,max:100,step:1,value:0,orientation:"horizontal",tooltip:!0,reverse:!1,labels:{},handleLabel:""});t.default=w},2581:(e,t,n)=>{t.A=void 0;var r,a=(r=n(613))&&r.__esModule?r:{default:r};t.A=a.default},9328:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},t.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)}}}]);