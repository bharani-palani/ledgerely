"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[5265],{9595:(e,a,t)=>{t.d(a,{I:()=>n});var s=t(9950),r=t(8429);const n=()=>{const{search:e}=(0,r.zy)();return(0,s.useMemo)((()=>new URLSearchParams(e)),[e])}},5265:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(9950),r=t(3058),n=t(5358),c=t(6781),d=t(8459),l=t(4570),o=t(1308),i=t(2436),u=t(970),m=t(9288),g=t(3027),f=t(3932),p=t(9051),h=t.n(p),b=t(8311),x=t(8630),D=t(9595),M=t(3177),C=t(7391),y=t(6731),w=t(9845),j=t(2097),T=t(4414);const _=s.createContext(void 0),A=()=>{var e;const a=(0,m.A)(),t=(0,s.useContext)(o.F);document.title=`${t.appName} - ${a.formatMessage({id:"creditCard",defaultMessage:"creditCard"})}`;const p=(0,s.useContext)(i.R),A=(0,s.useContext)(C.U),S=(0,s.useContext)(w.O),[v,I]=(0,s.useState)(!1),[R,N]=(0,s.useState)(!1),[P,k]=(0,s.useState)(!0),[E,F]=(0,s.useState)({}),[O,$]=(0,s.useState)({creditCard:"",startDate:h()().startOf("month").toDate(),endDate:h()().endOf("month").toDate()}),[Y,L]=(0,s.useState)({}),V={start:0,limit:10,searchString:""},[H,K]=(0,s.useState)(V),[W,G]=(0,s.useState)(V),U={config:{header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:a.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"cCTable",Table:"creditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[a.formatMessage({id:"name",defaultMessage:"name"}),a.formatMessage({id:"date",defaultMessage:"date"}),a.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),a.formatMessage({id:"credits",defaultMessage:"credits"}),a.formatMessage({id:"purchases",defaultMessage:"purchases"}),a.formatMessage({id:"interest",defaultMessage:"interest"}),a.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},B=e=>{N(!0),L({}),setTimeout((()=>{const a=(()=>{const e=new FormData;return e.append("limit",W.limit),e.append("start",W.start),e.append("searchString",W.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","creditCardTrx"),e.append("WhereClause",`a.cc_appId = '${p.userConfig.appId}' && a.cc_for_card = '${O.creditCard}' && d.credit_card_appId = '${p.userConfig.appId}' && a.cc_date >= '${h()(O.startDate).format("YYYY-MM-DD").toString()}' && a.cc_date <= '${h()(O.endDate).format("YYYY-MM-DD").toString()}'`),l.A.post("/account_planner/getAccountPlanner",e)})();Promise.all([a]).then((a=>{L(a[0].data.response),"function"===typeof e&&e()})).catch((e=>console.log("bbb",e))).finally((()=>{N(!1),I(!0)}))}),100)};(0,s.useEffect)((()=>{(async()=>{k(!0);const e=new FormData;e.append("appId",p.userConfig.appId),l.A.post("/account_planner/credit_card_list",e).then((e=>{F(e.data.response)})).catch((e=>{console.log(e)})).finally((()=>k(!1)))})()}),[]);(0,s.useEffect)((()=>{re()}),[H]);const J=(0,D.I)(),z={fetch:J.get("fetch"),creditCardId:J.get("creditCardId"),startDate:J.get("startDate"),endDate:J.get("endDate")},[q,Q]=(0,s.useState)(!1);(0,s.useEffect)((()=>{"creditCard"===z.fetch&&z.creditCardId&&(Q(!0),$((e=>({...e,creditCard:z.creditCardId,startDate:h()(z.startDate).toDate(),endDate:h()(z.endDate).toDate()}))),G(V))}),[JSON.stringify(z)]),(0,s.useEffect)((()=>{"creditCard"===z.fetch&&O.creditCard&&O.startDate&&O.endDate&&q&&B((()=>{Q(!1),setTimeout((()=>{var e;null===(e=document.getElementById("ccTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(z),O.creditCard,q]);const X=()=>(0,T.jsx)("div",{className:"relativeSpinner",children:(0,T.jsx)(b.A,{})}),Z=["id","name","last4DigitCardNo","startDate","endDate","payDate","annuaInterestRate","localeLanguage","localeCurrency"],ee=["checkbox","textbox","textbox","number","number","number","number",{fetch:{dropDownList:j.HF},searchable:!0},{fetch:{dropDownList:j.Mi},searchable:!0}],ae=M.GG.filter((e=>"creditCardAccounts"===e.id)).map((e=>{const t={header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:A.localeLanguage,currency:A.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=t,e.TableAliasRows=Z.map((e=>a.formatMessage({id:e,defaultMessage:e}))),e.rowElements=ee,e}))[0],[te,se]=(0,s.useState)([]),re=()=>{se([]);const e=((e,a)=>{const t=new FormData;return t.append("TableRows",a),t.append("Table",e),t.append("limit",H.limit),t.append("start",H.start),t.append("searchString",H.searchString),t.append("appId",p.userConfig.appId),l.A.post("/account_planner/getAccountPlanner",t)})(ae.Table,ae.TableRows);Promise.all([e]).then((async e=>{se(e[0].data.response)}))};return(0,s.useEffect)((()=>{v&&B()}),[W,v]),(0,T.jsx)(_.Provider,{value:{cCList:E,selection:O},children:(0,T.jsxs)(n.A,{fluid:!0,className:"pb-5",children:[(0,T.jsx)(r.A,{icon:"fa fa-credit-card",intlId:"creditCard"}),P?(0,T.jsx)(X,{}):(0,T.jsxs)(T.Fragment,{children:[te&&(null===(e=Object.keys(te))||void 0===e?void 0:e.length)>0&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(x.A,{className:"pt-3",config:ae.config,Table:ae.Table,TableRows:ae.TableRows,TableAliasRows:ae.TableAliasRows,rowElements:ae.rowElements,defaultValues:ae.defaultValues,dbData:te,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:e=>(e=>{const{status:t,data:s}=e;if(200===t){if(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&p.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&p.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&S.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,T.jsx)(y.x,{}),content:(0,T.jsx)(y.E,{})}),e&&s&&"object"===typeof s.response&&null!==s.response){let e;e=1451===s.response.number?"foreignKeyDeleteMessage":"",p.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:e,defaultMessage:e})})}}else p.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(e,ae.id),apiParams:H,onChangeParams:e=>(e=>{K((a=>({...a,...e})))})(e),onReFetchData:()=>re(),cellWidth:ae.cellWidth,ajaxButtonName:a.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"credit_card_appId",value:p.userConfig.appId},theme:p.userData.theme})}),(0,T.jsxs)(c.A,{className:"align-items-center "+(!Object.keys(Y).length>0?"pb-5":""),children:[(0,T.jsx)(d.A,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:(0,T.jsx)(u.A,{placeholder:`${a.formatMessage({id:"select",defaultMessage:"select"})} ${a.formatMessage({id:"creditCard",defaultMessage:"creditCard"})}`,onChange:(e,a,t)=>{$((e=>({...e,creditCard:a})))},element:{fetch:{dropDownList:E.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:O.creditCard,type:"single",searchable:!0,theme:p.userData.theme})}),(0,T.jsxs)(d.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,T.jsx)("span",{children:(0,T.jsx)(g.A,{id:"startDate",defaultMessage:"startDate"})}),(0,T.jsx)(f.A,{className:"bg-white text-dark",value:O.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{$((a=>({...a,startDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,T.jsxs)(d.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,T.jsx)("span",{children:(0,T.jsx)(g.A,{id:"endDate",defaultMessage:"endDate"})}),(0,T.jsx)(f.A,{className:"bg-white text-dark",value:O.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{$((a=>({...a,endDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,T.jsx)(d.A,{sm:3,className:"pb-2",children:(0,T.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:()=>B(),disabled:!O.creditCard,children:(0,T.jsx)(g.A,{id:"generate",defaultMessage:"generate"})})})]})]}),R&&(0,T.jsx)(X,{}),Y&&Object.keys(Y).length>0&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("div",{className:"py-2",children:(0,T.jsx)("span",{className:"badge "+("dark"===p.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:a.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),(0,T.jsx)(x.A,{id:U.id,config:U.config,Table:U.Table,TableRows:U.TableRows,TableAliasRows:U.TableAliasRows,rowElements:U.rowElements,defaultValues:U.defaultValues,dbData:Y,cellWidth:[20,10,10,10,10,10,10],theme:p.userData.theme,apiParams:W,onChangeParams:e=>(e=>{G((a=>({...a,...e})))})(e)})]}),0===Object.keys(Y).length&&v&&!R&&(0,T.jsx)("div",{className:"text-center py-2",children:(0,T.jsx)(g.A,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}}}]);