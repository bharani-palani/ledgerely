"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[4451],{89595:(e,a,t)=>{t.d(a,{I:()=>r});var s=t(9950),n=t(28429);const r=()=>{const{search:e}=(0,n.zy)();return(0,s.useMemo)((()=>new URLSearchParams(e)),[e])}},4451:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var s=t(9950),n=t(3058),r=t(45358),l=t(86781),c=t(68459),o=t(64570),d=t(11308),i=t(92436),g=t(40970),m=t(89288),p=t(63027),u=t(53932),f=t(59051),h=t.n(f),b=t(18311),x=t(8630),M=t(89595),y=t(53177),_=t(47391),D=t(86731),T=t(99845),w=t(44414);const j=s.createContext(void 0),C=()=>{const e=(0,m.A)(),a=(0,s.useContext)(d.F);document.title=`${a.appName} - ${e.formatMessage({id:"category",defaultMessage:"category"})}`;const t=(0,s.useContext)(i.R),f=(0,s.useContext)(_.U),C=(0,s.useContext)(T.O),[A,S]=(0,s.useState)(!1),[k,v]=(0,s.useState)(!1),[I,R]=(0,s.useState)(!0),[P,N]=(0,s.useState)([]),[E,Y]=(0,s.useState)({category:"",startDate:h()().startOf("month").toDate(),endDate:h()().endOf("month").toDate()}),[F,$]=(0,s.useState)([]),[O,V]=(0,s.useState)([]),z={start:0,limit:10,searchString:""},[B,H]=(0,s.useState)(z),[L,W]=(0,s.useState)(z),[K,G]=(0,s.useState)(z),U={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"categorizedBankTrx",Table:"categorizedBankTrx",label:"Categorized bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"amount",defaultMessage:"amount"}),e.formatMessage({id:"type",defaultMessage:"type"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},J={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"catCreditCardTrx",Table:"categorizedCreditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),e.formatMessage({id:"credits",defaultMessage:"credits"}),e.formatMessage({id:"purchases",defaultMessage:"purchases"}),e.formatMessage({id:"interest",defaultMessage:"interest"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},q=e=>{v(!0),$([]),V([]),setTimeout((()=>{const a=(()=>{const e=new FormData;return e.append("limit",L.limit),e.append("start",L.start),e.append("searchString",L.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","categorizedBankTrx"),e.append("WhereClause",`a.inc_exp_appId = '${t.userConfig.appId}' && b.inc_exp_cat_id = '${E.category}' && d.bank_appId = '${t.userConfig.appId}' && a.inc_exp_date >= '${h()(E.startDate).format("YYYY-MM-DD").toString()}' && a.inc_exp_date <= '${h()(E.endDate).format("YYYY-MM-DD").toString()}'`),o.A.post("/account_planner/getAccountPlanner",e)})(),s=(()=>{const e=new FormData;return e.append("limit",K.limit),e.append("start",K.start),e.append("searchString",K.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","categorizedCreditCardTrx"),e.append("WhereClause",`a.cc_appId = '${t.userConfig.appId}' && b.inc_exp_cat_id = '${E.category}' && d.credit_card_appId = '${t.userConfig.appId}' && a.cc_date >= '${h()(E.startDate).format("YYYY-MM-DD").toString()}' && a.cc_date <= '${h()(E.endDate).format("YYYY-MM-DD").toString()}'`),o.A.post("/account_planner/getAccountPlanner",e)})();Promise.all([a,s]).then((a=>{const t=a[0].data.response,s=a[1].data.response;$(t),V(s);const n=(null===t||void 0===t?void 0:t.table.length)>0?"bank":"creditCard";"function"===typeof e&&e(n)})).catch((e=>console.log("bbb",e))).finally((()=>{v(!1),S(!0)}))}),100)};(0,s.useEffect)((()=>{(async()=>{R(!0);const e=new FormData;e.append("limit",B.limit),e.append("start",B.start),e.append("searchString",B.searchString),e.append("appId",t.userConfig.appId),o.A.post("/account_planner/inc_exp_list",e).then((e=>N(e.data.response))).catch((e=>{console.log(e)})).finally((()=>R(!1)))})()}),[B]);const Q=(0,M.I)(),X={fetch:Q.get("fetch"),categoryId:Q.get("categoryId"),startDate:Q.get("startDate"),endDate:Q.get("endDate")},[Z,ee]=(0,s.useState)(!1);(0,s.useEffect)((()=>{"category"===X.fetch&&X.categoryId&&(ee(!0),Y((e=>({...e,category:X.categoryId,startDate:h()(X.startDate).toDate(),endDate:h()(X.endDate).toDate()}))))}),[JSON.stringify(X)]),(0,s.useEffect)((()=>{"category"===X.fetch&&E.category&&E.startDate&&E.endDate&&Z&&q((e=>{ee(!1),setTimeout((()=>{var a;const t="bank"===e?"categorizedBankTrx":"catCreditCardTrx";null===(a=document.getElementById(t))||void 0===a||a.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),1e3)}))}),[JSON.stringify(X),E.category,Z]);const ae=()=>(0,w.jsx)("div",{className:"relativeSpinner",children:(0,w.jsx)(b.A,{middle:!0})}),te=["id","name","isIncomeMetric","isPlanMetric"],se=["checkbox","textbox",{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}},{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}}],ne=y.GG.filter((e=>"incExpCat"===e.id)).map((a=>{const t={header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:f.localeLanguage,currency:f.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return a.config=t,a.TableAliasRows=te.map((a=>e.formatMessage({id:a,defaultMessage:a}))),a.rowElements=se,a}))[0],[re,le]=(0,s.useState)([]),ce=()=>{le([]);const e=((e,a)=>{const s=new FormData;return s.append("TableRows",a),s.append("Table",e),s.append("limit",B.limit),s.append("start",B.start),s.append("searchString",B.searchString),s.append("appId",t.userConfig.appId),o.A.post("/account_planner/getAccountPlanner",s)})(ne.Table,ne.TableRows);Promise.all([e]).then((async e=>{le(e[0].data.response)}))};(0,s.useEffect)((()=>{ce()}),[B]);return(0,s.useEffect)((()=>{A&&q()}),[L,K,A]),(0,w.jsx)(j.Provider,{value:{incExpList:P,selection:E},children:(0,w.jsxs)(r.A,{fluid:!0,children:[(0,w.jsx)(n.A,{icon:"fa fa-sitemap",intlId:"category"}),I?(0,w.jsx)(ae,{}):(0,w.jsxs)(w.Fragment,{children:[re&&Object.keys(re).length>0&&(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(x.A,{className:"pt-3",config:ne.config,Table:ne.Table,TableRows:ne.TableRows,TableAliasRows:ne.TableAliasRows,rowElements:ne.rowElements,defaultValues:ne.defaultValues,dbData:re,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:a=>(a=>{const{status:s,data:n}=a;if(200===s){if(a&&n&&"boolean"===typeof n.response&&null!==n.response&&n.response&&t.renderToast({message:e.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),a&&n&&"boolean"===typeof n.response&&null!==n.response&&!1===n.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),a&&n&&null===n.response&&C.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,w.jsx)(D.x,{}),content:(0,w.jsx)(D.E,{})}),a&&n&&"object"===typeof n.response&&null!==n.response){let a;a=1451===n.response.number?"foreignKeyDeleteMessage":"",t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:a,defaultMessage:a})})}}else t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(a,ne.id),apiParams:B,onChangeParams:e=>(e=>{H((a=>({...a,...e})))})(e),onReFetchData:()=>ce(),cellWidth:ne.cellWidth,ajaxButtonName:e.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"inc_exp_cat_appId",value:t.userConfig.appId},theme:t.userData.theme})}),(0,w.jsxs)(l.A,{className:"align-items-center "+(Object.keys(F).length>0||Object.keys(O).length>0?"":"pb-5"),children:[(0,w.jsx)(c.A,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:(0,w.jsx)(g.A,{placeholder:`${e.formatMessage({id:"select",defaultMessage:"select"})} ${e.formatMessage({id:"category",defaultMessage:"category"})}`,onChange:(e,a,t)=>{Y((e=>({...e,category:a})))},element:{fetch:{dropDownList:P.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:E.category,type:"single",searchable:!0,theme:t.userData.theme})}),(0,w.jsxs)(c.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,w.jsx)("span",{children:(0,w.jsx)(p.A,{id:"startDate",defaultMessage:"startDate"})}),(0,w.jsx)(u.A,{className:"bg-white text-dark",value:E.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{Y((a=>({...a,startDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,w.jsxs)(c.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,w.jsx)("span",{children:(0,w.jsx)(p.A,{id:"endDate",defaultMessage:"endDate"})}),(0,w.jsx)(u.A,{className:"bg-white text-dark",value:E.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{Y((a=>({...a,endDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,w.jsx)(c.A,{sm:3,className:"pb-2",children:(0,w.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:()=>q(),disabled:k||!E.category,children:(0,w.jsx)(p.A,{id:"generate",defaultMessage:"generate"})})})]})]}),k&&(0,w.jsx)(ae,{}),F&&Object.keys(F).length>0&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"py-2",children:(0,w.jsx)("span",{className:"badge "+("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),(0,w.jsx)(x.A,{id:U.id,config:U.config,Table:U.Table,TableRows:U.TableRows,TableAliasRows:U.TableAliasRows,rowElements:U.rowElements,defaultValues:U.defaultValues,dbData:F,cellWidth:[20,7,10,5,20],theme:t.userData.theme,apiParams:L,onChangeParams:e=>(e=>{W((a=>({...a,...e})))})(e)})]}),O&&Object.keys(O).length>0>0&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{className:"py-2",children:(0,w.jsx)("span",{className:"badge "+("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),(0,w.jsx)(x.A,{id:J.id,config:J.config,Table:J.Table,TableRows:J.TableRows,TableAliasRows:J.TableAliasRows,rowElements:J.rowElements,defaultValues:J.defaultValues,dbData:O,cellWidth:[20,7,10,10,10,10,20],theme:t.userData.theme,apiParams:K,onChangeParams:e=>(e=>{G((a=>({...a,...e})))})(e)})]}),0===Object.keys(O).length&&0===Object.keys(F).length&&A&&(0,w.jsx)("div",{className:"text-center py-2",children:(0,w.jsx)(p.A,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}}}]);