(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[66],{340:function(e,a,t){"use strict";t.r(a),t.d(a,"BillingContext",(function(){return P})),t.d(a,"CurrencyPrice",(function(){return k}));var n=t(25),s=t(27),l=t(1),i=t.n(l),r=t(35),c=t(62),o=t(776),d=t(1265),u=t(1288),b=t(930),p=t(1268),m=t(933),j=t(46),f=t(52),y=t.n(f),g=t(48),O=t(0),x=Object(l.lazy)((function(){return t.e(29).then(t.bind(null,1183))})),h=Object(l.lazy)((function(){return t.e(67).then(t.bind(null,1186))})),v=Object(l.lazy)((function(){return t.e(63).then(t.bind(null,1187))})),M=Object(l.lazy)((function(){return t.e(9).then(t.bind(null,586)).then((function(e){return{default:e.CouponHeading}}))})),C=Object(l.lazy)((function(){return t.e(9).then(t.bind(null,586)).then((function(e){return{default:e.CouponContent}}))})),P=i.a.createContext(void 0),k=function(e){var a=e.amount,t=e.suffix,n=e.symbol,s=(a.toFixed(2)+"").split(".");return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("sup",{className:"fs-6",children:n}),Object(O.jsx)("span",{className:"fs-5",children:Number(s[0]).toLocaleString("en-US")}),Object(O.jsxs)("sub",{children:[".",s[1],t]})]})};a.default=function(e){var a=Object(o.a)(),t=Object(l.useContext)(r.a),i=Object(l.useContext)(c.a),f=Object(l.useState)([]),N=Object(s.a)(f,2),S=N[0],I=N[1],w=Object(l.useState)(!0),L=Object(s.a)(w,2),z=L[0],T=L[1],A=Object(l.useState)(!1),D=Object(s.a)(A,2),E=D[0],F=D[1],B=Object(l.useState)(!1),Y=Object(s.a)(B,2),U=Y[0],_=Y[1],H=Object(l.useState)({}),J=Object(s.a)(H,2),Q=J[0],R=J[1],W=Object(l.useState)([]),V=Object(s.a)(W,2),q=V[0],G=V[1],K=Object(l.useState)({}),X=Object(s.a)(K,1)[0],Z=Object(l.useState)(!1),$=Object(s.a)(Z,2),ee=$[0],ae=$[1],te={month:{prop:"planPriceMonthly",razorPayProp:"pricingMonthId",suffix:"  / ".concat(a.formatMessage({id:"month",defaultMessage:"month"}))},year:{prop:"planPriceYearly",razorPayProp:"pricingYearId",suffix:" / ".concat(a.formatMessage({id:"year",defaultMessage:"year"}))}},ne=["planBankAccountsLimit","planCreditCardAccounts","planCategoriesLimit","planUsersLimit","planTemplateLimit","planTrxLimit","planCreditCardTrxLimit","planDatasourceLimit","planWorkbookLimit","planStorageLimit","planIsTransactionSearch","planIsBulkImport","planIsEmailAlerts","planIsPredictions","visualizationLimit"],se=[{key:"planBankAccountsLimit",type:"numericNull",label:a.formatMessage({id:"bankAccounts",defaultMessage:"bankAccounts"})},{key:"planCreditCardAccounts",type:"numericNull",label:a.formatMessage({id:"creditCardAccounts",defaultMessage:"creditCardAccounts"})},{key:"planCategoriesLimit",type:"numericNull",label:a.formatMessage({id:"incExpCat",defaultMessage:"incExpCat"})},{key:"planUsersLimit",type:"numericNull",label:a.formatMessage({id:"users",defaultMessage:"users"})},{key:"planTemplateLimit",type:"numericNull",label:a.formatMessage({id:"schedules",defaultMessage:"schedules"})},{key:"planTrxLimit",type:"numericNull",label:a.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})},{key:"planCreditCardTrxLimit",type:"numericNull",label:a.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})},{key:"planDatasourceLimit",type:"bytesOrNull",label:a.formatMessage({id:"dataSource",defaultMessage:"dataSource"})},{key:"planWorkbookLimit",type:"bytesOrNull",label:a.formatMessage({id:"workbook",defaultMessage:"workbook"})},{key:"planStorageLimit",type:"bytesOrNull",label:a.formatMessage({id:"fileStorage",defaultMessage:"fileStorage"})},{key:"planIsBulkImport",type:"boolean",label:a.formatMessage({id:"bulkImport",defaultMessage:"bulkImport"})},{key:"planIsEmailAlerts",type:"boolean",label:a.formatMessage({id:"emailAlerts",defaultMessage:"emailAlerts"})},{key:"planIsPredictions",type:"boolean",label:a.formatMessage({id:"predictions",defaultMessage:"predictions"})},{key:"planIsTransactionSearch",type:"boolean",label:a.formatMessage({id:"globalSearch",defaultMessage:"globalSearch"})},{key:"visualizationLimit",type:"numericNull",label:a.formatMessage({id:"visualizations",defaultMessage:"visualizations"})}],le=[{value:"month",label:a.formatMessage({id:"monthly",defaultMessage:"monthly"})},{value:"year",label:a.formatMessage({id:"yearly",defaultMessage:"yearly"})}],ie=Object(l.useState)({currency:t.userConfig.currency,cycle:"month",razorPayCustomerId:t.userConfig.razorPayCustomerId,razorPayPlanId:"",invoice:[{id:"price",label:a.formatMessage({id:"price",defaultMessage:"price"}),value:0},{id:"creditAdjustment",label:a.formatMessage({id:"creditAdjustment",defaultMessage:"creditAdjustment"}),value:0},{id:"discount",label:a.formatMessage({id:"discount",defaultMessage:"discount"}),title:"",value:0},{id:"tax",label:a.formatMessage({id:"tax",defaultMessage:"tax"}),title:"",value:0}],total:0}),re=Object(s.a)(ie,2),ce=re[0],oe=re[1],de=Number(ce.invoice.reduce((function(e,a){return e+a.value}),0).toFixed(2));Object(l.useEffect)((function(){i.setConfig({show:!1});var e=function(){var e=new FormData;return e.append("appId",t.userConfig.appId),e.append("currency",t.userConfig.currency),e.append("env","production"),j.a.post("/payments/availableBillingPlans",e)}();return Promise.all([e]).then((function(e){I(e[0].data.response);var a=Object.keys(e[0].data.response[0]).sort((function(e,a){return ne.indexOf(e)-ne.indexOf(a)}));G(a)})).catch((function(e){return console.log(e)})).finally((function(){return T(!1)})),function(){i.setConfig({show:!1})}}),[]),Object(l.useEffect)((function(){Object.keys(X).length>0&&(null===X||void 0===X?void 0:X.percentOff)>0&&null!==X&&void 0!==X&&X.name&&i.setConfig({show:!0,className:"alert-success border-0 text-dark",type:"success",dismissible:!0,heading:Object(O.jsx)(M,{}),content:Object(O.jsx)(C,{values:{n:null===X||void 0===X?void 0:X.percentOff,y:null===X||void 0===X?void 0:X.name}})})}),[X]),Object(l.useEffect)((function(){if(null!==Q&&void 0!==Q&&Q.planId){F(!0);var e=function(){var e=new FormData;return e.append("razorPayCustomerId",ce.razorPayCustomerId),j.a.post("/payments/checkDiscounts",e)}(),a=((new FormData).append("country",t.userConfig.country),j.a.get("/payments/checkTaxes")),s=function(){var e=new FormData;return e.append("razorPayCustomerId",t.userConfig.razorPayCustomerId),e.append("razorPayPlanId",ce.razorPayPlanId),j.a.post("/payments/deductExhaustedUsage",e)}();Promise.all([e,a,s]).then((function(e){var a=e[0].data.response,t=a.name,s=a.value/100*Q[te[ce.cycle].prop];s=-Number(s.toFixed(2));var l=e[1].data.response,i=l.name,r=l.value/100*Q[te[ce.cycle].prop];r=Number(r.toFixed(2));var c=e[2].data.response.adjustmentCredit;oe((function(e){return Object(n.a)(Object(n.a)({},e),{},{invoice:e.invoice.map((function(e){return"discount"===e.id&&Object.assign(e,{title:t&&(null===a||void 0===a?void 0:a.value)>0?"".concat(t," - ").concat(null===a||void 0===a?void 0:a.value,"%"):null,value:s}),"tax"===e.id&&Object.assign(e,{title:i,value:r}),"creditAdjustment"===e.id?Object.assign(e,{value:c}):e}))})}))})).catch((function(e){return console.log(e)})).finally((function(){return F(!1)}))}}),[Q.planId,ce.cycle]);var ue=function(e){var t=e.planPriceMonthly,n=e.planPriceYearly,s=e.isPlanOptable,l=e.planPriceCurrencySymbol;return Object(O.jsxs)("div",{style:s?{}:{textDecoration:"line-through"},className:"d-flex align-items-center justify-content-center text-center",children:[Object(O.jsx)("div",{className:"pe-2",children:Object(O.jsx)(k,{amount:t,suffix:" / ".concat(a.formatMessage({id:"month",defaultMessage:"month"})),symbol:l})}),Object(O.jsx)("div",{className:"w-50",children:Object(O.jsx)(k,{amount:n,suffix:" / ".concat(a.formatMessage({id:"year",defaultMessage:"year"})),symbol:l})})]})},be=function(e){var a=e.planTitle,t=e.planDescription;return Object(O.jsxs)("div",{className:"text-center py-2",children:[Object(O.jsx)("div",{className:"fs-4",children:Object(O.jsx)(d.a,{id:a,defaultMessage:a})}),Object(O.jsx)("div",{style:{fontSize:"0.75rem"},children:Object(O.jsx)(d.a,{id:t,defaultMessage:t})})]})},pe=function(n){var s=n.planName,l=n.planCode,i=n.isPlanOptable;return Object(O.jsxs)("div",{className:"bni-bg rounded-top text-dark px-2 py-1 d-flex align-items-center justify-content-between",children:[Object(O.jsxs)("div",{style:i?{}:{textDecoration:"line-through"},children:[Q.planCode===l&&Object(O.jsx)("i",{className:"fa fa-check-circle pe-1"}),Object(O.jsx)("span",{children:Object(O.jsx)(d.a,{id:s,defaultMessage:s})}),!i&&Object(O.jsx)(u.a,{placement:"right",delay:{show:250,hide:400},overlay:me(e,a.formatMessage({id:"maximumQuotaExceeded",defaultMessage:"maximumQuotaExceeded"})),triggerType:"hover",children:Object(O.jsx)("i",{className:"fa fa-info-circle ps-1 cursor-pointer"})})]}),t.userConfig.planCode===l&&Object(O.jsx)("div",{children:Object(O.jsx)("span",{className:"badge rounded-pill bg-dark",children:Object(O.jsx)(d.a,{id:"currentPlan",defaultMessage:"currentPlan"})})})]})},me=function(e,a){return Object(O.jsx)(b.a,{id:"button-tooltip-".concat(Math.random()),className:"in show",children:a})},je=function(e){var a,t,n,s,l=e.obj,i=e.t,r=se.filter((function(e){return e.key===l})),c=null===(a=r[0])||void 0===a?void 0:a.label,o="";return o="numericNull"===(null===(t=r[0])||void 0===t?void 0:t.type)?null!==i[l]?i[l]:Object(O.jsx)("span",{className:"text-success",children:"\u221e"}):"bytesOrNull"===(null===(n=r[0])||void 0===n?void 0:n.type)?null!==i[l]?"".concat(i[l]/1024/1024," MB"):Object(O.jsx)("span",{className:"text-success",children:"\u221e"}):"boolean"===(null===(s=r[0])||void 0===s?void 0:s.type)?i[l]?Object(O.jsx)("i",{className:"fa fa-check text-success"}):Object(O.jsx)("i",{className:"fa fa-times text-danger"}):i[l],Object(O.jsxs)("div",{className:"d-flex align-items-center justify-content-between pb-1",children:[Object(O.jsx)("div",{children:c}),Object(O.jsx)("div",{children:o})]})},fe=function(){return Object(O.jsx)("div",{className:"relativeSpinner middle",children:Object(O.jsx)(y.a,{type:g.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},ye=function(e){R(e),ge(e),setTimeout((function(){window.scrollTo(0,document.body.scrollHeight)}),1e3)},ge=function(e){if(e.isPlanOptable){var a=S.filter((function(a){return a.planCode===e.planCode}))[0].planPriceMonthly,t=S.filter((function(a){return a.planCode===e.planCode}))[0].pricingMonthId;oe((function(e){return Object(n.a)(Object(n.a)({},e),{},{razorPayPlanId:t,cycle:le[0].value,invoice:e.invoice.map((function(e){return"price"===e.id?Object.assign(e,{value:a}):e}))})}))}},Oe=function(e){return Number(e.planPriceMonthly)&&Number(e.planPriceYearly)?Object(O.jsx)("button",{onClick:function(){return ye(e)},disabled:!e.isPlanOptable,className:"w-100 btn btn-bni p-1 rounded-top-0 border-0",title:"Subscribe now",children:Object(O.jsx)(ue,{planPriceMonthly:e.planPriceMonthly,planPriceYearly:e.planPriceYearly,isPlanOptable:e.isPlanOptable,planPriceCurrencySymbol:e.planPriceCurrencySymbol})}):Object(O.jsx)("button",{disabled:!e.isPlanOptable,className:"w-100 btn btn-bni rounded-top-0 border-0 py-1",children:Object(O.jsx)("div",{className:"py-1",children:Object(O.jsx)(d.a,{id:"free",defaultMessage:"free"})})})};return Object(O.jsx)(l.Suspense,{fallback:fe(),children:Object(O.jsxs)(P.Provider,{value:{summary:ce,setSummary:oe,cycleList:le,table:S,selectedPlan:Q,cycleRef:te,total:de,billingLoader:E,showSessionPopup:ee,setShowSessionPopup:ae,subscribeLoader:U,setSubscribeLoader:_},children:[ee&&Object(O.jsx)(v,{}),Object(O.jsxs)("div",{className:"container-fluid",children:[Object(O.jsx)("div",{className:"bg-gradient ".concat("dark"===t.userData.theme?"bg-dark darkBoxShadow":"bg-white lightBoxShadow"," mt-2 ps-3 py-2 rounded-pill mb-4"),children:Object(O.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:Object(O.jsxs)("div",{className:"d-flex align-items-center",children:[Object(O.jsx)("i",{className:"fa fa-credit-card-alt fa-1x"}),Object(O.jsx)("div",{className:"ps-2 mb-0",children:Object(O.jsx)(d.a,{id:"billing",defaultMessage:"billing"})})]})})}),z&&fe(),!z&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{children:S&&S.length>0&&Object(O.jsx)(p.a,{className:"",children:S.map((function(e,a){return Object(O.jsx)(m.a,{md:6,lg:3,className:"pb-3",children:Object(O.jsxs)("div",{className:"rounded-3 border ".concat("dark"===t.userData.theme?"border-black":"border-1"," ").concat(e.isPlanOptable?"cursor-pointer":"cursor-not-allowed"," ").concat(Q.planCode===e.planCode?"animate__animated animate__headShake":""),style:Q.planCode===e.planCode?{boxShadow:"0 2px 10px 0 #000"}:{},onClick:function(){return e.isPlanOptable&&ye(e)},children:[Object(O.jsx)(pe,Object(n.a)({},e)),Object(O.jsx)(be,Object(n.a)({},e)),Object(O.jsx)("div",{className:"p-2",children:q.filter((function(e){return!["planId","planCode","planName","planTitle","planDescription","planIsActive","planPriceMonthly","planPriceYearly","planPriceCurrencySymbol","pricingMonthId","pricingYearId"].includes(e)})).map((function(a,t){return Object(O.jsx)(je,{obj:a,t:e},t)}))}),Object(O.jsx)(Oe,Object(n.a)({},e))]})},a)}))})}),Object(O.jsx)(x,{}),Object(O.jsx)("hr",{className:"mt-5"}),Object(O.jsx)(p.a,{children:Object(O.jsx)(m.a,{sm:6,children:Object(O.jsx)(h,{})})})]})]})]})})}}}]);