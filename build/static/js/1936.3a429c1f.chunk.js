"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[1936],{1936:(e,a,s)=>{s.r(a),s.d(a,{BillingContext:()=>v,CurrencyPrice:()=>M,default:()=>C});var l=s(9950),t=s(2436),n=s(9845),i=s(9288),r=s(3027),o=s(1432),d=s(5942),c=s(6781),u=s(8459),p=s(1308),m=s(4570),f=s(8311),y=s(4414);const b=(0,l.lazy)((()=>s.e(5031).then(s.bind(s,5031)))),g=(0,l.lazy)((()=>s.e(5160).then(s.bind(s,5160)))),x=(0,l.lazy)((()=>s.e(3209).then(s.bind(s,3209)))),h=(0,l.lazy)((()=>s.e(7575).then(s.bind(s,7575)).then((e=>({default:e.CouponHeading}))))),j=(0,l.lazy)((()=>s.e(7575).then(s.bind(s,7575)).then((e=>({default:e.CouponContent}))))),v=l.createContext(void 0),M=e=>{let{amount:a,suffix:s,symbol:l}=e;const t=(a.toFixed(2)+"").split(".");return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("sup",{className:"fs-6",children:l}),(0,y.jsx)("span",{className:"fs-5",children:Number(t[0]).toLocaleString("en-US")}),(0,y.jsxs)("sub",{children:[".",t[1],s]})]})},C=e=>{const a=(0,i.A)(),s=(0,l.useContext)(p.F);document.title=`${s.appName} - ${a.formatMessage({id:"billing",defaultMessage:"billing"})}`;const C=(0,l.useContext)(t.R),k=(0,l.useContext)(n.O),[P,N]=(0,l.useState)([]),[S,A]=(0,l.useState)(!0),[I,w]=(0,l.useState)(!1),[L,O]=(0,l.useState)(!1),[z,T]=(0,l.useState)({}),[D,$]=(0,l.useState)([]),[F]=(0,l.useState)({}),[E,B]=(0,l.useState)(!1),Y={month:{prop:"planPriceMonthly",razorPayProp:"pricingMonthId",suffix:`  / ${a.formatMessage({id:"month",defaultMessage:"month"})}`},year:{prop:"planPriceYearly",razorPayProp:"pricingYearId",suffix:` / ${a.formatMessage({id:"year",defaultMessage:"year"})}`}},_=["planBankAccountsLimit","planCreditCardAccounts","planCategoriesLimit","planUsersLimit","planTemplateLimit","planTrxLimit","planCreditCardTrxLimit","planDatasourceLimit","planWorkbookLimit","planStorageLimit","planIsTransactionSearch","planIsBulkImport","planIsEmailAlerts","planIsPredictions","visualizationLimit"],U=[{key:"planBankAccountsLimit",type:"numericNull",label:a.formatMessage({id:"bankAccounts",defaultMessage:"bankAccounts"})},{key:"planCreditCardAccounts",type:"numericNull",label:a.formatMessage({id:"creditCardAccounts",defaultMessage:"creditCardAccounts"})},{key:"planCategoriesLimit",type:"numericNull",label:a.formatMessage({id:"incExpCat",defaultMessage:"incExpCat"})},{key:"planUsersLimit",type:"numericNull",label:a.formatMessage({id:"users",defaultMessage:"users"})},{key:"planTemplateLimit",type:"numericNull",label:a.formatMessage({id:"schedules",defaultMessage:"schedules"})},{key:"planTrxLimit",type:"numericNull",label:a.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})},{key:"planCreditCardTrxLimit",type:"numericNull",label:a.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})},{key:"planDatasourceLimit",type:"bytesOrNull",label:a.formatMessage({id:"dataSource",defaultMessage:"dataSource"})},{key:"planWorkbookLimit",type:"bytesOrNull",label:a.formatMessage({id:"workbook",defaultMessage:"workbook"})},{key:"planStorageLimit",type:"bytesOrNull",label:a.formatMessage({id:"fileStorage",defaultMessage:"fileStorage"})},{key:"planIsBulkImport",type:"boolean",label:a.formatMessage({id:"bulkImport",defaultMessage:"bulkImport"})},{key:"planIsEmailAlerts",type:"boolean",label:a.formatMessage({id:"emailAlerts",defaultMessage:"emailAlerts"})},{key:"planIsPredictions",type:"boolean",label:a.formatMessage({id:"predictions",defaultMessage:"predictions"})},{key:"planIsTransactionSearch",type:"boolean",label:a.formatMessage({id:"globalSearch",defaultMessage:"globalSearch"})},{key:"visualizationLimit",type:"numericNull",label:a.formatMessage({id:"visualizations",defaultMessage:"visualizations"})}],H=[{value:"month",label:a.formatMessage({id:"monthly",defaultMessage:"monthly"})},{value:"year",label:a.formatMessage({id:"yearly",defaultMessage:"yearly"})}],[Q,R]=(0,l.useState)({currency:C.userConfig.currency,cycle:"month",razorPayCustomerId:C.userConfig.razorPayCustomerId,razorPayPlanId:"",invoice:[{id:"price",label:a.formatMessage({id:"price",defaultMessage:"price"}),value:0},{id:"creditAdjustment",label:a.formatMessage({id:"creditAdjustment",defaultMessage:"creditAdjustment"}),value:0},{id:"discount",label:a.formatMessage({id:"discount",defaultMessage:"discount"}),title:"",value:0},{id:"tax",label:a.formatMessage({id:"tax",defaultMessage:"tax"}),title:"",value:0}],total:0}),W=Number(Q.invoice.reduce(((e,a)=>e+a.value),0).toFixed(2));(0,l.useEffect)((()=>{k.setConfig({show:!1});const e=(()=>{const e=new FormData;return e.append("appId",C.userConfig.appId),e.append("currency",C.userConfig.currency),m.A.post("/payments/availableBillingPlans",e)})();return Promise.all([e]).then((e=>{N(e[0].data.response);const a=Object.keys(e[0].data.response[0]).sort(((e,a)=>_.indexOf(e)-_.indexOf(a)));$(a)})).catch((e=>console.log(e))).finally((()=>A(!1))),()=>{k.setConfig({show:!1})}}),[]),(0,l.useEffect)((()=>{Object.keys(F).length>0&&(null===F||void 0===F?void 0:F.percentOff)>0&&null!==F&&void 0!==F&&F.name&&k.setConfig({show:!0,className:"alert-success border-0 text-dark",type:"success",dismissible:!0,heading:(0,y.jsx)(h,{}),content:(0,y.jsx)(j,{values:{n:null===F||void 0===F?void 0:F.percentOff,y:null===F||void 0===F?void 0:F.name}})})}),[F]),(0,l.useEffect)((()=>{if(null!==z&&void 0!==z&&z.planId){w(!0);const e=(()=>{const e=new FormData;return e.append("razorPayCustomerId",Q.razorPayCustomerId),m.A.post("/payments/checkDiscounts",e)})(),a=((new FormData).append("country",C.userConfig.country),m.A.get("/payments/checkTaxes")),s=(()=>{const e=new FormData;return e.append("razorPayCustomerId",C.userConfig.razorPayCustomerId),e.append("razorPayPlanId",Q.razorPayPlanId),m.A.post("/payments/deductExhaustedUsage",e)})();Promise.all([e,a,s]).then((e=>{const a=e[0].data.response,s=a.name;let l=a.value/100*z[Y[Q.cycle].prop];l=-Number(l.toFixed(2));const t=e[1].data.response,n=t.name;let i=t.value/100*z[Y[Q.cycle].prop];i=Number(i.toFixed(2));const r=e[2].data.response,{adjustmentCredit:o}=r;R((e=>({...e,invoice:e.invoice.map((e=>("discount"===e.id&&Object.assign(e,{title:s&&(null===a||void 0===a?void 0:a.value)>0?`${s} - ${null===a||void 0===a?void 0:a.value}%`:null,value:l}),"tax"===e.id&&Object.assign(e,{title:n,value:i}),"creditAdjustment"===e.id?Object.assign(e,{value:o}):e)))})))})).catch((e=>console.log(e))).finally((()=>w(!1)))}}),[z.planId,Q.cycle]);const q=e=>{let{planPriceMonthly:s,planPriceYearly:l,isPlanOptable:t,planPriceCurrencySymbol:n}=e;return(0,y.jsxs)("div",{style:t?{}:{textDecoration:"line-through"},className:"d-flex align-items-center justify-content-center text-center",children:[(0,y.jsx)("div",{className:"pe-2",children:(0,y.jsx)(M,{amount:s,suffix:` / ${a.formatMessage({id:"month",defaultMessage:"month"})}`,symbol:n})}),(0,y.jsx)("div",{className:"w-50",children:(0,y.jsx)(M,{amount:l,suffix:` / ${a.formatMessage({id:"year",defaultMessage:"year"})}`,symbol:n})})]})},G=e=>{let{planTitle:a,planDescription:s}=e;return(0,y.jsxs)("div",{className:"text-center py-2",children:[(0,y.jsx)("div",{className:"fs-4",children:(0,y.jsx)(r.A,{id:a,defaultMessage:a})}),(0,y.jsx)("div",{style:{fontSize:"0.75rem"},children:(0,y.jsx)(r.A,{id:s,defaultMessage:s})})]})},J=s=>{let{planName:l,planCode:t,isPlanOptable:n}=s;return(0,y.jsxs)("div",{className:"bni-bg rounded-top text-dark px-2 py-1 d-flex align-items-center justify-content-between",children:[(0,y.jsxs)("div",{style:n?{}:{textDecoration:"line-through"},children:[z.planCode===t&&(0,y.jsx)("i",{className:"fa fa-check-circle pe-1"}),(0,y.jsx)("span",{children:(0,y.jsx)(r.A,{id:l,defaultMessage:l})}),!n&&(0,y.jsx)(o.A,{placement:"right",delay:{show:250,hide:400},overlay:K(e,a.formatMessage({id:"maximumQuotaExceeded",defaultMessage:"maximumQuotaExceeded"})),triggerType:"hover",children:(0,y.jsx)("i",{className:"fa fa-info-circle ps-1 cursor-pointer"})})]}),C.userConfig.planCode===t&&(0,y.jsx)("div",{children:(0,y.jsx)("span",{className:"badge rounded-pill bg-dark",children:(0,y.jsx)(r.A,{id:"currentPlan",defaultMessage:"currentPlan"})})})]})},K=(e,a)=>(0,y.jsx)(d.A,{id:`button-tooltip-${Math.random()}`,className:"in show",children:a}),V=e=>{var a,s,l,t;let{obj:n,t:i}=e;const r=U.filter((e=>e.key===n)),o=null===(a=r[0])||void 0===a?void 0:a.label;let d="";return d="numericNull"===(null===(s=r[0])||void 0===s?void 0:s.type)?null!==i[n]?i[n]:(0,y.jsx)("span",{className:"text-success",children:"\u221e"}):"bytesOrNull"===(null===(l=r[0])||void 0===l?void 0:l.type)?null!==i[n]?i[n]/1024/1024+" MB":(0,y.jsx)("span",{className:"text-success",children:"\u221e"}):"boolean"===(null===(t=r[0])||void 0===t?void 0:t.type)?i[n]?(0,y.jsx)("i",{className:"fa fa-check text-success"}):(0,y.jsx)("i",{className:"fa fa-times text-danger"}):i[n],(0,y.jsxs)("div",{className:"d-flex align-items-center justify-content-between pb-1",children:[(0,y.jsx)("div",{children:o}),(0,y.jsx)("div",{children:d})]})},X=()=>(0,y.jsx)("div",{className:"relativeSpinner middle",children:(0,y.jsx)(f.A,{})}),Z=e=>{T(e),ee(e),setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),1e3)},ee=e=>{if(e.isPlanOptable){const a=P.filter((a=>a.planCode===e.planCode))[0].planPriceMonthly,s=P.filter((a=>a.planCode===e.planCode))[0].pricingMonthId;R((e=>({...e,razorPayPlanId:s,cycle:H[0].value,invoice:e.invoice.map((e=>"price"===e.id?Object.assign(e,{value:a}):e))})))}},ae=e=>Number(e.planPriceMonthly)&&Number(e.planPriceYearly)?(0,y.jsx)("button",{onClick:()=>Z(e),disabled:!e.isPlanOptable,className:"w-100 btn btn-bni p-1 rounded-top-0 border-0",title:"Subscribe now",children:(0,y.jsx)(q,{planPriceMonthly:e.planPriceMonthly,planPriceYearly:e.planPriceYearly,isPlanOptable:e.isPlanOptable,planPriceCurrencySymbol:e.planPriceCurrencySymbol})}):(0,y.jsx)("button",{disabled:!e.isPlanOptable,className:"w-100 btn btn-bni rounded-top-0 border-0 py-1",children:(0,y.jsx)("div",{className:"py-1",children:(0,y.jsx)(r.A,{id:"free",defaultMessage:"free"})})});return(0,y.jsx)(l.Suspense,{fallback:X(),children:(0,y.jsxs)(v.Provider,{value:{summary:Q,setSummary:R,cycleList:H,table:P,selectedPlan:z,cycleRef:Y,total:W,billingLoader:I,showSessionPopup:E,setShowSessionPopup:B,subscribeLoader:L,setSubscribeLoader:O},children:[E&&(0,y.jsx)(x,{}),(0,y.jsxs)("div",{className:"container-fluid",children:[(0,y.jsx)("div",{className:`bg-gradient ${"dark"===C.userData.theme?"bg-dark darkBoxShadow":"bg-white lightBoxShadow"} mt-2 ps-3 py-2 rounded-pill mb-4`,children:(0,y.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:(0,y.jsxs)("div",{className:"d-flex align-items-center",children:[(0,y.jsx)("i",{className:"fa fa-credit-card-alt fa-1x"}),(0,y.jsx)("div",{className:"ps-2 mb-0",children:(0,y.jsx)(r.A,{id:"billing",defaultMessage:"billing"})})]})})}),S&&X(),!S&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{children:P&&P.length>0&&(0,y.jsx)(c.A,{className:"",children:P.map(((e,a)=>(0,y.jsx)(u.A,{md:6,lg:3,className:"pb-3",children:(0,y.jsxs)("div",{className:`rounded-3 border ${"dark"===C.userData.theme?"border-black":"border-1"} ${e.isPlanOptable?"cursor-pointer":"cursor-not-allowed"} ${z.planCode===e.planCode?"animate__animated animate__headShake":""}`,style:z.planCode===e.planCode?{boxShadow:"0 2px 10px 0 #000"}:{},onClick:()=>e.isPlanOptable&&Z(e),children:[(0,y.jsx)(J,{...e}),(0,y.jsx)(G,{...e}),(0,y.jsx)("div",{className:"p-2",children:D.filter((e=>!["planId","planCode","planName","planTitle","planDescription","planIsActive","planPriceMonthly","planPriceYearly","planPriceCurrencySymbol","pricingMonthId","pricingYearId"].includes(e))).map(((a,s)=>(0,y.jsx)(V,{obj:a,t:e},s)))}),(0,y.jsx)(ae,{...e})]})},a)))})}),(0,y.jsx)(b,{}),(0,y.jsx)("hr",{className:"mt-5"}),(0,y.jsx)(c.A,{children:(0,y.jsx)(u.A,{sm:6,children:(0,y.jsx)(g,{})})})]})]})]})})}}}]);