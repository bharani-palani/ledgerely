{"version":3,"file":"static/js/4855.5edbed6c.chunk.js","mappings":"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","sources":["components/resuable/SortableItem.js","components/workbook/SheetPane.js"],"sourcesContent":["import React from \"react\";\nimport { useSortable } from \"@dnd-kit/sortable\";\nimport { CSS } from \"@dnd-kit/utilities\";\n\nexport function SortableItem(props) {\n  const { children } = props;\n  const { attributes, listeners, setNodeRef, transform, transition } =\n    useSortable({ id: props.id });\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n  };\n\n  return (\n    <div ref={setNodeRef} style={style} {...attributes} {...listeners}>\n      {children}\n    </div>\n  );\n}\n","import React, { useContext, useEffect, useRef, useState } from \"react\";\nimport WorkbookContext from \"./WorkbookContext\";\nimport { Popover, OverlayTrigger, Modal, Form, Button } from \"react-bootstrap\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport ConfirmationModal from \"../configuration//Gallery/ConfirmationModal\";\nimport { WORKBOOK_CONFIG } from \"../shared/D3/constants\";\nimport { UserContext } from \"../../contexts/UserContext\";\nimport Slider from \"@appigram/react-rangeslider\";\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  TouchSensor,\n  useSensor,\n  useSensors,\n} from \"@dnd-kit/core\";\nimport {\n  arrayMove,\n  SortableContext,\n  sortableKeyboardCoordinates,\n  horizontalListSortingStrategy,\n} from \"@dnd-kit/sortable\";\nimport { SortableItem } from \"../resuable/SortableItem\";\n\nconst SheetPane = props => {\n  const intl = useIntl();\n  const workbookContext = useContext(WorkbookContext);\n  const userContext = useContext(UserContext);\n  const {\n    sheets,\n    setSheets,\n    theme,\n    activeSheet,\n    setActiveSheet,\n    setActiveChart,\n  } = workbookContext;\n  const { styles } = props;\n  const zoom = sheets.filter(f => f.id === activeSheet)[0]?.zoom;\n  const minZoom = 100;\n  const maxZoom = 200;\n  const [openModal, setOpenModal] = useState({\n    state: false,\n    id: null,\n    label: null,\n    source: null,\n  });\n  const elementRef = useRef([]);\n  // const parentRef = useRef(null);\n\n  useEffect(() => {\n    const firstIndex = sheets[0].id;\n    setActiveSheet(firstIndex);\n  }, []);\n\n  const popover = sheetObj => (\n    <Popover id='popover-basic'>\n      <Popover.Header as='div' className={`bni-bg bni-text`}>\n        <FormattedMessage id='action' defaultMessage='action' />\n      </Popover.Header>\n      <Popover.Body className='p-0'>\n        <ul className='list-group list-group-flush'>\n          <li\n            className={`list-group-item cursor-pointer`}\n            onClick={() =>\n              setOpenModal(prev => ({\n                ...prev,\n                state: true,\n                id: sheetObj.id,\n                label: sheetObj.label,\n                source: \"rename\",\n              }))\n            }\n          >\n            <FormattedMessage id='rename' defaultMessage='rename' />\n          </li>\n          {sheets.length > 1 && (\n            <li\n              className='list-group-item cursor-pointer text-danger'\n              onClick={() =>\n                setOpenModal(prev => ({\n                  ...prev,\n                  state: true,\n                  id: sheetObj.id,\n                  label: sheetObj.label,\n                  source: \"delete\",\n                }))\n              }\n            >\n              <FormattedMessage id='delete' defaultMessage='delete' />\n            </li>\n          )}\n          <li\n            onClick={() => onDuplicate(sheetObj)}\n            className='list-group-item cursor-pointer rounded-bottom'\n          >\n            <FormattedMessage id='clone' defaultMessage='clone' />\n          </li>\n        </ul>\n      </Popover.Body>\n    </Popover>\n  );\n\n  const onDuplicate = sheetObj => {\n    if (sheets.length < WORKBOOK_CONFIG.sheetLimit) {\n      const cloneObj = { ...sheetObj };\n      const newSheetId = uuidv4();\n      const newSheet = {\n        id: newSheetId,\n        order: sheets.length,\n        label: `${cloneObj.label} (${intl.formatMessage({\n          id: \"clone\",\n          defaultMessage: \"clone\",\n        })})`.substring(0, 15),\n        charts: cloneObj.charts,\n        zoom: cloneObj.zoom,\n      };\n      const bSheets = [...sheets, newSheet];\n      setSheets(bSheets);\n      setTimeout(() => {\n        setActiveSheet(newSheetId);\n      }, [500]);\n    } else {\n      userContext.renderToast({\n        type: \"warn\",\n        icon: \"fa fa-exclamation-triangle\",\n        position: \"bottom-center\",\n        message: intl.formatMessage({\n          id: \"sheetLimitExceeded\",\n          defaultMessage: \"sheetLimitExceeded\",\n        }),\n      });\n    }\n  };\n\n  const onAddSheet = () => {\n    if (sheets.length < WORKBOOK_CONFIG.sheetLimit) {\n      const newSheetId = uuidv4();\n      const newObject = {\n        id: newSheetId,\n        order: sheets.length,\n        label: `${intl.formatMessage({\n          id: \"sheet\",\n          defaultMessage: \"sheet\",\n        })} ${sheets.length + 1}`,\n        charts: [],\n        zoom: 100,\n      };\n      const newArray = [...sheets, newObject];\n      setSheets(newArray);\n      setTimeout(() => {\n        setActiveSheet(newSheetId);\n      }, 500);\n    } else {\n      userContext.renderToast({\n        type: \"warn\",\n        icon: \"fa fa-exclamation-triangle\",\n        position: \"bottom-center\",\n        message: intl.formatMessage({\n          id: \"sheetLimitExceeded\",\n          defaultMessage: \"sheetLimitExceeded\",\n        }),\n      });\n    }\n  };\n\n  const onSortEnd = ({ active, over }) => {\n    if (active.id !== over.id) {\n      const oldIndex = sheets.findIndex(({ id }) => id === active.id);\n      const newIndex = sheets.findIndex(({ id }) => id === over.id);\n      const movedArray = arrayMove(sheets, oldIndex, newIndex);\n      setSheets(movedArray);\n    }\n  };\n\n  const OnRename = () => {\n    const id = openModal.id;\n    const newSheets = sheets.map((s, i) => {\n      if (s.id === id) {\n        return { ...s, label: openModal.label };\n      }\n      return s;\n    });\n    setSheets(newSheets);\n    setOpenModal(prev => ({\n      ...prev,\n      state: false,\n      id: null,\n      label: null,\n      source: null,\n    }));\n  };\n\n  const onDeleteSheet = () => {\n    const id = openModal.id;\n    const newSheets = sheets.filter(s => s.id !== id);\n    setSheets(newSheets);\n    setActiveSheet(() => newSheets[0].id);\n    setOpenModal(prev => ({\n      ...prev,\n      state: false,\n      id: null,\n      label: null,\n      source: null,\n    }));\n  };\n\n  const onMoveSheet = incDec => {\n    let selectedOrder = sheets.findIndex(s => s.id === activeSheet);\n    selectedOrder = incDec ? selectedOrder + 1 : selectedOrder - 1;\n    if (selectedOrder > -1 && selectedOrder < sheets.length) {\n      const newSheetId = sheets[selectedOrder].id;\n      setActiveSheet(newSheetId);\n    }\n  };\n\n  useEffect(() => {\n    const selectedOrder = sheets.findIndex(s => s.id === activeSheet);\n    elementRef?.current[selectedOrder]?.scrollIntoView({\n      inline: \"start\",\n    });\n    setActiveChart(\"\");\n  }, [activeSheet]);\n\n  const onZoom = val => {\n    const newSheets = sheets.map(s => {\n      if (s.id === activeSheet) {\n        s.zoom = val;\n      }\n      return s;\n    });\n    setSheets(newSheets);\n  };\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 5,\n      },\n    }),\n    useSensor(TouchSensor, {\n      activationConstraint: {\n        distance: 5,\n      },\n    }),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    }),\n  );\n\n  return (\n    <>\n      <ConfirmationModal\n        show={openModal.state && openModal.source === \"delete\"}\n        confirmationstring={intl.formatMessage({\n          id: \"areYouSureToDeleteSheet\",\n          defaultMessage: \"areYouSureToDeleteSheet\",\n        })}\n        handleHide={() => {\n          setOpenModal(prev => ({\n            ...prev,\n            state: false,\n            id: null,\n            label: null,\n            source: null,\n          }));\n        }}\n        handleYes={() => onDeleteSheet()}\n        size='md'\n      />\n      <Modal\n        {...props}\n        style={{ zIndex: 10000 }}\n        show={openModal.state && openModal.source === \"rename\"}\n        onHide={() =>\n          setOpenModal(prev => ({\n            ...prev,\n            state: false,\n            id: null,\n            label: null,\n            source: null,\n          }))\n        }\n        size='sm'\n        animation={false}\n        centered={true}\n        backdrop='static'\n      >\n        <Modal.Header>\n          <Modal.Title>\n            <FormattedMessage id='rename' defaultMessage='rename' />\n          </Modal.Title>\n        </Modal.Header>\n        <Modal.Body\n          className={`container-fluid rounded-bottom ${\n            theme === \"dark\" ? \"bg-dark text-white\" : \"bg-white text-dark\"\n          }`}\n        >\n          <Form.Control\n            type='text'\n            maxLength={15}\n            placeholder={intl.formatMessage(\n              { id: \"maxLetters\", defaultMessage: \"maxLetters\" },\n              { n: 15 },\n            )}\n            className='mb-2'\n            onChange={e =>\n              setOpenModal(prev => ({ ...prev, label: e.target.value }))\n            }\n            value={openModal.label}\n          />\n          <div className='d-flex'>\n            <Button\n              variant={`btn btn-${theme} w-50 me-2`}\n              onClick={() =>\n                setOpenModal(prev => ({\n                  ...prev,\n                  state: false,\n                  id: null,\n                  label: null,\n                }))\n              }\n            >\n              <FormattedMessage id='cancel' defaultMessage='cancel' />\n            </Button>\n            <Button\n              variant='btn btn-bni w-50'\n              disabled={!openModal?.label?.length}\n              onClick={() => OnRename()}\n            >\n              <FormattedMessage id='submit' defaultMessage='submit' />\n            </Button>\n          </div>\n        </Modal.Body>\n      </Modal>\n      <div\n        className={`d-flex justify-content-between border border-1 ${\n          theme === \"dark\" ? \"border-secondary\" : \"\"\n        } rounded-bottom border-top-0`}\n        style={{ ...styles }}\n      >\n        <button\n          className='btn btn-sm btn-bni border-0 px-3'\n          onClick={onAddSheet}\n          style={{\n            borderRadius: \"0px 0px 0px 5px\",\n          }}\n        >\n          <i className='fa fa-plus' />\n        </button>\n        <button\n          onClick={() => onMoveSheet(0)}\n          className={`btn btn-sm btn-${\n            theme === \"dark\" ? \"dark\" : \"white\"\n          } border-0 border-end px-2 rounded-0`}\n          disabled={sheets.findIndex(s => s.id === activeSheet) === 0}\n        >\n          <i className='fa fa-chevron-left' />\n        </button>\n        <div className='d-flex w-75 flex-row overflow-hidden'>\n          <DndContext\n            sensors={sensors}\n            collisionDetection={closestCenter}\n            onDragEnd={onSortEnd}\n          >\n            <SortableContext\n              items={sheets}\n              strategy={horizontalListSortingStrategy}\n            >\n              {sheets.map((sheet, i) => {\n                return (\n                  <SortableItem key={sheet.id} id={sheet.id}>\n                    <div\n                      className={`cursor-pointer d-flex border-3 align-items-center bg-${\n                        theme === \"dark\" ? \"dark\" : \"white\"\n                      }`}\n                      ref={ref => {\n                        elementRef.current[i] = ref;\n                      }}\n                    >\n                      <OverlayTrigger\n                        trigger='click'\n                        placement='top'\n                        overlay={popover(sheet)}\n                        rootClose\n                      >\n                        <i className={`fa fa-cog px-2`} />\n                      </OverlayTrigger>\n                      <div\n                        style={{ minWidth: 130 }}\n                        className={`rounded-0 btn btn-sm btn-${\n                          activeSheet === sheet.id ? \"bni\" : theme\n                        } border-0 border-end ${\n                          theme === \"dark\" ? \"border-secondary\" : \"\"\n                        }`}\n                        onClick={() => setActiveSheet(sheet.id)}\n                      >\n                        {sheet.label}\n                      </div>\n                    </div>\n                  </SortableItem>\n                );\n              })}\n            </SortableContext>\n          </DndContext>\n        </div>\n        <button\n          onClick={() => onMoveSheet(1)}\n          className={`btn btn-sm btn-${\n            theme === \"dark\" ? \"dark\" : \"white\"\n          } border-0 border-0 border-start border-end px-2 rounded-0`}\n          disabled={\n            sheets.findIndex(s => s.id === activeSheet) === sheets.length - 1\n          }\n        >\n          <i className='fa fa-chevron-right' />\n        </button>\n        <div className='d-flex align-items-center'>\n          <div className='px-1'>\n            <i\n              className='fa fa-minus cursor-pointer'\n              onClick={() =>\n                zoom <= maxZoom && zoom > minZoom && onZoom(zoom - 1)\n              }\n            />\n          </div>\n          <div className='' style={{ width: \"150px\" }}>\n            <Slider\n              min={minZoom}\n              max={maxZoom}\n              value={zoom}\n              step={1}\n              orientation='horizontal'\n              onChange={v => onZoom(v)}\n              tooltip={false}\n            />\n          </div>\n          <div className='px-1'>\n            <i\n              className='fa fa-plus cursor-pointer'\n              onClick={() =>\n                zoom < maxZoom && zoom >= minZoom && onZoom(zoom + 1)\n              }\n            />\n          </div>\n          <div className='px-1 w-50px'>{zoom}%</div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default SheetPane;\n"],"names":["SortableItem","props","children","attributes","listeners","setNodeRef","transform","transition","useSortable","id","style","CSS","Transform","toString","_jsx","ref","_sheets$filter$","_openModal$label","intl","useIntl","workbookContext","useContext","WorkbookContext","userContext","UserContext","sheets","setSheets","theme","activeSheet","setActiveSheet","setActiveChart","styles","zoom","filter","f","openModal","setOpenModal","useState","state","label","source","elementRef","useRef","useEffect","firstIndex","onDuplicate","sheetObj","length","WORKBOOK_CONFIG","sheetLimit","cloneObj","newSheetId","uuidv4","newSheet","order","formatMessage","defaultMessage","substring","charts","bSheets","setTimeout","renderToast","type","icon","position","message","onMoveSheet","incDec","selectedOrder","findIndex","s","_elementRef$current$s","current","scrollIntoView","inline","onZoom","val","newSheets","map","sensors","useSensors","useSensor","PointerSensor","activationConstraint","distance","TouchSensor","KeyboardSensor","coordinateGetter","sortableKeyboardCoordinates","_jsxs","_Fragment","ConfirmationModal","show","confirmationstring","handleHide","prev","handleYes","onDeleteSheet","size","Modal","zIndex","onHide","animation","centered","backdrop","Header","Title","FormattedMessage","Body","className","Form","Control","maxLength","placeholder","n","onChange","e","target","value","Button","variant","onClick","disabled","OnRename","i","onAddSheet","newObject","newArray","borderRadius","DndContext","collisionDetection","closestCenter","onDragEnd","_ref","active","over","oldIndex","_ref2","newIndex","_ref3","movedArray","arrayMove","SortableContext","items","strategy","horizontalListSortingStrategy","sheet","OverlayTrigger","trigger","placement","overlay","Popover","as","rootClose","minWidth","width","Slider","min","max","step","orientation","v","tooltip"],"sourceRoot":""}