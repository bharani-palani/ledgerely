"use strict";(self.webpackChunkledgerely_com=self.webpackChunkledgerely_com||[]).push([[4451],{9595:(e,a,t)=>{t.d(a,{I:()=>r});var s=t(9950),n=t(8429);const r=()=>{const{search:e}=(0,n.zy)();return(0,s.useMemo)((()=>new URLSearchParams(e)),[e])}},4451:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(9950),n=t(3058),r=t(5358),l=t(6781),o=t(8459),c=t(4570),d=t(1308),i=t(2436),g=t(970),m=t(9288),p=t(3027),u=t(3932),f=t(9051),h=t.n(f),b=t(8311),x=t(2083),M=t(8630),y=t(9595),_=t(3177),D=t(7391),T=t(6731),w=t(9845),j=t(4414);const C=s.createContext(void 0),A=()=>{const e=(0,m.A)(),a=(0,s.useContext)(d.F);document.title=`${a.appName} - ${e.formatMessage({id:"category",defaultMessage:"category"})}`;const t=(0,s.useContext)(i.R),f=(0,s.useContext)(D.U),A=(0,s.useContext)(w.O),[S,k]=(0,s.useState)(!1),[v,I]=(0,s.useState)(!1),[R,P]=(0,s.useState)(!0),[N,E]=(0,s.useState)([]),[Y,F]=(0,s.useState)({category:"",startDate:h()().startOf("month").toDate(),endDate:h()().endOf("month").toDate()}),[$,O]=(0,s.useState)([]),[V,z]=(0,s.useState)([]),B={start:0,limit:10,searchString:""},[H,L]=(0,s.useState)(B),[W,K]=(0,s.useState)(B),[G,U]=(0,s.useState)(B),J={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"categorizedBankTrx",Table:"categorizedBankTrx",label:"Categorized bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"amount",defaultMessage:"amount"}),e.formatMessage({id:"type",defaultMessage:"type"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},q={config:{header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:e.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"catCreditCardTrx",Table:"categorizedCreditCardTrx",TableRows:["cc_transaction","cc_date","credit_card_name","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_comments"],TableAliasRows:[e.formatMessage({id:"name",defaultMessage:"name"}),e.formatMessage({id:"date",defaultMessage:"date"}),e.formatMessage({id:"creditCard",defaultMessage:"creditCard"}),e.formatMessage({id:"credits",defaultMessage:"credits"}),e.formatMessage({id:"purchases",defaultMessage:"purchases"}),e.formatMessage({id:"interest",defaultMessage:"interest"}),e.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label","label","label"]},Q=e=>{I(!0),O([]),z([]),setTimeout((()=>{const a=(()=>{const e=new FormData;return e.append("limit",W.limit),e.append("start",W.start),e.append("searchString",W.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","categorizedBankTrx"),e.append("WhereClause",`a.inc_exp_appId = '${t.userConfig.appId}' && b.inc_exp_cat_id = '${Y.category}' && d.bank_appId = '${t.userConfig.appId}' && a.inc_exp_date >= '${h()(Y.startDate).format("YYYY-MM-DD").toString()}' && a.inc_exp_date <= '${h()(Y.endDate).format("YYYY-MM-DD").toString()}'`),c.A.post("/account_planner/getAccountPlanner",e)})(),s=(()=>{const e=new FormData;return e.append("limit",G.limit),e.append("start",G.start),e.append("searchString",G.searchString),e.append("TableRows","a.cc_transaction, a.cc_date, d.credit_card_name, a.cc_payment_credits, a.cc_purchases, a.cc_taxes_interest, a.cc_comments"),e.append("Table","categorizedCreditCardTrx"),e.append("WhereClause",`a.cc_appId = '${t.userConfig.appId}' && b.inc_exp_cat_id = '${Y.category}' && d.credit_card_appId = '${t.userConfig.appId}' && a.cc_date >= '${h()(Y.startDate).format("YYYY-MM-DD").toString()}' && a.cc_date <= '${h()(Y.endDate).format("YYYY-MM-DD").toString()}'`),c.A.post("/account_planner/getAccountPlanner",e)})();Promise.all([a,s]).then((a=>{const t=a[0].data.response,s=a[1].data.response;O(t),z(s);const n=(null===t||void 0===t?void 0:t.table.length)>0?"bank":"creditCard";"function"===typeof e&&e(n)})).catch((e=>console.log("bbb",e))).finally((()=>{I(!1),k(!0)}))}),100)};(0,s.useEffect)((()=>{(async()=>{P(!0);const e=new FormData;e.append("limit",H.limit),e.append("start",H.start),e.append("searchString",H.searchString),e.append("appId",t.userConfig.appId),c.A.post("/account_planner/inc_exp_list",e).then((e=>E(e.data.response))).catch((e=>{console.log(e)})).finally((()=>P(!1)))})()}),[H]);const X=(0,y.I)(),Z={fetch:X.get("fetch"),categoryId:X.get("categoryId"),startDate:X.get("startDate"),endDate:X.get("endDate")},[ee,ae]=(0,s.useState)(!1);(0,s.useEffect)((()=>{"category"===Z.fetch&&Z.categoryId&&(ae(!0),F((e=>({...e,category:Z.categoryId,startDate:h()(Z.startDate).toDate(),endDate:h()(Z.endDate).toDate()}))))}),[JSON.stringify(Z)]),(0,s.useEffect)((()=>{"category"===Z.fetch&&Y.category&&Y.startDate&&Y.endDate&&ee&&Q((e=>{ae(!1),setTimeout((()=>{var a;const t="bank"===e?"categorizedBankTrx":"catCreditCardTrx";null===(a=document.getElementById(t))||void 0===a||a.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),1e3)}))}),[JSON.stringify(Z),Y.category,ee]);const te=()=>(0,j.jsx)("div",{className:"relativeSpinner",children:(0,j.jsx)(b.A,{type:x.A.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})}),se=["id","name","isIncomeMetric","isPlanMetric"],ne=["checkbox","textbox",{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}},{radio:{radioList:[{label:e.formatMessage({id:"yes",defaultMessage:"yes"}),value:"1",checked:!1},{label:e.formatMessage({id:"no",defaultMessage:"no"}),value:"0",checked:!0}]}}],re=_.GG.filter((e=>"incExpCat"===e.id)).map((a=>{const t={header:{searchPlaceholder:e.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:f.localeLanguage,currency:f.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return a.config=t,a.TableAliasRows=se.map((a=>e.formatMessage({id:a,defaultMessage:a}))),a.rowElements=ne,a}))[0],[le,oe]=(0,s.useState)([]),ce=()=>{oe([]);const e=((e,a)=>{const s=new FormData;return s.append("TableRows",a),s.append("Table",e),s.append("limit",H.limit),s.append("start",H.start),s.append("searchString",H.searchString),s.append("appId",t.userConfig.appId),c.A.post("/account_planner/getAccountPlanner",s)})(re.Table,re.TableRows);Promise.all([e]).then((async e=>{oe(e[0].data.response)}))};(0,s.useEffect)((()=>{ce()}),[H]);return(0,s.useEffect)((()=>{S&&Q()}),[W,G,S]),(0,j.jsx)(C.Provider,{value:{incExpList:N,selection:Y},children:(0,j.jsxs)(r.A,{fluid:!0,children:[(0,j.jsx)(n.A,{icon:"fa fa-sitemap",intlId:"category"}),R?(0,j.jsx)(te,{}):(0,j.jsxs)(j.Fragment,{children:[le&&Object.keys(le).length>0&&(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(M.A,{className:"pt-3",config:re.config,Table:re.Table,TableRows:re.TableRows,TableAliasRows:re.TableAliasRows,rowElements:re.rowElements,defaultValues:re.defaultValues,dbData:le,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:a=>(a=>{const{status:s,data:n}=a;if(200===s){if(a&&n&&"boolean"===typeof n.response&&null!==n.response&&n.response&&t.renderToast({message:e.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),a&&n&&"boolean"===typeof n.response&&null!==n.response&&!1===n.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),a&&n&&null===n.response&&A.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:(0,j.jsx)(T.x,{}),content:(0,j.jsx)(T.E,{})}),a&&n&&"object"===typeof n.response&&null!==n.response){let a;a=1451===n.response.number?"foreignKeyDeleteMessage":"",t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:a,defaultMessage:a})})}}else t.renderToast({type:"error",icon:"fa fa-times-circle",message:e.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})})(a,re.id),apiParams:H,onChangeParams:e=>(e=>{L((a=>({...a,...e})))})(e),onReFetchData:()=>ce(),cellWidth:re.cellWidth,ajaxButtonName:e.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"inc_exp_cat_appId",value:t.userConfig.appId},theme:t.userData.theme})}),(0,j.jsxs)(l.A,{className:"align-items-center "+(Object.keys($).length>0||Object.keys(V).length>0?"":"pb-5"),children:[(0,j.jsx)(o.A,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:(0,j.jsx)(g.A,{placeholder:`${e.formatMessage({id:"select",defaultMessage:"select"})} ${e.formatMessage({id:"category",defaultMessage:"category"})}`,onChange:(e,a,t)=>{F((e=>({...e,category:a})))},element:{fetch:{dropDownList:N.map((e=>({id:e.id,value:e.value})))},searchable:!0},value:Y.category,type:"single",searchable:!0,theme:t.userData.theme})}),(0,j.jsxs)(o.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,j.jsx)("span",{children:(0,j.jsx)(p.A,{id:"startDate",defaultMessage:"startDate"})}),(0,j.jsx)(u.A,{className:"bg-white text-dark",value:Y.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{F((a=>({...a,startDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,j.jsxs)(o.A,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[(0,j.jsx)("span",{children:(0,j.jsx)(p.A,{id:"endDate",defaultMessage:"endDate"})}),(0,j.jsx)(u.A,{className:"bg-white text-dark",value:Y.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:e=>{F((a=>({...a,endDate:e})))},maxDate:new Date,onKeyDown:e=>{e.preventDefault()}})]}),(0,j.jsx)(o.A,{sm:3,className:"pb-2",children:(0,j.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:()=>Q(),disabled:v||!Y.category,children:(0,j.jsx)(p.A,{id:"generate",defaultMessage:"generate"})})})]})]}),v&&(0,j.jsx)(te,{}),$&&Object.keys($).length>0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"py-2",children:(0,j.jsx)("span",{className:"badge "+("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),(0,j.jsx)(M.A,{id:J.id,config:J.config,Table:J.Table,TableRows:J.TableRows,TableAliasRows:J.TableAliasRows,rowElements:J.rowElements,defaultValues:J.defaultValues,dbData:$,cellWidth:[20,7,10,5,20],theme:t.userData.theme,apiParams:W,onChangeParams:e=>(e=>{K((a=>({...a,...e})))})(e)})]}),V&&Object.keys(V).length>0>0&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:"py-2",children:(0,j.jsx)("span",{className:"badge "+("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:e.formatMessage({id:"creditCardTransactions",defaultMessage:"creditCardTransactions"})})}),(0,j.jsx)(M.A,{id:q.id,config:q.config,Table:q.Table,TableRows:q.TableRows,TableAliasRows:q.TableAliasRows,rowElements:q.rowElements,defaultValues:q.defaultValues,dbData:V,cellWidth:[20,7,10,10,10,10,20],theme:t.userData.theme,apiParams:G,onChangeParams:e=>(e=>{U((a=>({...a,...e})))})(e)})]}),0===Object.keys(V).length&&0===Object.keys($).length&&S&&(0,j.jsx)("div",{className:"text-center py-2",children:(0,j.jsx)(p.A,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}}}]);