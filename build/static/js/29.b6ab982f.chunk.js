(this["webpackJsonpbni-apps"]=this["webpackJsonpbni-apps"]||[]).push([[29],{1102:function(e,a,t){"use strict";t.r(a);var n=t(25),c=t(30),s=t(35),r=t(27),o=t(1),i=t.n(o),l=t(94),d=t(1268),u=t(1266),b=t(932),p=t(46),f=t(39),m=t(89),_=t(774),g=t(1263),h=t(108),x=t.n(h),j=t(50),O=t.n(j),w=t(52),k=t.n(w),D=t(48),y=t(84),T=t(82),v=t(83),M=t(70),S=t(57),P=t(62),R=t(320),C=t(0),I=i.a.createContext(void 0);a.default=function(){var e,a=Object(_.a)(),t=Object(o.useContext)(f.a),i=Object(o.useContext)(M.a),h=Object(o.useContext)(P.a),j=Object(o.useState)(!1),w=Object(r.a)(j,2),N=w[0],A=w[1],E=Object(o.useState)(!1),Y=Object(r.a)(E,2),V=Y[0],L=Y[1],F=Object(o.useState)(!0),W=Object(r.a)(F,2),B=W[0],H=W[1],J=Object(o.useState)([]),K=Object(r.a)(J,2),U=K[0],G=K[1],q=Object(o.useState)({bank:"",startDate:O()().startOf("month").toDate(),endDate:O()().endOf("month").toDate()}),z=Object(r.a)(q,2),Q=z[0],X=z[1],Z=Object(o.useState)([]),$=Object(r.a)(Z,2),ee=$[0],ae=$[1],te={start:0,limit:10,searchString:""},ne=Object(o.useState)(te),ce=Object(r.a)(ne,2),se=ce[0],re=ce[1],oe=Object(o.useState)(te),ie=Object(r.a)(oe,2),le=ie[0],de=ie[1],ue={config:{header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{title:a.formatMessage({id:"total",defaultMessage:"total"}),maxDecimal:2},pagination:{currentPage:"first",maxPagesToShow:5}}},id:"bankTable",Table:"bankTrx",label:"Bank trx",TableRows:["inc_exp_name","inc_exp_date","inc_exp_amount","inc_exp_type","inc_exp_comments"],TableAliasRows:[a.formatMessage({id:"name",defaultMessage:"name"}),a.formatMessage({id:"date",defaultMessage:"date"}),a.formatMessage({id:"amount",defaultMessage:"amount"}),a.formatMessage({id:"type",defaultMessage:"type"}),a.formatMessage({id:"comments",defaultMessage:"comments"})],defaultValues:[],rowElements:["label","label","label","label","label"]},be=function(){var e=Object(s.a)(Object(c.a)().mark((function e(){var a;return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),(a=new FormData).append("limit",se.limit),a.append("start",se.start),a.append("searchString",se.searchString),a.append("appId",t.userConfig.appId),e.abrupt("return",p.a.post("/account_planner/bank_list",a).then((function(e){G(e.data.response)})).catch((function(e){console.log(e)})).finally((function(){return H(!1)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pe=function(e){L(!0),ae([]),setTimeout((function(){var a=function(){var e=new FormData;return e.append("limit",le.limit),e.append("start",le.start),e.append("searchString",le.searchString),e.append("TableRows","a.inc_exp_name, a.inc_exp_date, a.inc_exp_amount, a.inc_exp_type, a.inc_exp_comments"),e.append("Table","bankTrx"),e.append("WhereClause","a.inc_exp_appId = '".concat(t.userConfig.appId,"' && a.inc_exp_bank = '").concat(Q.bank,"' && d.bank_appId = '").concat(t.userConfig.appId,"' && a.inc_exp_date >= '").concat(O()(Q.startDate).format("YYYY-MM-DD").toString(),"' && a.inc_exp_date <= '").concat(O()(Q.endDate).format("YYYY-MM-DD").toString(),"'")),p.a.post("/account_planner/getAccountPlanner",e)}();Promise.all([a]).then((function(a){ae(a[0].data.response),"function"===typeof e&&e()})).catch((function(e){return console.log("bbb",e)})).finally((function(){L(!1),A(!0)}))}),100)};Object(o.useEffect)((function(){be()}),[]);var fe=Object(T.a)(),me={fetch:fe.get("fetch"),bankId:fe.get("bankId"),startDate:fe.get("startDate"),endDate:fe.get("endDate")},_e=Object(o.useState)(!1),ge=Object(r.a)(_e,2),he=ge[0],xe=ge[1];Object(o.useEffect)((function(){"bank"===me.fetch&&me.bankId&&(xe(!0),X((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:me.bankId,startDate:O()(me.startDate).toDate(),endDate:O()(me.endDate).toDate()})})))}),[JSON.stringify(me)]),Object(o.useEffect)((function(){"bank"===me.fetch&&Q.bank&&Q.startDate&&Q.endDate&&he&&pe((function(){xe(!1),setTimeout((function(){var e;null===(e=document.getElementById("bankTable"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center",inline:"start"})}),200)}))}),[JSON.stringify(me),Q.bank,he]);var je=function(){return Object(C.jsx)("div",{className:"relativeSpinner middle",children:Object(C.jsx)(k.a,{type:D.a.loadRandomSpinnerIcon(),color:document.documentElement.style.getPropertyValue("--app-theme-bg-color"),height:100,width:100})})},Oe=["id","bank","accountNumber","swiftCode","type","country","sort","localeLanguage","localeCurrency"],we=["checkbox","textbox","textbox","textbox",{fetch:{dropDownList:[{id:"SAV",value:a.formatMessage({id:"savingsAccount",defaultMessage:"savingsAccount"})},{id:"CUR",value:a.formatMessage({id:"currentAccount",defaultMessage:"currentAccount"})}]}},{fetch:{dropDownList:R.a},searchable:!0},"number",{fetch:{dropDownList:R.c},searchable:!0},{fetch:{dropDownList:R.b},searchable:!0}],ke=v.b.filter((function(e){return"bankAccounts"===e.id})).map((function(e){var t={header:{searchPlaceholder:a.formatMessage({id:"searchHere",defaultMessage:"searchHere"}),searchable:!0},footer:{total:{locale:i.localeLanguage,currency:i.localeCurrency,maxDecimal:2},pagination:{currentPage:"last",maxPagesToShow:5}}};return e.config=t,e.TableAliasRows=Oe.map((function(e){return a.formatMessage({id:e,defaultMessage:e})})),e.rowElements=we,e}))[0],De=Object(o.useState)([]),ye=Object(r.a)(De,2),Te=ye[0],ve=ye[1],Me=function(){ve([]);var e=function(e,a){var n=new FormData;return n.append("TableRows",a),n.append("Table",e),n.append("limit",se.limit),n.append("start",se.start),n.append("searchString",se.searchString),n.append("appId",t.userConfig.appId),p.a.post("/account_planner/getAccountPlanner",n)}(ke.Table,ke.TableRows);Promise.all([e]).then(function(){var e=Object(s.a)(Object(c.a)().mark((function e(a){return Object(c.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ve(a[0].data.response);case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}())};Object(o.useEffect)((function(){Me()}),[se]);return Object(o.useEffect)((function(){N&&pe()}),[le,N]),Object(C.jsx)(I.Provider,{value:{bankList:U,selection:Q},children:Object(C.jsxs)(d.a,{fluid:!0,children:[Object(C.jsx)(l.a,{icon:"fa fa-bank",intlId:"bank"}),B?Object(C.jsx)(je,{}):Object(C.jsxs)(C.Fragment,{children:[Te&&(null===(e=Object.keys(Te))||void 0===e?void 0:e.length)>0&&Object(C.jsx)(C.Fragment,{children:Object(C.jsx)(y.a,{className:"pt-3",config:ke.config,Table:ke.Table,TableRows:ke.TableRows,TableAliasRows:ke.TableAliasRows,rowElements:ke.rowElements,defaultValues:ke.defaultValues,dbData:Te,postApiUrl:"/account_planner/postAccountPlanner",onPostApi:function(e){return function(e,n){var c=e.status,s=e.data;if(200===c){if(e&&s&&"boolean"===typeof s.response&&null!==s.response&&s.response&&t.renderToast({message:a.formatMessage({id:"transactionSavedSuccessfully",defaultMessage:"transactionSavedSuccessfully"})}),e&&s&&"boolean"===typeof s.response&&null!==s.response&&!1===s.response&&t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"noFormChangeFound",defaultMessage:"noFormChangeFound"})}),e&&s&&null===s.response&&h.setConfig({show:!0,className:"alert-danger border-0 text-dark",type:"danger",dismissible:!0,heading:Object(C.jsx)(S.b,{}),content:Object(C.jsx)(S.a,{})}),e&&s&&"object"===typeof s.response&&null!==s.response){var r;r=1451===s.response.number?"foreignKeyDeleteMessage":"",t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:r,defaultMessage:r})})}}else t.renderToast({type:"error",icon:"fa fa-times-circle",message:a.formatMessage({id:"unableToReachServer",defaultMessage:"unableToReachServer"})})}(e,ke.id)},apiParams:se,onChangeParams:function(e){return function(e){re((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)},onReFetchData:function(){return Me()},cellWidth:ke.cellWidth,ajaxButtonName:a.formatMessage({id:"submit",defaultMessage:"submit"}),appIdKeyValue:{key:"bank_appId",value:t.userConfig.appId},theme:t.userData.theme})}),Object(C.jsxs)(u.a,{className:"align-items-center pb-5",children:[Object(C.jsx)(b.a,{sm:3,className:"react-responsive-ajax-data-table pb-2",children:Object(C.jsx)(m.a,{placeholder:"".concat(a.formatMessage({id:"select",defaultMessage:"select"})," ").concat(a.formatMessage({id:"bank",defaultMessage:"bank"})),onChange:function(e,a,t){X((function(e){return Object(n.a)(Object(n.a)({},e),{},{bank:a})}))},element:{fetch:{dropDownList:U.map((function(e){return{id:e.id,value:e.value}}))},searchable:!0},value:Q.bank,type:"single",searchable:!0,theme:t.userData.theme})}),Object(C.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(C.jsx)("span",{children:Object(C.jsx)(g.a,{id:"startDate",defaultMessage:"startDate"})}),Object(C.jsx)(x.a,{className:"bg-white text-dark",value:Q.startDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{startDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(C.jsxs)(b.a,{sm:3,className:"d-flex align-items-center justify-content-between pb-2",children:[Object(C.jsx)("span",{children:Object(C.jsx)(g.a,{id:"endDate",defaultMessage:"endDate"})}),Object(C.jsx)(x.a,{className:"bg-white text-dark",value:Q.endDate,format:"yyyy-MM-dd",clearIcon:null,onChange:function(e){X((function(a){return Object(n.a)(Object(n.a)({},a),{},{endDate:e})}))},maxDate:new Date,onKeyDown:function(e){e.preventDefault()}})]}),Object(C.jsx)(b.a,{sm:3,className:"pb-2",children:Object(C.jsx)("button",{className:"btn btn-sm btn-bni w-100 border-0",onClick:function(){return pe()},disabled:V||!Q.bank,children:Object(C.jsx)(g.a,{id:"generate",defaultMessage:"generate"})})})]})]}),V&&Object(C.jsx)(je,{}),ee&&Object.keys(ee).length>0&&Object(C.jsxs)(C.Fragment,{children:[Object(C.jsx)("div",{className:"py-2",children:Object(C.jsx)("span",{className:"badge ".concat("dark"===t.userData.theme?"bg-secondary text-white":"bg-light text-dark"),children:a.formatMessage({id:"bankTransactions",defaultMessage:"bankTransactions"})})}),Object(C.jsx)(y.a,{id:ue.id,config:ue.config,Table:ue.Table,TableRows:ue.TableRows,TableAliasRows:ue.TableAliasRows,rowElements:ue.rowElements,defaultValues:ue.defaultValues,dbData:ee,cellWidth:[25,7,10,5,20],theme:t.userData.theme,apiParams:le,onChangeParams:function(e){return function(e){de((function(a){return Object(n.a)(Object(n.a)({},a),e)}))}(e)}})]}),0===Object.keys(ee).length&&N&&!V&&Object(C.jsx)("div",{className:"text-center py-2",children:Object(C.jsx)(g.a,{id:"noRecordsGenerated",defaultMessage:" "})})]})})}},82:function(e,a,t){"use strict";t.d(a,"a",(function(){return s}));var n=t(1),c=t(72),s=function(){var e=Object(c.h)().search;return Object(n.useMemo)((function(){return new URLSearchParams(e)}),[e])}},83:function(e,a,t){"use strict";t.d(a,"b",(function(){return s})),t.d(a,"c",(function(){return r})),t.d(a,"a",(function(){return o}));var n=t(50),c=t.n(n),s=[{id:"bankAccounts",Table:"banks",config:{footer:{total:{},pagination:{currentPage:"last",maxPagesToShow:5}}},label:"Bank accounts",TableRows:["bank_id","bank_name","bank_account_number","bank_swift_code","bank_account_type","bank_country","bank_sort","bank_locale","bank_currency"],defaultValues:[{bank_sort:"0"}],cellWidth:[4,13,11,11,13,13,5,13,13]},{id:"creditCardAccounts",Table:"credit_cards",label:"Credit cards",TableRows:["credit_card_id","credit_card_name","credit_card_number","credit_card_start_date","credit_card_end_date","credit_card_payment_date","credit_card_annual_interest","credit_card_locale","credit_card_currency"],defaultValues:[{credit_card_annual_interest:"48"}],cellWidth:[4,13,11,8,8,8,8,13,13]},{id:"incExpCat",config:{footer:{total:{},pagination:{currentPage:"last",maxPagesToShow:5}}},Table:"income_expense_category",label:"Income / expense categories",TableRows:["inc_exp_cat_id","inc_exp_cat_name","inc_exp_cat_is_metric","inc_exp_cat_is_plan_metric"],defaultValues:[{inc_exp_cat_is_metric:"0"},{inc_exp_cat_is_plan_metric:"0"}],cellWidth:[4,13,13,13]},{id:"incExpTemp",config:{footer:{total:{},pagination:{currentPage:"last",maxPagesToShow:5}}},Table:"income_expense_template",label:"Income expense template",TableRows:["template_id","temp_inc_exp_name","temp_amount","temp_inc_exp_type","temp_inc_exp_date","temp_category","temp_bank"],defaultValues:[{temp_inc_exp_date:"1"},{temp_inc_exp_type:"Dr"},{temp_amount:"0.00"},{temp_inc_exp_name:""}],cellWidth:[4,13,13,13,5,13,13]}],r=[{id:26,config:{footer:{total:{},pagination:{currentPage:"last",maxPagesToShow:5}}},Table:"income_expense",label:"Expenditures for selected month",TableRows:["inc_exp_id","inc_exp_name","inc_exp_amount","inc_exp_plan_amount","inc_exp_type","inc_exp_date","inc_exp_category","inc_exp_bank","inc_exp_comments"],TableAliasRows:[],defaultValues:[{inc_exp_type:"Dr"},{inc_exp_amount:0},{inc_exp_plan_amount:0},{inc_exp_date:c()(new Date).format("YYYY-MM-DD")}],rowElements:["checkbox","textbox","number","label",null,"date",{fetch:{dropDownList:[]},searchable:!0},{fetch:{dropDownList:[]},searchable:!0},"textbox"],showTooltipFor:["inc_exp_name","inc_exp_comments"]}],o=[{id:27,config:{footer:{total:{},pagination:{currentPage:"last",maxPagesToShow:5}},searchable:!0},Table:"credit_card_transactions",label:"Credit card transactions",TableRows:["cc_id","cc_transaction","cc_date","cc_opening_balance","cc_payment_credits","cc_purchases","cc_taxes_interest","cc_expected_balance","cc_for_card","cc_inc_exp_cat","cc_transaction_status","cc_comments","cc_added_at"],TableAliasRows:[],rowElements:["checkbox","textbox","date","number","number","number","number","label",{fetch:{dropDownList:[]},searchable:!0},{fetch:{dropDownList:[]},searchable:!0},{fetch:{dropDownList:[{checked:!1,id:"1",value:"Settled"},{checked:!1,id:"0",value:"Pending"},{checked:!1,id:"2",value:"Part payment"}]}},"textbox","relativeTime"],defaultValues:[{cc_date:c()().format("YYYY-MM-DD")},{cc_opening_balance:0},{cc_payment_credits:0},{cc_purchases:0},{cc_taxes_interest:0},{cc_expected_balance:0},{cc_transaction_status:"0"}],showTooltipFor:["cc_transaction","cc_comments"]}]},94:function(e,a,t){"use strict";var n=t(25),c=t(28),s=t(1),r=t(1263),o=t(39),i=t(0),l=["icon","intlId","children"];a.a=function(e){var a=e.icon,t=e.intlId,d=e.children,u=Object(c.a)(e,l),b=Object(s.useContext)(o.a);return Object(i.jsx)("div",Object(n.a)(Object(n.a)({},u),{},{className:"bg-gradient ".concat("dark"===b.userData.theme?"bg-dark darkBoxShadow":"bg-white lightBoxShadow"," mt-2 ps-3 py-2 rounded-pill"),children:Object(i.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(i.jsxs)("div",{className:"d-flex align-items-center",children:[Object(i.jsx)("i",{className:"".concat(a," fa-1x")}),Object(i.jsx)("div",{className:"ps-2 mb-0",children:Object(i.jsx)(r.a,{id:t,defaultMessage:t})})]}),d]})}))}}}]);